(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{164:function(e,t,s){"use strict";s.r(t);var n=s(4),i=s.n(n),r=s(24),a=s.n(r),l=s(9),o=s(0),c=s(1),d=s(12),u=s(2),p=s(3),b=s(17),h=(s(38),s(22)),j={maxHeight:"300px",height:"100%",width:"100%",overflow:"auto",marginTop:"0.5em",backgroundColor:"rgb(255, 255, 255)",borderWidth:"1px",borderStyle:"solid",borderColor:"lightgrey",borderRadius:"4px",padding:"0.5em"},f={listStyleType:"disc"},g={marginBottom:"0.5em",listStyleType:"none",backgroundColor:"#f5f5f5",padding:"0.5em",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"space-between"},m={marginTop:"0.2em",width:"100px",height:"8px",backgroundColor:"#e0e0e0",borderRadius:"4px"},_={height:"100%",backgroundColor:"#1e88e5",borderRadius:"4px"},y={color:"green",fontSize:"1.2em"},O={cursor:"pointer",width:"100%",height:"100%",margin:"auto"},x={width:"100%",padding:"1em",backgroundColor:"rgb(240, 242, 246)",borderRadius:"4px"};function v(e,t,s,n,i){if(s>=t.length)e.close(1e3);else{var r=t[s],a=r.webkitRelativePath.split("/")[1];e.send("HEADER START"),e.send(JSON.stringify({file_name:r.name,instance_name:a})),e.send("HEADER END");var l=0;e.send("FILE START"),e.onmessage=function(o){"OK"===o.data&&l<r.size?(l=function(e,t,s,n){if(s+n<t.size){var i=t.slice(s,s+n);e.send(i)}else{var r=t.slice(s,t.size);e.send(r)}return s+n}(e,r,l,n),l>=r.size&&e.send("FILE END")):"UPLOAD DONE"===o.data&&(i(a,r.size),v(e,t,s+1,n,i))}}}var k=s(10),w=function(e){Object(u.a)(s,e);var t=Object(p.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).websocket_url=void 0,n.websocket_query=void 0,n.chunk_size=void 0,n.render=function(){return 0===n.state.instance_list.length&&"PE"===n.state.upload_status?Object(k.jsx)("div",{style:x,children:Object(k.jsxs)(h.Button,{style:{width:"100%"},children:[Object(k.jsx)("input",{webkitdirectory:"true",className:"input",id:"folder-select",type:"file",hidden:!0,onChange:n.folderInput}),Object(k.jsx)("label",{htmlFor:"folder-select",style:O,children:"Select folder"})]})}):n.state.instance_list.length>=0&&"PE"===n.state.upload_status?Object(k.jsxs)("div",{style:x,children:[Object(k.jsxs)(h.Button,{style:{width:"100%"},children:[Object(k.jsx)("input",{webkitdirectory:"true",className:"input",id:"folder-select",type:"file",hidden:!0,onChange:n.folderInput}),Object(k.jsx)("label",{htmlFor:"folder-select",style:O,children:"Select folder"})]}),Object(k.jsx)("div",{style:j,children:Object(k.jsx)("ul",{style:f,children:n.state.instance_list.map((function(e,t){return Object(k.jsxs)("li",{style:g,children:[e.name,e.progress<100?Object(k.jsx)("div",{style:m,children:Object(k.jsx)("div",{style:Object(l.a)(Object(l.a)({},_),{},{width:"".concat(e.progress,"%")})})}):Object(k.jsx)("span",{style:y,children:"\u2713"})]},t)}))})}),Object(k.jsx)(h.Button,{color:"primary",style:{width:"100%",marginTop:"0.5em"},onClick:n.folderUpload,children:"Upload"})]}):Object(k.jsx)("div",{style:x,children:Object(k.jsx)("div",{style:j,children:Object(k.jsx)("ul",{style:f,children:n.state.instance_list.map((function(e,t){return Object(k.jsxs)("li",{style:g,children:[e.name,e.progress<100?Object(k.jsx)("div",{style:m,children:Object(k.jsx)("div",{style:Object(l.a)(Object(l.a)({},_),{},{width:"".concat(e.progress,"%")})})}):Object(k.jsx)("span",{style:y,children:"\u2713"})]},t)}))})})})},n.state={instance_list:[],file_list:[],upload_status:"PE"},n.folderInput=n.folderInput.bind(Object(d.a)(n)),n.folderUpload=n.folderUpload.bind(Object(d.a)(n)),n.updateInstanceProgress=n.updateInstanceProgress.bind(Object(d.a)(n)),n.websocket_url=e.args.websocket_url,n.websocket_query="?auth_token="+e.args.auth_token+"&project_id="+e.args.project_id+"&sub_index="+e.args.sub_index,n.chunk_size=e.args.chunk_size,n}return Object(c.a)(s,[{key:"folderInput",value:function(e){var t=e.target.files;this.setState({file_list:t});for(var s=[],n=function(){var e=t[i],n=e.webkitRelativePath.split("/")[1];if(0===s.filter((function(e){return e.name===n})).length)s.push({name:n,files:[e],total_size:e.size,uploaded_size:0,progress:0});else{var r=s.filter((function(e){return e.name===n}))[0],a=s.indexOf(r);r.files.push(e),r.total_size=r.total_size+e.size,s[a]=r}},i=0;i<t.length;i++)n();this.setState({instance_list:s}),b.a.setComponentValue(s.map((function(e){return{name:e.name,progress:e.progress}})))}},{key:"folderUpload",value:function(e){var t=this,s=new WebSocket(this.websocket_url+this.websocket_query);this.setState({upload_status:"IP"}),s.onopen=function(e){v(s,t.state.file_list,0,t.chunk_size,t.updateInstanceProgress)},s.onclose=function(){}}},{key:"updateInstanceProgress",value:function(e,t){var s=this.state.instance_list,n=s.findIndex((function(t){return t.name===e})),i=s[n];i.uploaded_size=i.uploaded_size+t,i.progress=i.uploaded_size/i.total_size*100,s[n]=i,this.setState({instance_list:s}),b.a.setComponentValue(s.map((function(e){return{name:e.name,progress:e.progress}})))}}]),s}(b.b),z=Object(b.c)(w);a.a.render(Object(k.jsx)(i.a.StrictMode,{children:Object(k.jsx)(z,{})}),document.getElementById("root"))}},[[164,1,2]]]);
//# sourceMappingURL=main.da33716a.chunk.js.map