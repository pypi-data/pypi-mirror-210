apiVersion: core.oam.dev/v1beta1
kind: Application
metadata:
  name: default-app # change to your app name
spec:
  components:
  - name: first-component
    type: webservice # more types available at https://kubevela.io/docs/end-user/components/references
    properties:
      image: hello-world
      ports:
      - port: 80
        expose: true
      env:
      - name: TEST_ENV
        value: "test"
    traits:
    - type: scaler # more types available at https://kubevela.io/docs/end-user/traits/references
      properties:
        replicas: 2
  # For App definition, define only components, and possibly traits
  # For App deployment, define policies and workflow
  policies:
    - name: target-prod
      type: topology # more types available at https://kubevela.io/docs/end-user/policies/references
      properties:
        clusters: ["local"]
        namespace: "prod"
  workflow:
    steps:
    - name: deploy2prod
      type: deploy # more types available at https://kubevela.io/docs/end-user/workflow/built-in-workflow-defs
      properties:
        policies: ["target-prod"]
