(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8867],{59739:function(e,n,t){"use strict";var r=t(56669);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,n,t,o,i,c){if(c!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function n(){return e}e.isRequired=e;var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:i,resetWarningCache:o};return t.PropTypes=t,t}},47329:function(e,n,t){e.exports=t(59739)()},56669:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1210:function(e,n,t){"use strict";t.d(n,{Z:function(){return Z}});var r=t(82394),o=t(21831),i=t(82684),c=t(47999),s=t(49894),a=t(93461),u=t(57384),l=t(41424),d=t(72454),f=t(28598);function p(e,n){var t=e.children;return(0,f.jsx)(d.HS,{ref:n,children:t})}var h=i.forwardRef(p),m=t(32063),O=t(85019),v=t(82531),R=t(66166),A=t(3055),b=t(49125),E=t(91427),x=t(24141);function S(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function T(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?S(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Z=function(e){var n,t=e.after,r=e.afterHidden,p=e.afterWidth,S=e.afterWidthOverride,Z=e.before,j=e.beforeWidth,k=e.breadcrumbs,_=e.children,P=e.errors,D=e.headerMenuItems,C=e.navigationItems,w=e.setErrors,g=e.subheaderChildren,y=e.title,N=e.uuid,I=(0,x.i)().width,M="dashboard_after_width_".concat(N),W="dashboard_before_width_".concat(N),L=(0,i.useRef)(null),U=(0,i.useState)(S?p:(0,E.U2)(M,p)),F=U[0],H=U[1],X=(0,i.useState)(!1),K=X[0],Y=X[1],B=(0,i.useState)(Z?Math.max((0,E.U2)(W,j),13*b.iI):null),z=B[0],G=B[1],V=(0,i.useState)(!1),q=V[0],Q=V[1],$=(0,i.useState)(null)[1],J=v.ZP.projects.list({},{revalidateOnFocus:!1}).data,ee=null===J||void 0===J?void 0:J.projects,ne=[];k?ne.push.apply(ne,(0,o.Z)(k)):(null===ee||void 0===ee?void 0:ee.length)>=1&&ne.push.apply(ne,[{label:function(){var e;return null===(e=ee[0])||void 0===e?void 0:e.name},linkProps:{href:"/"}},{bold:!0,label:function(){return y}}]),(0,i.useEffect)((function(){null===L||void 0===L||!L.current||K||q||null===$||void 0===$||$(L.current.getBoundingClientRect().width)}),[K,F,q,z,L,$,I]),(0,i.useEffect)((function(){K||(0,E.t8)(M,F)}),[r,K,F,M]),(0,i.useEffect)((function(){q||(0,E.t8)(W,z)}),[q,z,W]);var te=(0,R.Z)(p);return(0,i.useEffect)((function(){S&&te!==p&&H(p)}),[S,p,te]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(u.Z,{title:y}),(0,f.jsx)(l.Z,{breadcrumbs:ne,menuItems:D,project:null===ee||void 0===ee?void 0:ee[0],version:null===ee||void 0===ee||null===(n=ee[0])||void 0===n?void 0:n.version}),(0,f.jsxs)(d.Nk,{children:[0!==(null===C||void 0===C?void 0:C.length)&&(0,f.jsx)(d.lm,{showMore:!0,children:(0,f.jsx)(O.Z,{navigationItems:C,showMore:!0})}),(0,f.jsx)(a.Z,{flex:1,flexDirection:"column",children:(0,f.jsxs)(m.Z,{after:t,afterHeightOffset:A.Mz,afterHidden:r,afterMousedownActive:K,afterWidth:F,before:Z,beforeHeightOffset:A.Mz,beforeMousedownActive:q,beforeWidth:d.k1+(Z?z:0),hideAfterCompletely:!0,leftOffset:Z?d.k1:null,mainContainerRef:L,setAfterMousedownActive:Y,setAfterWidth:H,setBeforeMousedownActive:Q,setBeforeWidth:G,children:[g&&(0,f.jsx)(h,{children:g}),_]})})]}),P&&(0,f.jsx)(c.Z,{disableClickOutside:!0,isOpen:!0,onClickOutside:function(){return null===w||void 0===w?void 0:w(null)},children:(0,f.jsx)(s.Z,T(T({},P),{},{onClose:function(){return null===w||void 0===w?void 0:w(null)}}))})]})}},65597:function(e,n,t){"use strict";t.d(n,{f:function(){return s}});var r=t(9518),o=t(23831),i=t(49125),c=t(73942),s=r.default.div.withConfig({displayName:"Tablestyle__PopupContainerStyle",componentId:"sc-8ammqd-0"})(["position:absolute;max-height:","px;z-index:10;border-radius:","px;padding:","px;"," "," "," ",""],58*i.iI,c.TR,2*i.iI,(function(e){return"\n    box-shadow: ".concat((e.theme.shadow||o.Z.shadow).popup,";\n    background-color: ").concat((e.theme.interactive||o.Z.interactive).defaultBackground,";\n  ")}),(function(e){return e.leftOffset&&"\n    left: ".concat(e.leftOffset,"px;\n  ")}),(function(e){return e.topOffset&&"\n    top: ".concat(e.topOffset,"px;\n  ")}),(function(e){return e.width&&"\n    width: ".concat(e.width,"px;\n  ")}))},86422:function(e,n,t){"use strict";t.d(n,{$W:function(){return p},DA:function(){return f},HX:function(){return O},J8:function(){return m},L8:function(){return c},Lq:function(){return l},Qj:function(){return v},Ut:function(){return E},V4:function(){return b},VZ:function(){return h},dO:function(){return d},f2:function(){return A},iZ:function(){return R},t6:function(){return s},tf:function(){return u}});var r,o,i,c,s,a=t(82394);!function(e){e.DYNAMIC="dynamic",e.DYNAMIC_CHILD="dynamic_child",e.REDUCE_OUTPUT="reduce_output"}(c||(c={})),function(e){e.MARKDOWN="markdown",e.PYTHON="python",e.R="r",e.SQL="sql",e.YAML="yaml"}(s||(s={}));var u,l,d=(r={},(0,a.Z)(r,s.MARKDOWN,"MD"),(0,a.Z)(r,s.PYTHON,"PY"),(0,a.Z)(r,s.R,"R"),(0,a.Z)(r,s.SQL,"SQL"),(0,a.Z)(r,s.YAML,"YAML"),r);!function(e){e.CALLBACK="callback",e.CHART="chart",e.CUSTOM="custom",e.DATA_EXPORTER="data_exporter",e.DATA_LOADER="data_loader",e.DBT="dbt",e.EXTENSION="extension",e.SCRATCHPAD="scratchpad",e.SENSOR="sensor",e.MARKDOWN="markdown",e.TRANSFORMER="transformer"}(u||(u={})),function(e){e.BLUE="blue",e.GREY="grey",e.PINK="pink",e.PURPLE="purple",e.TEAL="teal",e.YELLOW="yellow"}(l||(l={}));var f,p=[u.CHART,u.CUSTOM,u.DATA_EXPORTER,u.DATA_LOADER,u.SCRATCHPAD,u.SENSOR,u.MARKDOWN,u.TRANSFORMER],h=[u.DATA_EXPORTER,u.DATA_LOADER],m=[u.DATA_EXPORTER,u.DATA_LOADER,u.TRANSFORMER],O=[u.DATA_EXPORTER,u.DATA_LOADER,u.DBT,u.TRANSFORMER],v=[u.CHART,u.SCRATCHPAD,u.SENSOR,u.MARKDOWN],R=[u.CALLBACK,u.CHART,u.EXTENSION,u.SCRATCHPAD,u.MARKDOWN];!function(e){e.EXECUTED="executed",e.FAILED="failed",e.NOT_EXECUTED="not_executed",e.UPDATED="updated"}(f||(f={}));var A=[u.CUSTOM,u.DATA_EXPORTER,u.DATA_LOADER,u.TRANSFORMER],b=(o={},(0,a.Z)(o,u.EXTENSION,"Callback"),(0,a.Z)(o,u.CUSTOM,"Custom"),(0,a.Z)(o,u.DATA_EXPORTER,"Data exporter"),(0,a.Z)(o,u.DATA_LOADER,"Data loader"),(0,a.Z)(o,u.EXTENSION,"Extension"),(0,a.Z)(o,u.SCRATCHPAD,"Scratchpad"),(0,a.Z)(o,u.SENSOR,"Sensor"),(0,a.Z)(o,u.MARKDOWN,"Markdown"),(0,a.Z)(o,u.TRANSFORMER,"Transformer"),o),E=[u.DATA_LOADER,u.TRANSFORMER,u.DATA_EXPORTER,u.SENSOR];i={},(0,a.Z)(i,u.DATA_EXPORTER,"DE"),(0,a.Z)(i,u.DATA_LOADER,"DL"),(0,a.Z)(i,u.SCRATCHPAD,"SP"),(0,a.Z)(i,u.SENSOR,"SR"),(0,a.Z)(i,u.MARKDOWN,"MD"),(0,a.Z)(i,u.TRANSFORMER,"TF")},70120:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Y}});var r=t(77837),o=t(75582),i=t(38860),c=t.n(i),s=t(82684),a=t(83455),u=t(60328),l=t(47999),d=t(57722),f=t(67971),p=t(87372),h=t(11135),m=t(86673),O=t(58180),v=t(19711),R=t(82944),A=t(70902),b=t(82531),E=t(10503),x=t(86422),S=t(73899),T=t(99994),Z=t(85307),j=t(49125),k=t(96510),_=t(90211),P=t(28598);var D,C=function(e){var n=e.clusterType,t=e.fetchWorkspaces,r=(0,s.useState)(),i=r[0],c=r[1],u=(0,s.useState)(),l=u[0],D=u[1],C=(0,s.useState)(),w=C[0],g=C[1],y=(0,s.useState)(null),N=y[0],I=y[1],M=(0,s.useState)(),W=M[0],L=M[1],U=(0,s.useState)(),F=U[0],H=U[1],X=(0,a.Db)(b.ZP.workspaces.useCreate(),{onSuccess:function(e){return(0,k.wD)(e,{callback:function(e){e.success?(t(),c(!1)):D(e.error_message)},onErrorCallback:function(e){var n=e.error,t=n.errors,r=n.message;console.log(t,r)}})}}),K=(0,o.Z)(X,2),Y=K[0],B=K[1].isLoading,z=[[(0,P.jsx)(v.ZP,{bold:!0,color:S.cM,children:"Workspace name"},"workspace_name_label"),(0,P.jsx)(R.Z,{label:"ecs"===n?"Spaces will be replaced by underscores":"Spaces will be replaced by hyphens",monospace:!0,onChange:function(e){e.preventDefault(),L(e.target.value)},placeholder:"Name your new workspace",value:W},"workspace_name_input")]];return"k8s"===n&&z.push([(0,P.jsx)(v.ZP,{bold:!0,color:S.cM,children:"Service account name (optional)"},"service_account_name"),(0,P.jsx)(R.Z,{label:"Name of service account to be attached to stateful set",monospace:!0,onChange:function(e){e.preventDefault(),H(e.target.value)},placeholder:"Service account name",value:F},"service_account_name_label")]),(0,P.jsx)(P.Fragment,{children:i?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(p.Z,{default:!0,level:5,monospace:!0,children:"Configure your workspace"}),(0,P.jsx)(O.Z,{columnFlex:[null,3],rows:z}),"k8s"===n&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(m.Z,{mt:1,children:(0,P.jsxs)(f.Z,{alignItems:"center",children:[(0,P.jsx)(v.ZP,{default:!0,monospace:!0,children:"Configure container"}),(0,P.jsx)(m.Z,{ml:1}),(0,P.jsx)(A.Z,{checked:w,onCheck:function(){return g((function(e){return!e}))}})]})}),w&&(0,P.jsx)(m.Z,{mt:1,children:(0,P.jsx)(Z.$W,{children:(0,P.jsx)(d.Z,{autoHeight:!0,language:x.t6.YAML,onChange:function(e){I(e)},tabSize:2,value:N||void 0,width:"100%"})})})]}),B&&(0,P.jsx)(m.Z,{mt:1,children:(0,P.jsx)(v.ZP,{small:!0,warning:!0,children:"This may take up to a few minutes... Once the service is created, it may take another 5-10 minutes for the service to be accessible."})}),!B&&l&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(m.Z,{mt:1,children:(0,P.jsx)(v.ZP,{danger:!0,small:!0,children:"Failed to create instance, see error below."})}),(0,P.jsx)(m.Z,{mt:1,children:(0,P.jsx)(v.ZP,{danger:!0,small:!0,children:l})})]}),(0,P.jsx)(m.Z,{my:2,children:(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(h.ZP,{background:S.a$,bold:!0,inline:!0,loading:B,onClick:function(){return Y({workspace:{cluster_type:n,container_config:w&&N,name:(e=W,"ecs"===n?(0,_.We)(e,"_"):(0,_.We)(e,"-")),service_account_name:F}});var e},uuid:"workspaces/create",children:"Create"}),(0,P.jsx)(m.Z,{ml:1}),(0,P.jsx)(h.ZP,{bold:!0,inline:!0,onClick:function(){return c(!1)},uuid:"workspaces/cancel",children:"Cancel"})]})})]}):(0,P.jsx)(h.ZP,{background:T.eW,beforeElement:(0,P.jsx)(E.mm,{size:2.5*j.iI}),bold:!0,inline:!0,onClick:function(){L((0,_.Y6)()),c(!0)},uuid:"workspaces/new",children:"Create new workspace"})})},w=t(62084),g=t(41788),y=t(21831),N=t(1210),I=t(72454),M=t(81132),W=t(9736);function L(e,n){var t=e.owner,r=e.roles,o=[{Icon:E.Vz,id:D.WORKSPACES,isSelected:function(){return D.WORKSPACES===n},label:function(){return"Workspaces"},linkProps:{href:"/manage"}}];return(t||r===M.No.ADMIN)&&o.push({Icon:E.NO,id:D.USERS,isSelected:function(){return D.USERS===n},label:function(){return"Users"},linkProps:{href:"/manage/users"}}),(!(0,W.YB)()||r<=M.No.EDITOR)&&o.push({Icon:E.Zr,id:D.SETTINGS,isSelected:function(){return D.SETTINGS===n},label:function(){return"Settings"},linkProps:{href:"/manage/settings"}}),o}!function(e){e.WORKSPACES="workspaces",e.USERS="users",e.SETTINGS="settings"}(D||(D={}));var U=function(e){var n=e.breadcrumbs,t=void 0===n?[]:n,r=e.children,o=e.pageName,i=e.subheaderChildren,c=(0,W.PR)()||{};return(0,P.jsx)(N.Z,{afterWidth:I.k1,breadcrumbs:[{bold:!0,label:function(){return"Workspaces"}}].concat((0,y.Z)(t)),navigationItems:L(c,o),subheaderChildren:i,title:"Workspaces",uuid:"workspaces/index",children:r})},F=t(73942),H=t(65597);function X(e){var n=e.fetchWorkspaces,t=e.instance,r=e.clusterType,i=(0,s.useRef)(null),c=(0,s.useState)(),d=c[0],p=c[1],h=(0,s.useState)(),O=h[0],R=h[1],A=t.name,x=(t.task_arn,{cluster_type:r}),S=(0,a.Db)(b.ZP.workspaces.useUpdate(A,x),{onSuccess:function(e){return(0,k.wD)(e,{callback:function(){n(),p(!1)},onErrorCallback:function(e){var n=e.error,t=n.errors,r=n.message;console.log(t,r)}})}}),T=(0,o.Z)(S,1)[0],Z=(0,a.Db)(b.ZP.workspaces.useDelete(A,x),{onSuccess:function(e){return(0,k.wD)(e,{callback:function(){n(),p(!1)},onErrorCallback:function(e){var n=e.error,t=n.errors,r=n.message;console.log(t,r)}})}}),_=(0,o.Z)(Z,1)[0],D=(0,s.useMemo)((function(){var e=t.status,n=[{label:function(){return(0,P.jsx)(v.ZP,{children:"Delete workspace"})},onClick:function(){return R(!0)},uuid:"delete_workspace"}];return"STOPPED"===e?n.unshift({label:function(){return(0,P.jsx)(v.ZP,{children:"Resume instance"})},onClick:function(){return T({workspace:{action:"resume",cluster_type:r,name:t.name,task_arn:t.task_arn}})},uuid:"resume_instance"}):"RUNNING"===e&&n.unshift({label:function(){return(0,P.jsx)(v.ZP,{children:"Stop instance"})},onClick:function(){return T({workspace:{action:"stop",cluster_type:r,name:t.name,task_arn:t.task_arn}})},uuid:"stop_instance"}),n}),[r,t,T]);return(0,P.jsx)(P.Fragment,{children:"ecs"===r&&(0,P.jsxs)("div",{ref:i,style:{position:"relative",zIndex:"1"},children:[(0,P.jsx)(u.Z,{iconOnly:!0,onClick:function(){return p(!d)},children:(0,P.jsx)(E.mH,{size:2*j.iI})}),(0,P.jsx)(l.Z,{disableEscape:!0,onClickOutside:function(){p(!1),R(!1)},open:d,children:O?(0,P.jsxs)(H.f,{leftOffset:30*-j.iI,topOffset:3*-j.iI,width:30*j.iI,children:[(0,P.jsx)(v.ZP,{children:"Are you sure you want to delete"}),(0,P.jsx)(v.ZP,{children:"this instance? You may not be"}),(0,P.jsx)(v.ZP,{children:"able to recover your data."}),(0,P.jsx)(m.Z,{mt:1}),(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(u.Z,{danger:!0,onClick:_,children:"Confirm"}),(0,P.jsx)(m.Z,{ml:1}),(0,P.jsx)(u.Z,{default:!0,onClick:function(){return R(!1)},children:"Cancel"})]})]}):(0,P.jsx)(w.Z,{items:D,left:25*-j.iI,open:d,parentRef:i,topOffset:3*-j.iI,uuid:"workspaces/more_actions",width:25*j.iI})})]})})}function K(){var e=b.ZP.statuses.list().data,n=(0,s.useMemo)((function(){var n,t;return(null===e||void 0===e||null===(n=e.statuses)||void 0===n||null===(t=n[0])||void 0===t?void 0:t.instance_type)||"ecs"}),[e]),t=b.ZP.workspaces.list({cluster_type:n},{refreshInterval:5e3,revalidateOnFocus:!0}),r=t.data,o=t.mutate,i=(0,s.useMemo)((function(){var e;return null===r||void 0===r||null===(e=r.workspaces)||void 0===e?void 0:e.filter((function(e){return e.name}))}),[r]);return(0,P.jsx)(U,{pageName:D.WORKSPACES,subheaderChildren:(0,P.jsx)(C,{clusterType:n,fetchWorkspaces:o}),children:(0,P.jsx)(O.Z,{columnFlex:[2,4,2,3,1,null],columns:[{uuid:"Status"},{uuid:"Instance Name"},{uuid:"Type"},{uuid:"Public IP address"},{uuid:"Open"},{label:function(){return""},uuid:"Actions"}],rows:null===i||void 0===i?void 0:i.map((function(e){var t=e.instance,r=t.ip,i=t.name,c=t.status,s=t.type,a="http://".concat(r);return"ecs"===n&&(a="http://".concat(r,":6789")),[(0,P.jsx)(u.Z,{borderRadius:F.D7,danger:"STOPPED"===c,default:"PROVISIONING"===c,notClickable:!0,padding:"6px",primary:"RUNNING"===c,warning:"PENDING"===c,children:(0,_.vg)(c)},"status"),(0,P.jsx)(v.ZP,{children:i},"name"),(0,P.jsx)(v.ZP,{children:(0,_.vg)(s)},"type"),(0,P.jsx)(v.ZP,{children:r},"ip"),(0,P.jsx)(u.Z,{iconOnly:!0,onClick:function(){return window.open(a)},children:(0,P.jsx)(E.M0,{size:2*j.iI})},"open_button"),(0,P.jsx)(X,{clusterType:n,fetchWorkspaces:o,instance:t},"more_actions")]}))})})}K.getInitialProps=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})));var Y=(0,g.Z)(K)},13157:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage",function(){return t(70120)}])}},function(e){e.O(0,[844,7607,8789,1424,1005,8180,5540,9774,2888,179],(function(){return n=13157,e(e.s=n);var n}));var n=e.O();_N_E=n}]);