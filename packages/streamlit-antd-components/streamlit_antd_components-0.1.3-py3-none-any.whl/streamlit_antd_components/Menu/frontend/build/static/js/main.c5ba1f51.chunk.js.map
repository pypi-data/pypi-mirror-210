{"version":3,"sources":["custom.react.js","Menu.tsx","index.tsx"],"names":["strToNode","obj","Array","isArray","map","obj_","obj_copy","JSON","parse","stringify","deepCopy","icon","href","hasOwnProperty","children","_jsx","className","concat","label","target","rel","menuHeight","open_keys","items","item_height","arguments","length","undefined","n_arr","item","n","showItem","includes","item_","showItem_","arr","s","i","sum","AlphaColor","varColor","alpha","sColor","getComputedStyle","document","querySelector","getPropertyValue","toLowerCase","test","sColorNew","slice","sColorChange","push","parseInt","join","withStreamlitConnection","props","args","dsk","dok","k","allParentKeys","getParentKey","key","tree","parentKey","node","some","getParentKey_","getParent","_useState","useState","_useState2","_slicedToArray","selectKey","setSelectKey","_useState3","_useState4","height","setHeight","useEffect","Streamlit","setFrameHeight","ConfigProvider","theme","components","Menu","radiusItem","radiusSubMenuItem","colorItemText","colorGroupTitle","colorItemTextDisabled","colorItemTextHover","colorItemTextSelected","colorItemBgHover","colorItemBgSelected","colorSubItemBg","colorItemBg","colorActiveBarWidth","itemMarginInline","colorSplit","onSelect","e","hrefKeys","keys","getKey","getHrefKeys","indexOf","setComponentValue","onOpenChange","selectedKeys","style","borderRightWidth","defaultSelectedKeys","defaultOpenKeys","mode","ReactDOM","render","React","StrictMode","AntdMenu","getElementById"],"mappings":"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","file":"static/js/main.c5ba1f51.chunk.js","sourcesContent":["import React from \"react\";\r\nimport \"bootstrap-icons/font/bootstrap-icons.css\";\r\n\r\n//deep copy object func\r\nconst deepCopy = (obj) => {\r\n    return JSON.parse(JSON.stringify(obj))\r\n}\r\n//recurve str property to react node\r\nconst strToNode = (obj) => {\r\n    if (Array.isArray(obj)) {\r\n        return obj.map(obj_ => strToNode(obj_))\r\n    } else {\r\n        let obj_copy = deepCopy(obj);\r\n        const icon = obj_copy.icon;\r\n        const href = obj_copy.href;\r\n        if (obj_copy.hasOwnProperty('children')) {\r\n            obj_copy.children = obj_copy.children.map(obj_ => strToNode(obj_))\r\n        }\r\n        if (icon) {\r\n            obj_copy.icon = <span><i className={`bi bi-${icon}`}/></span>\r\n        }\r\n        if (href) {\r\n            obj_copy.label = <a href={href} target='_blank' rel='noreferrer'>{obj_copy.label}</a>\r\n        }\r\n        return obj_copy\r\n    }\r\n}\r\n\r\n//all parent keys\r\nconst getParent = (k, obj) => {\r\n    let allParentKeys = []\r\n    //get one parent key\r\n    const getParentKey = (key, tree) => {\r\n        let parentKey;\r\n        for (let i = 0; i < tree.length; i++) {\r\n            const node = tree[i];\r\n            if (node.children) {\r\n                if (node.children.some((item) => item.key === key)) {\r\n                    parentKey = node.key;\r\n                } else if (getParentKey(key, node.children)) {\r\n                    parentKey = getParentKey(key, node.children);\r\n                }\r\n            }\r\n        }\r\n        return parentKey;\r\n    }\r\n    const getParentKey_ = (k, obj) => {\r\n        let key = getParentKey(k, obj)\r\n        if (key) {\r\n            allParentKeys.push(key)\r\n            getParentKey_(key, obj)\r\n        }\r\n    }\r\n    getParentKey_(k, obj)\r\n    return allParentKeys\r\n}\r\n\r\nconst menuHeight = (open_keys, items, item_height = 45) => {\r\n\r\n    const showItem_ = (open_keys, item) => {\r\n        let n = 1\r\n        const showItem = (open_keys, item) => {\r\n            if (item.hasOwnProperty('key') && open_keys) {\r\n                if (item.hasOwnProperty('children')) {\r\n                    if (open_keys.includes(item['key']) || item.hasOwnProperty('type')) {\r\n                        n += item['children'].length\r\n                        item['children'].map(item_ => showItem(open_keys, item_))\r\n                    }\r\n                }\r\n            }\r\n            if (item.hasOwnProperty('dashed')) {\r\n                n = 0\r\n            }\r\n        }\r\n        showItem(open_keys, item)\r\n        return n\r\n    }\r\n\r\n    function sum(arr) {\r\n        let s = 0;\r\n        for (let i = arr.length - 1; i >= 0; i--) {\r\n            s += arr[i];\r\n        }\r\n        return s;\r\n    }\r\n\r\n    let n_arr = items.map(item => showItem_(open_keys, item))\r\n    let n = sum(n_arr)\r\n    return n * item_height\r\n}\r\n\r\n\r\nconst getHrefKeys = (items) => {\r\n    let keys = []\r\n\r\n    const getKey = (obj) => {\r\n        if (Array.isArray(obj)) {\r\n            obj.map(obj_ => getKey(obj_))\r\n        } else {\r\n            if (obj.hasOwnProperty('children')) {\r\n                obj.children.map((obj_) => getKey(obj_))\r\n            }\r\n            if (obj.href != null) {\r\n                keys.push(obj.key)\r\n            }\r\n        }\r\n    }\r\n    getKey(items)\r\n    return keys\r\n}\r\n\r\nconst AlphaColor = (varColor = '--primary-color', alpha = 0.1) => {\r\n    let pc = getComputedStyle(document.querySelector(\":root\")).getPropertyValue(varColor)\r\n    let reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;\r\n    let sColor = pc.toLowerCase();\r\n    if (sColor && reg.test(sColor)) {\r\n        if (sColor.length === 4) {\r\n            let sColorNew = \"#\";\r\n            for (let i = 1; i < 4; i += 1) {\r\n                sColorNew += sColor.slice(i, i + 1).concat(sColor.slice(i, i + 1));\r\n            }\r\n            sColor = sColorNew;\r\n        }\r\n        let sColorChange = [];\r\n        for (let i = 1; i < 7; i += 2) {\r\n            sColorChange.push(parseInt(`0x${sColor.slice(i, i + 2)}`));\r\n        }\r\n        return `rgba(${sColorChange.join(\",\")},${alpha})`;\r\n    } else {\r\n        return sColor;\r\n    }\r\n}\r\n\r\n\r\nexport {strToNode, AlphaColor, getParent, getHrefKeys, menuHeight}","import {Streamlit, ComponentProps, withStreamlitConnection} from \"streamlit-component-lib\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport type {MenuProps} from 'antd';\r\nimport {Menu, ConfigProvider} from 'antd';\r\nimport {strToNode, AlphaColor, getParent, getHrefKeys, menuHeight} from \"./custom.react\";\r\n\r\n\r\nconst AntdMenu = (props: ComponentProps) => {\r\n    //get data\r\n    const items = props.args['items']\r\n    const dsk = props.args['defaultSelectedKeys']\r\n    const dok = props.args['defaultOpenKeys'] ? props.args['defaultOpenKeys'] : dsk && getParent(dsk[0], items)\r\n\r\n    //state\r\n    const [selectKey, setSelectKey] = useState(dsk)\r\n    const [height, setHeight] = useState(menuHeight(dok, items))\r\n\r\n    //component height\r\n    useEffect(() => Streamlit.setFrameHeight(height))\r\n\r\n    //callback\r\n    const onSelect: MenuProps['onSelect'] = (e) => {\r\n        //only not href item will fire\r\n        let hrefKeys = getHrefKeys(items)\r\n        if (hrefKeys.indexOf(e.key) === -1) {\r\n            setSelectKey(e.key);\r\n            Streamlit.setComponentValue(e.key);\r\n        }\r\n    }\r\n    const onOpenChange: MenuProps['onOpenChange'] = (e) => {\r\n        //update component height\r\n        setHeight(menuHeight(e, items))\r\n    }\r\n\r\n    // antd menu component\r\n    return (\r\n        <ConfigProvider\r\n            theme={{\r\n                components: {\r\n                    //custom menu theme\r\n                    Menu: {\r\n                        radiusItem: 0,\r\n                        radiusSubMenuItem: 0,\r\n                        colorItemText: 'var(--text-color)',\r\n                        colorGroupTitle: AlphaColor('--text-color', 0.8),\r\n                        colorItemTextDisabled: AlphaColor('--text-color', 0.5),\r\n                        colorItemTextHover: 'var(--primary-color)',\r\n                        colorItemTextSelected: 'var(--primary-color)',\r\n                        colorItemBgHover: AlphaColor(),\r\n                        colorItemBgSelected: AlphaColor(),\r\n                        colorSubItemBg: 'var(--background-color)',\r\n                        colorItemBg: 'var(--background-color)',\r\n                        colorActiveBarWidth: 4,\r\n                        itemMarginInline: 0,\r\n                        colorSplit: AlphaColor('--text-color', 0.3),\r\n                    },\r\n                },\r\n            }}\r\n        >\r\n            <Menu\r\n                onSelect={onSelect}\r\n                onOpenChange={onOpenChange}\r\n                selectedKeys={selectKey}\r\n                style={{borderRightWidth: 0}}\r\n                defaultSelectedKeys={[dsk]}\r\n                defaultOpenKeys={dok}\r\n                mode={'inline'}\r\n                items={strToNode(items)}\r\n            />\r\n        </ConfigProvider>\r\n    );\r\n};\r\n\r\nexport default withStreamlitConnection(AntdMenu)\r\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport AntdMenu from \"./Menu\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <AntdMenu />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}