{"version":3,"sources":["custom.react.js","Tree.tsx","index.tsx"],"names":["strToNode","obj","Array","isArray","map","obj_","obj_copy","JSON","parse","stringify","deepCopy","icon","hasOwnProperty","children","_jsx","className","concat","AlphaColor","varColor","arguments","length","undefined","alpha","sColor","getComputedStyle","document","querySelector","getPropertyValue","toLowerCase","test","sColorNew","i","slice","sColorChange","push","parseInt","join","treeHeight","open_keys","items","item_height","n_arr","item","n","showItem","includes","item_","showItem_","arr","s","sum","getParentKey","key","tree","parentKey","node","some","withStreamlitConnection","props","treeData","args","dsk","dek","k","dea","_useState","useState","_useState2","_slicedToArray","value","setValue","_useState3","_useState4","height","setHeight","useEffect","Streamlit","setFrameHeight","ConfigProvider","theme","components","Tree","colorPrimary","colorPrimaryHover","colorBgContainer","colorText","colorTextDisabled","controlItemBgHover","controlItemBgActive","onSelect","selectedKeys_","info","setComponentValue","onCheck","checkedKeys_","ck","onExpand","e","selectedKeys","checkedKeys","defaultSelectedKeys","defaultCheckedKeys","defaultExpandedKeys","defaultExpandAll","showLine","multiple","checkable","selectable","checkStrictly","switcherIcon","CaretDownFilled","showIcon","style","whiteSpace","overflowX","overflowY","ReactDOM","render","React","StrictMode","AntdTree","getElementById"],"mappings":"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","file":"static/js/main.fbab1880.chunk.js","sourcesContent":["import React from \"react\";\r\nimport \"bootstrap-icons/font/bootstrap-icons.css\";\r\n\r\n//deep copy object func\r\nconst deepCopy = (obj) => {\r\n    return JSON.parse(JSON.stringify(obj))\r\n}\r\n//recurve str property to react node\r\nconst strToNode = (obj) => {\r\n    if (Array.isArray(obj)) {\r\n        return obj.map(obj_ => strToNode(obj_))\r\n    } else {\r\n        let obj_copy = deepCopy(obj);\r\n        const icon = obj_copy.icon;\r\n        if (obj_copy.hasOwnProperty('children')) {\r\n            obj_copy.children = obj_copy.children.map(obj_ => strToNode(obj_))\r\n        }\r\n        if (icon) {\r\n            obj_copy.icon = <i className={`bi bi-${icon}`}/>\r\n        }\r\n        return obj_copy\r\n    }\r\n}\r\n\r\nconst AlphaColor = (varColor = '--primary-color', alpha = 0.2) => {\r\n    let pc = getComputedStyle(document.querySelector(\":root\")).getPropertyValue(varColor)\r\n    let reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;\r\n    let sColor = pc.toLowerCase();\r\n    if (sColor && reg.test(sColor)) {\r\n        if (sColor.length === 4) {\r\n            let sColorNew = \"#\";\r\n            for (let i = 1; i < 4; i += 1) {\r\n                sColorNew += sColor.slice(i, i + 1).concat(sColor.slice(i, i + 1));\r\n            }\r\n            sColor = sColorNew;\r\n        }\r\n        let sColorChange = [];\r\n        for (let i = 1; i < 7; i += 2) {\r\n            sColorChange.push(parseInt(`0x${sColor.slice(i, i + 2)}`));\r\n        }\r\n        return `rgba(${sColorChange.join(\",\")},${alpha})`;\r\n    } else {\r\n        return sColor;\r\n    }\r\n}\r\n\r\nconst treeHeight = (open_keys, items, item_height = 30) => {\r\n\r\n    const showItem_ = (open_keys, item) => {\r\n        let n = 1\r\n        const showItem = (open_keys, item) => {\r\n            if (item.hasOwnProperty('key') && open_keys) {\r\n                if (item.hasOwnProperty('children')) {\r\n                    if (open_keys.includes(item['key'])) {\r\n                        n += item['children'].length\r\n                        item['children'].map(item_ => showItem(open_keys, item_))\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        showItem(open_keys, item)\r\n        return n\r\n    }\r\n\r\n    function sum(arr) {\r\n        let s = 0;\r\n        for (let i = arr.length - 1; i >= 0; i--) {\r\n            s += arr[i];\r\n        }\r\n        return s;\r\n    }\r\n\r\n    let n_arr = items.map(item => showItem_(open_keys, item))\r\n    let n = sum(n_arr)\r\n    return n * item_height\r\n}\r\n\r\nexport {strToNode, AlphaColor, treeHeight}","import {Streamlit, ComponentProps, withStreamlitConnection} from \"streamlit-component-lib\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport type {TreeProps, DataNode} from 'antd/es/tree';\r\nimport {Tree, ConfigProvider} from 'antd';\r\nimport {CaretDownFilled} from '@ant-design/icons';\r\nimport {strToNode, AlphaColor,treeHeight} from \"./custom.react\";\r\nimport './custom.css'\r\n\r\n\r\nconst getParentKey = (key: React.Key, tree: DataNode[]): React.Key => {\r\n    let parentKey: React.Key;\r\n    for (let i = 0; i < tree.length; i++) {\r\n        const node = tree[i];\r\n        if (node.children) {\r\n            if (node.children.some((item) => item.key === key)) {\r\n                parentKey = node.key;\r\n            } else if (getParentKey(key, node.children)) {\r\n                parentKey = getParentKey(key, node.children);\r\n            }\r\n        }\r\n    }\r\n    return parentKey!;\r\n};\r\n\r\n\r\nconst AntdTree = (props: ComponentProps) => {\r\n    //get data\r\n    const treeData = strToNode(props.args['treeData']);\r\n    const dsk = props.args['defaultSelectedKey']\r\n    const dek = props.args['defaultExpandedKey'] ? props.args['defaultExpandedKey'] : dsk && dsk.map((k: React.Key) => getParentKey(k, treeData))\r\n    const dea = props.args['defaultExpandAll']\r\n    const icon = props.args['icon']\r\n\r\n    //state\r\n    const [value, setValue] = useState(dsk)\r\n    const [height,setHeight]=useState(treeHeight(dek,treeData))\r\n\r\n    // component height\r\n    useEffect(() => Streamlit.setFrameHeight(height))\r\n\r\n    //callback\r\n    const onExpand: TreeProps['onExpand'] = (e) => {\r\n        //update component height\r\n        setHeight(treeHeight(e,treeData))\r\n    };\r\n    const onSelect: TreeProps['onSelect'] = (selectedKeys_, info) => {\r\n        setValue(selectedKeys_)\r\n        Streamlit.setComponentValue(selectedKeys_);\r\n    };\r\n    const onCheck: TreeProps['onCheck'] = (checkedKeys_, info) => {\r\n        let ck = (Array.isArray(checkedKeys_)) ? checkedKeys_ : checkedKeys_['checked']\r\n        setValue(ck)\r\n        Streamlit.setComponentValue(ck)\r\n    }\r\n\r\n    // antd menu component\r\n    return (\r\n        <ConfigProvider\r\n            theme={{\r\n                components: {\r\n                    //custom tree theme\r\n                    Tree: {\r\n                        colorPrimary: 'var(--primary-color)',\r\n                        colorPrimaryHover: 'var(--primary-color)',\r\n                        colorBgContainer: 'var(--background-color)',\r\n                        colorText: 'var(--text-color)',\r\n                        colorTextDisabled: AlphaColor('--text-color', 0.5),\r\n                        controlItemBgHover: AlphaColor('--text-color', 0.2),\r\n                        controlItemBgActive: AlphaColor(),\r\n                    },\r\n                },\r\n            }}\r\n        >\r\n            <div>\r\n                <Tree\r\n                    onSelect={onSelect}\r\n                    onCheck={onCheck}\r\n                    onExpand={onExpand}\r\n                    selectedKeys={value}\r\n                    checkedKeys={value}\r\n                    defaultSelectedKeys={dsk}\r\n                    defaultCheckedKeys={dsk}\r\n                    defaultExpandedKeys={dek}\r\n                    treeData={treeData}\r\n                    defaultExpandAll={dea}\r\n                    showLine={props.args['showLine']}\r\n                    multiple={props.args['multiple']}\r\n                    checkable={props.args['checkable']}\r\n                    selectable={!props.args['checkable']}\r\n                    height={props.args['height']}\r\n                    checkStrictly={props.args['checkStrictly']}\r\n                    switcherIcon={<CaretDownFilled/>}\r\n                    showIcon={true}\r\n                    icon={icon && <i className={`bi bi-${icon}`}/>}\r\n                    style={{whiteSpace: 'nowrap', overflowX: 'auto', overflowY: 'hidden'}}\r\n                />\r\n            </div>\r\n        </ConfigProvider>\r\n    );\r\n};\r\n\r\nexport default withStreamlitConnection(AntdTree)\r\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport AntdTree from \"./Tree\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <AntdTree />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}