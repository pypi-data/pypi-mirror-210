(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_modals_dashboardWidgetQuerySelectorModal_tsx-app_components_searchSyntax_parse-79433b"],{"./app/components/modals/dashboardWidgetQuerySelectorModal.tsx":(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>V,modalCss:()=>T});var s=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=a("../node_modules/react/index.js"),l=a("./app/components/button.tsx"),n=a("./app/components/input.tsx"),o=a("./app/components/links/link.tsx"),r=a("./app/icons/index.tsx"),u=a("./app/locale.tsx"),d=a("./app/styles/space.tsx"),c=a("./app/utils/analytics.tsx"),p=a("./app/utils/withApi.tsx"),g=a("./app/utils/withPageFilters.tsx"),h=a("./app/views/dashboards/utils.tsx"),m=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class y extends i.Component{renderQueries(){const{organization:e,widget:t,selection:a,isMetricsData:s}=this.props;return t.queries.map(((l,n)=>{const d=(0,h.z1)({...t,queries:[l]},a,e,0,s);return(0,m.tZ)(i.Fragment,{children:(0,m.BX)(x,{children:[(0,m.BX)(k,{children:[(0,m.tZ)(b,{htmlFor:"smart-search-input","aria-label":(0,u.t)("Search events"),children:(0,m.tZ)(r.jV,{})}),(0,m.tZ)(v,{value:l.conditions,disabled:!0})]}),(0,m.tZ)(o.Z,{to:d,children:(0,m.tZ)(f,{priority:"primary",icon:(0,m.tZ)(r.g6,{size:"xs",direction:"right"}),onClick:()=>{(0,c.Gi)("dashboards_views.query_selector.selected",{organization:e,widget_type:t.displayType})},"aria-label":(0,u.t)("Open in Discover")})})]})},n)}))}render(){const{Body:e,Header:t,widget:a}=this.props;return(0,m.BX)(i.Fragment,{children:[(0,m.tZ)(t,{closeButton:!0,children:(0,m.tZ)("h4",{children:a.title})}),(0,m.BX)(e,{children:[(0,m.tZ)("p",{children:(0,u.t)("Multiple queries were used to create this widget visualization. Which query would you like to view in Discover?")}),this.renderQueries()]})]})}}y.displayName="DashboardWidgetQuerySelectorModal";const v=(0,s.Z)(n.Z,{target:"e1n1ofqe4"})({name:"97snz3",styles:"text-overflow:ellipsis;padding:0px;box-shadow:none;height:auto;&:disabled{border:none;cursor:default;}"}),x=(0,s.Z)("div",{target:"e1n1ofqe3"})("display:flex;margin-bottom:",(0,d.D)(1),";"),f=(0,s.Z)(l.zx,{target:"e1n1ofqe2"})("margin-left:",(0,d.D)(1),";"),k=(0,s.Z)("div",{target:"e1n1ofqe1"})("border:1px solid ",(e=>e.theme.border),";box-shadow:inset ",(e=>e.theme.dropShadowMedium),";background:",(e=>e.theme.backgroundSecondary),";padding:7px ",(0,d.D)(1),";position:relative;display:grid;grid-template-columns:max-content 1fr max-content;gap:",(0,d.D)(1),";align-items:start;flex-grow:1;border-radius:",(e=>e.theme.borderRadius),";"),b=(0,s.Z)("label",{target:"e1n1ofqe0"})("display:flex;padding:",(0,d.D)(.5)," 0;margin:0;color:",(e=>e.theme.gray300),";"),T={name:"l07bt5",styles:"width:100%;max-width:700px;margin:70px auto"},V=(0,p.Z)((0,g.Z)(y))},"./app/components/searchSyntax/parser.tsx":(e,t,a)=>{"use strict";a.d(t,{D3:()=>K,J$:()=>x,UG:()=>D,WU:()=>p,iq:()=>b,me:()=>y,oV:()=>g,vA:()=>m});var s=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=a("../node_modules/moment/moment.js"),l=a.n(i),n=a("./app/locale.tsx"),o=a("./app/utils/discover/fields.tsx"),r=a("./app/components/searchSyntax/grammar.pegjs"),u=a.n(r),d=a("./app/components/searchSyntax/utils.tsx");const c=e=>{let[t,a,s,i,l]=e;return{separator:[t.value,a,s.value].join(""),value:l}};let p,g,h,m;!function(e){e.Spaces="spaces",e.Filter="filter",e.FreeText="freeText",e.LogicGroup="logicGroup",e.LogicBoolean="logicBoolean",e.KeySimple="keySimple",e.KeyExplicitTag="keyExplicitTag",e.KeyAggregate="keyAggregate",e.KeyAggregateArgs="keyAggregateArgs",e.KeyAggregateParam="keyAggregateParam",e.ValueIso8601Date="valueIso8601Date",e.ValueRelativeDate="valueRelativeDate",e.ValueDuration="valueDuration",e.ValueSize="valueSize",e.ValuePercentage="valuePercentage",e.ValueBoolean="valueBoolean",e.ValueNumber="valueNumber",e.ValueText="valueText",e.ValueNumberList="valueNumberList",e.ValueTextList="valueTextList"}(p||(p={})),function(e){e.Default="",e.GreaterThanEqual=">=",e.LessThanEqual="<=",e.GreaterThan=">",e.LessThan="<",e.Equal="=",e.NotEqual="!="}(g||(g={})),function(e){e.And="AND",e.Or="OR"}(h||(h={})),function(e){e.Text="text",e.TextIn="textIn",e.Date="date",e.SpecificDate="specificDate",e.RelativeDate="relativeDate",e.Duration="duration",e.Size="size",e.Numeric="numeric",e.NumericIn="numericIn",e.Boolean="boolean",e.AggregateDuration="aggregateDuration",e.AggregateSize="aggregateSize",e.AggregatePercentage="aggregatePercentage",e.AggregateNumeric="aggregateNumeric",e.AggregateDate="aggregateDate",e.AggregateRelativeDate="aggregateRelativeDate",e.Has="has",e.Is="is"}(m||(m={}));const y=[g.Default,g.GreaterThanEqual,g.LessThanEqual,g.GreaterThan,g.LessThan,g.Equal,g.NotEqual],v=[g.Default,g.NotEqual],x={[m.SpecificDate]:[m.Date],[m.Date]:[m.SpecificDate]},f=[p.KeySimple,p.KeyExplicitTag],k={b:1e9,m:1e6,k:1e3},b={[m.Text]:{validKeys:f,validOps:v,validValues:[p.ValueText],canNegate:!0},[m.TextIn]:{validKeys:f,validOps:[],validValues:[p.ValueTextList],canNegate:!0},[m.Date]:{validKeys:[p.KeySimple],validOps:y,validValues:[p.ValueIso8601Date],canNegate:!1},[m.SpecificDate]:{validKeys:[p.KeySimple],validOps:[],validValues:[p.ValueIso8601Date],canNegate:!1},[m.RelativeDate]:{validKeys:[p.KeySimple],validOps:[],validValues:[p.ValueRelativeDate],canNegate:!1},[m.Duration]:{validKeys:[p.KeySimple],validOps:y,validValues:[p.ValueDuration],canNegate:!0},[m.Size]:{validKeys:[p.KeySimple],validOps:y,validValues:[p.ValueSize],canNegate:!0},[m.Numeric]:{validKeys:[p.KeySimple],validOps:y,validValues:[p.ValueNumber],canNegate:!0},[m.NumericIn]:{validKeys:[p.KeySimple],validOps:[],validValues:[p.ValueNumberList],canNegate:!0},[m.Boolean]:{validKeys:[p.KeySimple],validOps:v,validValues:[p.ValueBoolean],canNegate:!0},[m.AggregateDuration]:{validKeys:[p.KeyAggregate],validOps:y,validValues:[p.ValueDuration],canNegate:!0},[m.AggregateSize]:{validKeys:[p.KeyAggregate],validOps:y,validValues:[p.ValueSize],canNegate:!0},[m.AggregateNumeric]:{validKeys:[p.KeyAggregate],validOps:y,validValues:[p.ValueNumber],canNegate:!0},[m.AggregatePercentage]:{validKeys:[p.KeyAggregate],validOps:y,validValues:[p.ValuePercentage],canNegate:!0},[m.AggregateDate]:{validKeys:[p.KeyAggregate],validOps:y,validValues:[p.ValueIso8601Date],canNegate:!0},[m.AggregateRelativeDate]:{validKeys:[p.KeyAggregate],validOps:y,validValues:[p.ValueRelativeDate],canNegate:!0},[m.Has]:{validKeys:[p.KeySimple],validOps:v,validValues:[],canNegate:!0},[m.Is]:{validKeys:[p.KeySimple],validOps:v,validValues:[p.ValueText],canNegate:!0}},T={textOperatorKeys:new Set(["release.version","release.build","release.package","release.stage"]),durationKeys:new Set(["transaction.duration"]),percentageKeys:new Set(["percentage"]),numericKeys:new Set(["project_id","project.id","issue.id","stack.colno","stack.lineno","stack.stack_level","transaction.duration"]),dateKeys:new Set(["start","end","firstSeen","lastSeen","last_seen()","time","event.timestamp","timestamp","timestamp.to_hour","timestamp.to_day"]),booleanKeys:new Set(["error.handled","error.unhandled","stack.in_app","team_key_transaction"]),sizeKeys:new Set([]),allowBoolean:!0},V={TokenConverter:class{constructor(e){let{text:t,location:a,config:i}=e;(0,s.Z)(this,"text",void 0),(0,s.Z)(this,"location",void 0),(0,s.Z)(this,"config",void 0),(0,s.Z)(this,"keyValidation",{isNumeric:e=>this.config.numericKeys.has(e)||(0,o.Xr)(e)||(0,o.yK)(e),isBoolean:e=>this.config.booleanKeys.has(e),isPercentage:e=>this.config.percentageKeys.has(e),isDate:e=>this.config.dateKeys.has(e),isDuration:e=>this.config.durationKeys.has(e)||(0,o.yK)(e)||"duration"===(0,o.Cq)(e),isSize:e=>this.config.sizeKeys.has(e)}),(0,s.Z)(this,"tokenSpaces",(e=>({...this.defaultTokenFields,type:p.Spaces,value:e}))),(0,s.Z)(this,"tokenFilter",((e,t,a,s,i)=>{const l={type:p.Filter,filter:e,key:t,value:a,negated:i,operator:s??g.Default,invalid:this.checkInvalidFilter(e,t,a)};return{...this.defaultTokenFields,...l}})),(0,s.Z)(this,"tokenFreeText",((e,t)=>({...this.defaultTokenFields,type:p.FreeText,value:e,quoted:t}))),(0,s.Z)(this,"tokenLogicGroup",(e=>({...this.defaultTokenFields,type:p.LogicGroup,inner:e}))),(0,s.Z)(this,"tokenLogicBoolean",(e=>({...this.defaultTokenFields,type:p.LogicBoolean,value:e}))),(0,s.Z)(this,"tokenKeySimple",((e,t)=>({...this.defaultTokenFields,type:p.KeySimple,value:e,quoted:t}))),(0,s.Z)(this,"tokenKeyExplicitTag",((e,t)=>({...this.defaultTokenFields,type:p.KeyExplicitTag,prefix:e,key:t}))),(0,s.Z)(this,"tokenKeyAggregateParam",((e,t)=>({...this.defaultTokenFields,type:p.KeyAggregateParam,value:e,quoted:t}))),(0,s.Z)(this,"tokenKeyAggregate",((e,t,a,s)=>({...this.defaultTokenFields,type:p.KeyAggregate,name:e,args:t,argsSpaceBefore:a,argsSpaceAfter:s}))),(0,s.Z)(this,"tokenKeyAggregateArgs",((e,t)=>({...this.defaultTokenFields,type:p.KeyAggregateArgs,args:[{separator:"",value:e},...t.map(c)]}))),(0,s.Z)(this,"tokenValueIso8601Date",(e=>({...this.defaultTokenFields,type:p.ValueIso8601Date,value:l()(e)}))),(0,s.Z)(this,"tokenValueRelativeDate",((e,t,a)=>({...this.defaultTokenFields,type:p.ValueRelativeDate,value:Number(e),sign:t,unit:a}))),(0,s.Z)(this,"tokenValueDuration",((e,t)=>({...this.defaultTokenFields,type:p.ValueDuration,value:Number(e),unit:t}))),(0,s.Z)(this,"tokenValueSize",((e,t)=>({...this.defaultTokenFields,type:p.ValueSize,value:Number(e),unit:t}))),(0,s.Z)(this,"tokenValuePercentage",(e=>({...this.defaultTokenFields,type:p.ValuePercentage,value:Number(e)}))),(0,s.Z)(this,"tokenValueBoolean",(e=>({...this.defaultTokenFields,type:p.ValueBoolean,value:["1","true"].includes(e.toLowerCase())}))),(0,s.Z)(this,"tokenValueNumber",((e,t)=>({...this.defaultTokenFields,type:p.ValueNumber,value:e,rawValue:Number(e)*(k[t]??1),unit:t}))),(0,s.Z)(this,"tokenValueNumberList",((e,t)=>({...this.defaultTokenFields,type:p.ValueNumberList,items:[{separator:"",value:e},...t.map(c)]}))),(0,s.Z)(this,"tokenValueTextList",((e,t)=>({...this.defaultTokenFields,type:p.ValueTextList,items:[{separator:"",value:e},...t.map(c)]}))),(0,s.Z)(this,"tokenValueText",((e,t)=>({...this.defaultTokenFields,type:p.ValueText,value:e,quoted:t}))),(0,s.Z)(this,"predicateFilter",((e,t)=>{const a=(0,d.Ck)(t),s=t,{isNumeric:i,isDuration:l,isBoolean:n,isDate:o,isPercentage:r,isSize:u}=this.keyValidation,c=e=>s.args?.args.some((t=>e(t?.value?.value??"")));switch(e){case m.Numeric:case m.NumericIn:return i(a);case m.Duration:return l(a);case m.Size:return u(a);case m.Boolean:return n(a);case m.Date:case m.RelativeDate:case m.SpecificDate:return o(a);case m.AggregateDuration:return c(l);case m.AggregateDate:return c(o);case m.AggregatePercentage:return c(r);default:return!0}})),(0,s.Z)(this,"predicateTextOperator",(e=>this.config.textOperatorKeys.has((0,d.Ck)(e)))),(0,s.Z)(this,"checkInvalidFilter",((e,t,a)=>this.config.validateKeys&&this.config.supportedTags&&!this.config.supportedTags[t.text]?{reason:(0,n.t)('Invalid key. "%s" is not a supported search key.',t.text)}:e===m.Text?this.checkInvalidTextFilter(t,a):e===m.Is||e===m.Has?this.checkInvalidTextValue(a):[m.TextIn,m.NumericIn].includes(e)?this.checkInvalidInFilter(a):null)),(0,s.Z)(this,"checkInvalidTextFilter",((e,t)=>{if(e.type===p.KeyExplicitTag)return this.checkInvalidTextValue(t);const a=(0,d.Ck)(e);if(this.keyValidation.isDuration(a))return{reason:(0,n.t)("Invalid duration. Expected number followed by duration unit suffix"),expectedType:[m.Duration]};if(this.keyValidation.isDate(a)){const e=new Date;e.setSeconds(0),e.setMilliseconds(0);const t=e.toISOString();return{reason:(0,n.t)("Invalid date format. Expected +/-duration (e.g. +1h) or ISO 8601-like (e.g. %s or %s)",t.slice(0,10),t),expectedType:[m.Date,m.SpecificDate,m.RelativeDate]}}return this.keyValidation.isBoolean(a)?{reason:(0,n.t)("Invalid boolean. Expected true, 1, false, or 0."),expectedType:[m.Boolean]}:this.keyValidation.isSize(a)?{reason:(0,n.t)("Invalid file size. Expected number followed by file size unit suffix"),expectedType:[m.Size]}:this.keyValidation.isNumeric(a)?{reason:(0,n.t)("Invalid number. Expected number then optional k, m, or b suffix (e.g. 500k)"),expectedType:[m.Numeric,m.NumericIn]}:this.checkInvalidTextValue(t)})),(0,s.Z)(this,"checkInvalidTextValue",(e=>!e.quoted&&/(^|[^\\])"/.test(e.value)?{reason:(0,n.t)("Quotes must enclose text or be escaped")}:e.quoted||""!==e.value?null:{reason:(0,n.t)("Filter must have a value")})),(0,s.Z)(this,"checkInvalidInFilter",(e=>{let{items:t}=e;return t.some((e=>null===e.value))?{reason:(0,n.t)("Lists should not have empty values")}:null})),this.text=t,this.location=a,this.config=i}get defaultTokenFields(){return{text:this.text(),location:this.location()}}},TermOperator:g,FilterType:m,config:T};function D(e,t){const a=t?{...t,...Object.keys(T).reduce(((e,a)=>(e[a]="object"==typeof T[a]?new Set([...T[a],...t[a]??[]]):T[a],e)),{})}:T;try{return u().parse(e,{...V,config:a})}catch(e){}return null}function K(e,t,a){return e&&e.length?(t?" ":"")+(1===e.length?e[0].text:e.map((e=>e.text)).join(a?" ":"")):""}},"./app/utils/getRouteStringFromRoutes.tsx":(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var s=a("../node_modules/lodash/findLastIndex.js"),i=a.n(s);function l(e){if(!Array.isArray(e))return"";const t=e.filter((e=>!!e.path)),a=i()(t,(e=>{let{path:t}=e;return t.startsWith("/")}));return t.slice(a).filter((e=>{let{path:t}=e;return!!t})).map((e=>{let{path:t}=e;return t})).join("")}},"./app/utils/withProject.tsx":(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=a("../node_modules/react/index.js"),l=a("./app/sentryTypes.tsx"),n=a("./app/utils/getDisplayName.tsx"),o=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=e=>{var t;return t=class extends i.Component{render(){const{project:t,...a}=this.props;return(0,o.tZ)(e,{project:t??this.context.project,...a})}},(0,s.Z)(t,"displayName",`withProject(${(0,n.Z)(e)})`),(0,s.Z)(t,"contextTypes",{project:l.Z.Project}),t}},"../node_modules/lodash/cloneDeep.js":(e,t,a)=>{var s=a("../node_modules/lodash/_baseClone.js");e.exports=function(e){return s(e,5)}},"../node_modules/lodash/isEmpty.js":(e,t,a)=>{var s=a("../node_modules/lodash/_baseKeys.js"),i=a("../node_modules/lodash/_getTag.js"),l=a("../node_modules/lodash/isArguments.js"),n=a("../node_modules/lodash/isArray.js"),o=a("../node_modules/lodash/isArrayLike.js"),r=a("../node_modules/lodash/isBuffer.js"),u=a("../node_modules/lodash/_isPrototype.js"),d=a("../node_modules/lodash/isTypedArray.js"),c=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(n(e)||"string"==typeof e||"function"==typeof e.splice||r(e)||d(e)||l(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(u(e))return!s(e).length;for(var a in e)if(c.call(e,a))return!1;return!0}},"../node_modules/lodash/isNil.js":e=>{e.exports=function(e){return null==e}},"../node_modules/lodash/isNumber.js":(e,t,a)=>{var s=a("../node_modules/lodash/_baseGetTag.js"),i=a("../node_modules/lodash/isObjectLike.js");e.exports=function(e){return"number"==typeof e||i(e)&&"[object Number]"==s(e)}},"../node_modules/lodash/maxBy.js":(e,t,a)=>{var s=a("../node_modules/lodash/_baseExtremum.js"),i=a("../node_modules/lodash/_baseGt.js"),l=a("../node_modules/lodash/_baseIteratee.js");e.exports=function(e,t){return e&&e.length?s(e,l(t,2),i):void 0}},"../node_modules/lodash/set.js":(e,t,a)=>{var s=a("../node_modules/lodash/_baseSet.js");e.exports=function(e,t,a){return null==e?e:s(e,t,a)}},"../node_modules/lodash/uniqBy.js":(e,t,a)=>{var s=a("../node_modules/lodash/_baseIteratee.js"),i=a("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t){return e&&e.length?i(e,s(t,2)):[]}}}]);
//# sourceMappingURL=../sourcemaps/app_components_modals_dashboardWidgetQuerySelectorModal_tsx-app_components_searchSyntax_parse-79433b.5f09b714aa0e0da7edf5c54662fc57a5.js.map