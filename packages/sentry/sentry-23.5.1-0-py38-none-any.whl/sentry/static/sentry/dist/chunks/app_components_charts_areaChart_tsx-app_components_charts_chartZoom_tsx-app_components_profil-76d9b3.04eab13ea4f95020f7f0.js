"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_areaChart_tsx-app_components_charts_chartZoom_tsx-app_components_profil-76d9b3"],{"./app/components/charts/areaChart.tsx":(e,t,o)=>{o.d(t,{T:()=>a});var s=o("./app/components/charts/series/lineSeries.tsx"),n=o("./app/components/charts/baseChart.tsx"),r=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{series:t,stacked:o,colors:a,...i}=e;return(0,r.tZ)(n.Z,{...i,"data-test-id":"area-chart",colors:a,series:t.map(((e,t)=>{let{seriesName:n,data:r,...i}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.Z)({...e})}({stack:o?"area":void 0,name:n,data:r.map((e=>{let{name:t,value:o}=e;return[t,o]})),lineStyle:{color:a?.[t],opacity:1,width:.4},areaStyle:{color:a?.[t],opacity:1},animation:!1,animationThreshold:1,animationDuration:0,...i})}))})}a.displayName="AreaChart"},"./app/components/charts/chartZoom.tsx":(e,t,o)=>{o.d(t,{Z:()=>f});var s=o("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(o("../node_modules/core-js/modules/es.array.push.js"),o("../node_modules/react/index.js")),r=o("../node_modules/moment/moment.js"),a=o.n(r),i=o("../node_modules/query-string/index.js"),c=o("./app/actionCreators/pageFilters.tsx"),l=o("./app/components/charts/components/dataZoomInside.tsx");o("../node_modules/echarts/lib/component/dataZoomSlider.js");const u={realtime:!1,showDetail:!1,left:0,right:6,bottom:8};function p(e){return e&&Array.isArray(e)?e:[{...u,...e}]}var d=o("./app/components/charts/components/toolBox.tsx"),m=o("./app/utils/callIfFunction.tsx"),h=o("./app/utils/dates.tsx");const y=e=>e?a().utc(e).format(a().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class g extends n.Component{constructor(e){var t;super(e),t=this,(0,s.Z)(this,"history",void 0),(0,s.Z)(this,"currentPeriod",void 0),(0,s.Z)(this,"zooming",null),(0,s.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:y(e.start),end:y(e.end)}})),(0,s.Z)(this,"setPeriod",(function(e){let{period:o,start:s,end:n}=e,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:a,onZoom:l,usePageDate:u}=t.props,p=y(s),d=y(n);r&&t.history.push(t.currentPeriod),l?.({period:o,start:p,end:d}),t.zooming=()=>{if(u&&a){const e={...a.location.query,pageStart:s?(0,h.v5)(s):void 0,pageEnd:n?(0,h.v5)(n):void 0,pageStatsPeriod:o??void 0};i.stringify(e)!==i.stringify(a.location.query)&&a.push({pathname:a.location.pathname,query:e})}else(0,c.dR)({period:o,start:p?(0,h.hC)(p):p,end:d?(0,h.hC)(d):d},a,{skipDesyncUpdate:!0});t.saveCurrentPeriod({period:o,start:s,end:n})}})),(0,s.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,s.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],this.props.onRestore?.(e,t))})),(0,s.Z)(this,"handleDataZoom",((e,t)=>{const o=t.getModel(),{startValue:s,endValue:n}=o._payload.batch[0];if(null===s&&null===n){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=a().utc(s),t=a().utc(n);this.setPeriod({period:null,start:e,end:t},!0)}this.props.onDataZoom?.(e,t)})),(0,s.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const o=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));o&&!o._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,m.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:o,disabled:s,children:n,xAxisIndex:r,router:a,onZoom:i,onRestore:c,onChartReady:u,onDataZoom:m,onFinished:y,showSlider:g,chartZoomOptions:f,...x}=this.props,Z=e??void 0,k=t?(0,h.hC)(t):void 0,b=o?(0,h.hC)(o):void 0;return n(s?{utc:Z,start:k,end:b,...x}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:Z,start:k,end:b,dataZoom:g?[...p({xAxisIndex:r,...f}),...(0,l.Z)({xAxisIndex:r,...f})]:(0,l.Z)({xAxisIndex:r,...f}),showTimeInTooltip:!0,toolBox:(0,d.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...x})}}g.displayName="ChartZoom";const f=g},"./app/components/performanceDuration.tsx":(e,t,o)=>{o.d(t,{Z:()=>i});var s=o("./app/components/duration.tsx"),n=o("./app/utils.tsx"),r=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){const t=function(e){return(0,n.ri)(e.nanoseconds)}(e)?e.nanoseconds/1e9:function(e){return(0,n.ri)(e.milliseconds)}(e)?e.milliseconds/1e3:e.seconds;return(0,r.tZ)(s.Z,{abbreviation:e.abbreviation,seconds:t,fixedDigits:2})}a.displayName="PerformanceDuration";const i=a},"./app/components/profiling/suspectFunctions/suspectFunctionsTable.tsx":(e,t,o)=>{o.d(t,{f:()=>E});var s=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(o("../node_modules/core-js/modules/es.array.push.js"),o("../node_modules/react/index.js")),r=o("../node_modules/react-router/es/index.js"),a=o("./app/components/compactSelect/index.tsx"),i=o("./app/components/pagination.tsx"),c=(o("../node_modules/core-js/modules/es.array.unshift.js"),o("./app/components/count.tsx")),l=o("./app/components/gridEditable/index.tsx"),u=o("./app/components/performanceDuration.tsx"),p=o("./app/components/links/link.tsx"),d=o("./app/locale.tsx"),m=o("./app/styles/space.tsx"),h=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function y(e){let{items:t}=e;const[o,s]=(0,n.useState)(!1),r=t[0];return(0,h.BX)(f,{expanded:o,children:[r&&(0,h.tZ)(g,{item:r}),t.length>1&&o&&t.slice(1,t.length).map((e=>(0,h.tZ)(g,{item:e},e.value))),t.length>1?(0,h.tZ)(Z,{children:(0,h.tZ)("button",{onClick:()=>s(!o),children:o?(0,d.t)("[collapse]"):(0,d.t)("[+%s more]",t.length-1)})}):null]})}function g(e){let{item:t}=e;return(0,h.tZ)(x,{children:(0,h.tZ)(p.Z,{to:t.target,onClick:t?.onClick,children:t.value})})}y.displayName="ArrayLinks",g.displayName="LinkedItem";const f=(0,s.Z)("div",{target:"e153a8kj2"})("display:flex;flex-direction:",(e=>e.expanded?"column":"row"),";"),x=(0,s.Z)("span",{target:"e153a8kj1"})("flex-shrink:1;display:block;",(e=>e.theme.overflowEllipsis),";width:unset;"),Z=(0,s.Z)("div",{target:"e153a8kj0"})("white-space:nowrap;& button{background:none;border:0;outline:none;padding:0;cursor:pointer;color:",(e=>e.theme.linkColor),";margin-left:",(0,m.D)(.5),";}");var k=o("./app/utils/analytics.tsx"),b=o("./app/utils/discover/styles.tsx"),v=o("./app/utils/events.tsx"),C=o("./app/utils/profiling/routes.tsx"),w=o("./app/utils/profiling/tableRenderer.tsx"),_=o("./app/utils/useLocation.tsx"),j=o("./app/utils/useOrganization.tsx");function S(e){const t=(0,_.T)(),o=(0,j.Z)(),s=(0,n.useMemo)((()=>{let t=e.sort,o="asc";return e.sort.startsWith("-")&&(t=e.sort.substring(1),o="desc"),T.has(t)||(t="sum"),{key:t,order:o}}),[e.sort]),r=(0,n.useMemo)((()=>{const t=e.project;return t?e.functions.map((s=>{const{worst:n,examples:r,...a}=s,i=r.filter((e=>e!==n));return i.unshift(n),{...a,examples:i.map((n=>{const r=n.replaceAll("-","");return{value:(0,v.XQ)(r),onClick:()=>(0,k.Gi)("profiling_views.go_to_flamegraph",{organization:o,source:`${e.analyticsPageSource}.suspect_functions_table`}),target:(0,C.TH)({orgSlug:o.slug,projectSlug:t.slug,profileId:r,query:{frameName:s.name,framePackage:s.package}})}}))}})):[]}),[o,e.project,e.functions,e.analyticsPageSource]),a=(0,n.useCallback)((e=>{if(!T.has(e))return()=>{};const o=s.key!==e?"desc":"desc"===s.order?"asc":"desc";return()=>({...t,query:{...t.query,functionsSort:`${"desc"===o?"-":""}${e}`}})}),[t,s]);return(0,h.tZ)(l.ZP,{isLoading:e.isLoading,error:e.error,data:r,columnOrder:A.map((e=>D[e])),columnSortBy:[],grid:{renderHeadCell:(0,w.w)({currentSort:s,rightAlignedColumns:P,sortableColumns:T,generateSortLink:a}),renderBodyCell:q},location:t})}S.displayName="FunctionsTable";const P=new Set(["p75","p95","p99","sum","count"]),T=P;function q(e,t,o,s){return(0,h.tZ)(z,{column:e,dataRow:t,rowIndex:o,columnIndex:s})}q.displayName="renderFunctionsTableCell";const F=(0,s.Z)("span",{target:"e13dbyps0"})("color:",(e=>e.theme.gray300),";");function z(e){let{column:t,dataRow:o}=e;const s=o[t.key];switch(t.key){case"count":return(0,h.tZ)(b.Hw,{children:(0,h.tZ)(c.Z,{value:s})});case"p75":case"p95":case"p99":case"sum":return(0,h.tZ)(b.Hw,{children:(0,h.tZ)(u.Z,{nanoseconds:s,abbreviation:!0})});case"examples":return(0,h.tZ)(y,{items:s});case"name":case"package":const e=s||(0,h.tZ)(F,{children:(0,d.t)("Unknown")});return(0,h.tZ)(b.W2,{children:e});default:return(0,h.tZ)(b.W2,{children:s})}}const A=["name","package","count","p75","sum","examples"],D={name:{key:"name",name:(0,d.t)("Name"),width:l.z7},package:{key:"package",name:(0,d.t)("Package"),width:l.z7},p75:{key:"p75",name:(0,d.t)("P75 Self Time"),width:l.z7},p95:{key:"p95",name:(0,d.t)("P95 Self Time"),width:l.z7},p99:{key:"p99",name:(0,d.t)("P99 Self Time"),width:l.z7},sum:{key:"sum",name:(0,d.t)("Total Self Time"),width:l.z7},count:{key:"count",name:(0,d.t)("Occurrences"),width:l.z7},examples:{key:"examples",name:(0,d.t)("Example Profiles"),width:l.z7}};var L=o("./app/utils/profiling/hooks/useFunctions.tsx"),R=o("./app/utils/queryString.tsx"),I=o("./app/utils/usePageFilters.tsx");const N="functionsCursor";function E(e){let{analyticsPageSource:t,project:o,transaction:s}=e;const{selection:i}=(0,I.Z)(),[c,l]=(0,n.useState)("application"),u=(0,_.T)(),p=(0,n.useMemo)((()=>(0,R.ro)(u.query.functionsCursor)),[u.query.functionsCursor]),m=(0,n.useMemo)((()=>(0,R.ro)(u.query.functionsSort,"-sum")),[u.query.functionsSort]),y=(0,n.useCallback)(((e,t,o)=>{r.browserHistory.push({pathname:t,query:{...o,[N]:e}})}),[]),g=(0,L.d)({cursor:p,project:o,query:"",selection:i,transaction:s,sort:m,functionType:c});return(0,h.BX)(n.Fragment,{children:[(0,h.BX)(M,{children:[(0,h.tZ)(a.Z,{triggerProps:{prefix:(0,d.t)("Suspect Functions"),size:"xs"},value:c,options:[{label:(0,d.t)("All"),value:"all"},{label:(0,d.t)("Application"),value:"application"},{label:(0,d.t)("System"),value:"system"}],onChange:e=>{let{value:t}=e;return l(t)}}),(0,h.tZ)(B,{pageLinks:g.isFetched?g.data?.[2]?.getResponseHeader("Link")??null:null,onCursor:y,size:"xs"})]}),(0,h.tZ)(S,{analyticsPageSource:t,error:g.isError?g.error.message:null,isLoading:g.isLoading,functions:g.isFetched?g.data?.[0].functions??[]:[],project:o,sort:m})]})}E.displayName="SuspectFunctionsTable";const M=(0,s.Z)("div",{target:"e1qpwo4s1"})("display:flex;justify-content:space-between;margin-bottom:",(0,m.D)(1),";"),B=(0,s.Z)(i.Z,{target:"e1qpwo4s0"})("margin:0 0 0 ",(0,m.D)(1),";")},"./app/utils/profiling/hooks/useFunctions.tsx":(e,t,o)=>{o.d(t,{d:()=>l}),o("../node_modules/core-js/modules/es.error.cause.js");var s=o("../node_modules/@tanstack/react-query/build/lib/useQuery.mjs"),n=o("./app/components/organizations/pageFilters/parse.tsx"),r=o("./app/utils.tsx"),a=o("./app/utils/tokenizeSearch.tsx"),i=o("./app/utils/useApi.tsx"),c=o("./app/utils/useOrganization.tsx");function l(e){let{functionType:t,project:o,query:l,transaction:u,sort:p,cursor:d,selection:m,enabled:h=!0}=e;const y=(0,i.Z)(),g=`/projects/${(0,c.Z)().slug}/${o?.slug}/profiling/functions/`,f={functionType:t,query:l,selection:m,sort:p,transaction:u,cursor:d,enabled:h},x=[g,f];return(0,s.a)({queryKey:x,queryFn:()=>{if(!(0,r.ri)(f.selection)||!(0,r.ri)(f.transaction)||!(0,r.ri)(o))throw Error("selection, transaction and project arguments required for fetchFunctions");return function(e,t,o){let{cursor:s,functionType:r,query:i,selection:c,sort:l,transaction:u}=o;const p=new a.MY(i);return p.setFilterValues("transaction_name",[u]),e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{cursor:s,environment:c.environments,...(0,n.fK)(c.datetime),query:p.formatString(),sort:l,is_application:"application"===r?"1":"system"===r?"0":void 0}})}(y,g,f)},refetchOnWindowFocus:!1,retry:!1,enabled:h})}},"./app/utils/profiling/tableRenderer.tsx":(e,t,o)=>{o.d(t,{w:()=>r});var s=o("./app/components/gridEditable/sortLink.tsx"),n=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e){let{currentSort:t,generateSortLink:o,rightAlignedColumns:r,sortableColumns:a,onClick:i}=e;return function(e,c){return(0,n.tZ)(s.Z,{onClick:t=>i?.(e,t),align:r?.has(e.key)?"right":"left",title:e.name,direction:t?.key===e.key?t?.order:void 0,canSort:a?.has(e.key)||!1,generateSortLink:o?.(e.key)??(()=>{}),replace:!0})}}}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_areaChart_tsx-app_components_charts_chartZoom_tsx-app_components_profil-76d9b3.a916a97ecd5d348711e32c45740b12cc.js.map