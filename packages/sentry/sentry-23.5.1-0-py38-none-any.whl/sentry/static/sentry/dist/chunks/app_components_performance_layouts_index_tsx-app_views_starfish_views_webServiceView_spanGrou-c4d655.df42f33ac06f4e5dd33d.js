"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_performance_layouts_index_tsx-app_views_starfish_views_webServiceView_spanGrou-c4d655"],{"./app/components/performance/layouts/index.tsx":(e,t,a)=>{a.d(t,{c:()=>s});var i=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=a("./app/styles/space.tsx");const s=(0,i.Z)("div",{target:"ez22r7r0"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,o.D)(2),";grid-row-gap:",(0,o.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(e=>e.theme.breakpoints.medium),"){",(e=>e.columns?`\n    grid-template-columns: repeat(${e.columns}, 1fr);\n    `:`\n    grid-template-columns: repeat(auto-fit, minmax(${e.minSize}px, 1fr));\n    `),";}")},"./app/views/discover/table/topResultsIndicator.tsx":(e,t,a)=>{a.d(t,{C:()=>i});const i=(0,a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"ex85xd30"})("position:absolute;left:-1px;margin-top:4.5px;width:9px;height:15px;border-radius:0 3px 3px 0;background-color:",(e=>e.theme.charts.getColorPalette(e.count-2)[e.index]),";")},"./app/views/starfish/views/webServiceView/spanGroupBreakdownContainer.tsx":(e,t,a)=>{a.d(t,{_:()=>E});var i=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(a("../node_modules/core-js/modules/es.array.push.js"),a("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js")),s=a("../node_modules/moment/moment.js"),n=a.n(s),r=a("./app/components/panels/index.tsx"),d=a("./app/components/placeholder.tsx"),p=a("./app/styles/space.tsx"),l=a("./app/utils/queryClient.tsx"),m=a("./app/utils/usePageFilters.tsx"),c=a("./app/views/starfish/components/breakdownBar.tsx"),u=a("./app/views/starfish/utils/dates.tsx"),h=a("./app/views/starfish/utils/zeroFillSeries.tsx"),g=a("./app/views/starfish/views/webServiceView/queries.js"),x=a("../node_modules/react/index.js"),v=a("../node_modules/react-router/es/index.js"),f=a("../node_modules/query-string/index.js"),y=a("./app/components/checkbox.tsx"),b=a("./app/components/duration.tsx"),w=a("./app/components/textOverflow.tsx"),_=a("./app/components/tooltip.tsx"),Z=a("./app/locale.tsx"),$=a("./app/utils/dates.tsx"),q=a("./app/utils/discover/styles.tsx"),D=a("./app/utils/formatters.tsx"),S=a("./app/views/discover/table/topResultsIndicator.tsx"),j=a("./app/views/performance/landing/widgets/components/selectableList.tsx"),T=a("./app/views/starfish/components/chart.tsx"),k=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function C(e){let{tableData:t,totalCumulativeTime:a,topSeriesData:i,initialShowSeries:o}=e;const{selection:s}=(0,m.Z)(),[n,r]=(0,x.useState)(o);(0,x.useEffect)((()=>{r(o)}),[o]);const d=[];for(let e=0;e<i.length;e++){const t=i[e];n[e]&&d.push(t)}return(0,k.BX)(x.Fragment,{children:[(0,k.BX)(G,{children:[(0,k.tZ)(L,{children:(0,k.tZ)(O,{children:"p50 of Span Groups With Highest Cumulative Times"})}),(0,k.tZ)(T.Z,{statsPeriod:"24h",height:175,data:d,start:"",end:"",loading:!1,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:6,stacked:!0,aggregateOutputFormat:"duration"})]}),(0,k.tZ)(B,{children:t.map(((e,i)=>{const o=n[i],d=e.group,{start:p,end:l,utc:m,period:u}=s.datetime,h=p&&l?{start:(0,$.v5)(p),end:(0,$.v5)(l),utc:m}:{statsPeriod:u};["span_operation","action","domain"].forEach((e=>{void 0!==d[e]&&null!==d[e]&&(h[e]=d[e])}));const g="other"===d.module?"/starfish/spans/":`/starfish/spans/?${f.stringify(h)}`;return(0,k.tZ)(N,{children:(0,k.BX)(P,{children:[(0,k.tZ)(M,{count:Math.max(t.length-1,1),index:i}),(0,k.tZ)(y.Z,{size:"sm",checked:o,onChange:()=>{const e=[...n];e[i]=!o,r(e)}}),(0,k.tZ)(F,{children:(0,k.tZ)(v.Link,{to:g,children:(0,k.tZ)(w.Z,{children:(0,c.An)(d.span_operation,d.action,d.domain)})})}),(0,k.tZ)(j.S$,{children:(0,k.tZ)(_.u,{title:(0,Z.t)("This group of spans account for %s of the cumulative time on your web service",(0,D.rl)(e.cumulativeTime/a,1)),containerDisplayMode:"block",position:"top",children:(0,k.tZ)(q.Hw,{children:(0,Z._N)("[cumulativeTime] ([cumulativeTimePercentage])",{cumulativeTime:(0,k.tZ)(b.Z,{seconds:e.cumulativeTime/1e3,fixedDigits:1,abbreviation:!0}),cumulativeTimePercentage:(0,D.rl)(e.cumulativeTime/a,1)})})})})]})},`${d.span_operation}-${d.action}-${d.domain}`)}))})]})}C.displayName="SpanGroupBreakdown";const N=(0,i.Z)("li",{target:"e1sx7q3i7"})("line-height:",(e=>e.theme.text.lineHeightBody),";"),P=(0,i.Z)("div",{target:"e1sx7q3i6"})("display:flex;border-top:1px solid ",(e=>e.theme.border),";padding:",(0,p.D)(1)," ",(0,p.D)(2),";font-size:",(e=>e.theme.fontSizeMedium),";"),B=(0,i.Z)("ul",{target:"e1sx7q3i5"})("padding:",(0,p.D)(1)," 0 0 0;margin:0;list-style-type:none;"),F=(0,i.Z)("span",{target:"e1sx7q3i4"})("text-align:left;width:100%;padding:0 ",(0,p.D)(1.5),";"),G=(0,i.Z)("div",{target:"e1sx7q3i3"})("padding:0 ",(0,p.D)(2),";"),O=(0,i.Z)("p",{target:"e1sx7q3i2"})((e=>e.theme.text.cardTitle),";"),L=(0,i.Z)("div",{target:"e1sx7q3i1"})("padding:0 ",(0,p.D)(1)," 0 0;min-height:36px;width:100%;display:flex;align-items:center;justify-content:space-between;"),M=(0,i.Z)(S.C,{target:"e1sx7q3i0"})({name:"db9nhh",styles:"margin-top:0px"}),z="http://localhost:8080",A="other";function E(e){let{transaction:t}=e;const a=t??"",i=(0,m.Z)(),{selection:s}=i,p=(0,o.u)(),{data:x,isLoading:v}=(0,l.aM)({queryKey:["webServiceSpanGrouping",a,s.datetime],queryFn:()=>fetch(`${z}/?query=${(0,g.u4)({transaction:a,datetime:s.datetime})}`).then((e=>e.json())),retry:!1,initialData:[]}),{data:f}=(0,l.aM)({queryKey:["totalCumulativeTime",a,s.datetime],queryFn:()=>fetch(`${z}/?query=${(0,g.hj)({transaction:a,datetime:s.datetime})}`).then((e=>e.json())),retry:!1,initialData:[]}),y=f.reduce(((e,t)=>e+t.sum),0),b=y-x.reduce(((e,t)=>e+t.sum),0),w=[];for(let e=0;e<x.length;e++){const t=x[e];w.push({cumulativeTime:t.sum,group:{action:t.action,domain:t.domain,module:t.module,span_operation:t.span_operation,transaction:t.transaction}})}w.push({cumulativeTime:b,group:{action:"",domain:"",module:A,span_operation:"Other",transaction:""}});let _=x.length>0?` (span_operation = '${x[0].span_operation}' ${x[0].action?`AND action = '${x[0].action}'`:""} ${x[0].domain?`AND domain = '${x[0].domain}'`:""})`:"";for(let e=1;e<x.length;e++){const t=x[e];_=_.concat(" OR ",`(span_operation = '${t.span_operation}' ${t.action?`AND action = '${t.action}'`:""} ${t.domain?`AND domain = '${t.domain}'`:""})`)}const{isLoading:Z,data:$}=(0,l.aM)({queryKey:["topSpanGroupTimeseries",a,_,s.datetime],queryFn:()=>fetch(`${z}/?query=${(0,g.Lb)({transaction:a,topConditions:_,datetime:s.datetime})}`).then((e=>e.json())),retry:!1,initialData:[]}),{isLoading:q,data:D}=(0,l.aM)({queryKey:["otherSpanGroupTimeseries",a,_,s.datetime],queryFn:()=>fetch(`${z}/?query=${(0,g.Sy)({transaction:a,topConditions:_,datetime:s.datetime})}`).then((e=>e.json())),retry:!1,initialData:[]}),S={},[j,T,N]=i.selection.datetime.period?.match(u.Pr)??[],P=T&&N?n()().subtract(T,N):n()(i.selection.datetime.start),B=n()(i.selection.datetime.end??void 0),F=p.charts.getColorPalette(w.length-3);!Z&&!q&&x.length>0&&(x.forEach(((e,t)=>{const a=(0,c.c_)(e.span_operation,e.action,e.domain);S[a]={seriesName:`${a}`,data:[],color:F[t]}})),$.forEach((e=>{S[(0,c.c_)(e.span_operation,e.action,e.domain)].data.push({value:e.p75,name:e.interval})})),S.Other={seriesName:"Other",data:[],color:p.gray100},D.forEach((e=>{S.Other.data.push({value:e.p75,name:e.interval})})));const G=Object.values(S).map((e=>(0,h.b)(e,n().duration(12,"hour"),P,B))),O=w.map((e=>e.group.module!==A));return Z||v?(0,k.tZ)(r.s_,{children:(0,k.tZ)(d.Z,{height:"600px"})}):(0,k.tZ)(K,{children:(0,k.tZ)(C,{tableData:w,totalCumulativeTime:y,isTableLoading:v,topSeriesData:G,colorPalette:F,initialShowSeries:O})})}E.displayName="SpanGroupBreakdownContainer";const K=(0,i.Z)(r.s_,{target:"eoo99dh0"})("padding-top:",(0,p.D)(2),";margin-bottom:0;")}}]);
//# sourceMappingURL=../sourcemaps/app_components_performance_layouts_index_tsx-app_views_starfish_views_webServiceView_spanGrou-c4d655.02f6ebf9dbd96212785a9402cfafaaf0.js.map