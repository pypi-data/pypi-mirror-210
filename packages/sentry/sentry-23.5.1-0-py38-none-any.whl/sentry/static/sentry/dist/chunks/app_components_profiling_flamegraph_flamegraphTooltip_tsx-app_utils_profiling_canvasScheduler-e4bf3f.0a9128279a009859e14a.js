"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_profiling_flamegraph_flamegraphTooltip_tsx-app_utils_profiling_canvasScheduler-e4bf3f"],{"./app/components/profiling/boundTooltip.tsx":(e,t,i)=>{i.d(t,{W:()=>c});var r=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=i("../node_modules/react/index.js"),o=i("../node_modules/gl-matrix/esm/vec2.js"),s=i("./app/styles/space.tsx"),a=i("./app/utils/profiling/flamegraph/useFlamegraphTheme.ts"),h=i("./app/utils/theme.tsx"),l=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{bounds:t,canvas:i,cursor:r,canvasView:s,children:c}=e;const d=(0,a.W)(),p=o.kK(o.Ue(),r,s.fromTransformedConfigView(i.physicalSpace)),u=o.kK(o.Ue(),p,i.physicalToLogicalSpace),m=(0,n.useRef)(),g=(0,n.useCallback)((e=>{null!==e&&(m.current&&(window.cancelAnimationFrame(m.current),m.current=void 0),m.current=window.requestAnimationFrame((()=>{e.style.transform=function(e,t,i){let r=e[0]+6;const n=e[1]+6;return e[0]>t.width/2&&(r=e[0]-i.width),`translate(${r||0}px, ${n||0}px)`}(u,t,e.getBoundingClientRect())})))}),[t,u]);return(0,l.tZ)(f,{ref:g,style:{willChange:"transform",fontSize:d.SIZES.TOOLTIP_FONT_SIZE,fontFamily:d.FONTS.FONT,zIndex:h.ZP.zIndex.tooltip,maxWidth:t.width},children:c})}c.displayName="BoundTooltip";const f=(0,r.Z)("div",{target:"e4oovag0"})("background:",(e=>e.theme.background),";position:absolute;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;pointer-events:none;user-select:none;border-radius:",(e=>e.theme.borderRadius),";padding:",(0,s.D)(.25)," ",(0,s.D)(1),";border:1px solid ",(e=>e.theme.border),";font-size:",(e=>e.theme.fontSizeSmall),";line-height:24px;")},"./app/components/profiling/flamegraph/flamegraphTooltip.tsx":(e,t,i)=>{i.d(t,{BX:()=>u,Ob:()=>_,hX:()=>g,j_:()=>w});var r=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=i("../node_modules/react/index.js"),o=i("./app/components/profiling/boundTooltip.tsx"),s=i("./app/icons/index.tsx"),a=i("./app/locale.tsx"),h=i("./app/styles/space.tsx"),l=i("./app/utils.tsx"),c=i("./app/utils/profiling/gl/utils.ts"),f=i("./app/utils/profiling/speedscope.tsx"),d=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){return e.frame.file?"number"==typeof e.frame.line&&"number"==typeof e.frame.column?`${e.frame.file}:${e.frame.line}:${e.frame.column}`:"number"==typeof e.frame.line?`${e.frame.file}:${e.frame.line}`:`${e.frame.file}:<unknown line>`:"<unknown file>"}function u(e){const t=(0,n.useMemo)((()=>new f.UL(e.frame.start,e.frame.end,e.frame.end-e.frame.start,1).transformRect(e.flamegraphView.configSpaceTransform)),[e.flamegraphView,e.frame]),i="count"===e.flamegraphRenderer.flamegraph.profile.unit;return(0,d.BX)(o.W,{bounds:e.canvasBounds,cursor:e.configSpaceCursor,canvas:e.flamegraphCanvas,canvasView:e.flamegraphView,children:[(0,d.BX)(w,{children:[(0,d.tZ)(_,{backgroundColor:(0,c.xO)(e.frame,e.flamegraphRenderer)}),e.flamegraphRenderer.flamegraph.formatter(e.frame.node.totalWeight)," ",i&&(0,a.t)("samples")+" ",(r=e.frame.node,h=e.flamegraphRenderer.flamegraph,`(${Math.round(r.totalWeight/h.profile.duration*100)}%)`)," ",e.frame.frame.name]}),(0,d.BX)(g,{children:[(0,l.ri)(e.frame.frame.file)&&(0,d.BX)(n.Fragment,{children:[(0,a.t)("source"),":",p(e.frame)]}),(0,d.tZ)(g,{children:e.frame.frame.is_application?(0,a.t)("application frame"):(0,a.t)("system frame")})]}),!i&&(0,d.BX)(g,{children:[e.flamegraphRenderer.flamegraph.timelineFormatter(t.left)," "," â€” ",e.flamegraphRenderer.flamegraph.timelineFormatter(t.right),e.frame.frame.inline?(0,d.BX)(m,{children:[(0,d.tZ)(s.Db,{width:10}),(0,a.t)("inline frame")]}):""]})]});var r,h}u.displayName="FlamegraphTooltip";const m=(0,r.Z)("span",{target:"eaf5ke83"})("border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeExtraSmall),";padding:",(0,h.D)(.25)," ",(0,h.D)(.25),";line-height:12px;margin:0 ",(0,h.D)(.5),";align-self:flex-end;svg{width:10px;height:10px;transform:translateY(1px);}"),g=(0,r.Z)("div",{target:"eaf5ke82"})("color:",(e=>e.theme.subText),";"),w=(0,r.Z)("div",{target:"eaf5ke81"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),_=(0,r.Z)("div",{target:"eaf5ke80"})("width:12px;height:12px;min-width:12px;min-height:12px;border-radius:2px;display:inline-block;background-image:",(e=>e.backgroundImage),";background-size:16px 16px;background-color:",(e=>e.backgroundColor),";margin-right:",(0,h.D)(1),";")},"./app/utils/profiling/canvasScheduler.tsx":(e,t,i)=>{i.d(t,{IZ:()=>a,o$:()=>s});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=i("../node_modules/react/index.js");class o{constructor(){(0,r.Z)(this,"beforeFrameCallbacks",new Set),(0,r.Z)(this,"afterFrameCallbacks",new Set),(0,r.Z)(this,"onDisposeCallbacks",new Set),(0,r.Z)(this,"requestAnimationFrame",null),(0,r.Z)(this,"events",{"show in table view":new Set,"reset zoom":new Set,"highlight frame":new Set,"highlight span":new Set,"highlight ui frame":new Set,"set config view":new Set,"transform config view":new Set,"zoom at frame":new Set,"zoom at span":new Set})}onDispose(e){this.onDisposeCallbacks.has(e)||this.onDisposeCallbacks.add(e)}on(e,t){const i=this.events[e];i.has(t)||i.add(t)}off(e,t){const i=this.events[e];i.has(t)&&i.delete(t)}dispatch(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];for(const t of this.events[e])t(...i)}registerCallback(e,t){t.has(e)||t.add(e)}unregisterCallback(e,t){t.has(e)&&t.delete(e)}registerBeforeFrameCallback(e){this.registerCallback(e,this.beforeFrameCallbacks)}unregisterBeforeFrameCallback(e){this.unregisterCallback(e,this.beforeFrameCallbacks)}registerAfterFrameCallback(e){this.registerCallback(e,this.afterFrameCallbacks)}unregisterAfterFrameCallback(e){this.unregisterCallback(e,this.afterFrameCallbacks)}dispose(){for(const e of this.onDisposeCallbacks)this.onDisposeCallbacks.delete(e),e();for(const e in this.events)this.events[e].clear()}drawSync(){for(const e of this.beforeFrameCallbacks)e();for(const e of this.afterFrameCallbacks)e()}draw(){this.requestAnimationFrame&&window.cancelAnimationFrame(this.requestAnimationFrame),this.requestAnimationFrame=window.requestAnimationFrame((()=>{for(const e of this.beforeFrameCallbacks)e();for(const e of this.afterFrameCallbacks)e();this.requestAnimationFrame=null}))}}class s{constructor(){(0,r.Z)(this,"schedulers",new Set)}registerScheduler(e){this.schedulers.has(e)||this.schedulers.add(e)}dispatch(e,t){for(const i of this.schedulers)i.dispatch(e,...t)}unregisterScheduler(e){this.schedulers.has(e)&&(e.dispose(),this.schedulers.delete(e))}drawSync(){for(const e of this.schedulers)e.drawSync()}draw(){for(const e of this.schedulers)e.draw()}}function a(e){const t=(0,n.useMemo)((()=>new o),[]);return(0,n.useEffect)((()=>(e.registerScheduler(t),()=>e.unregisterScheduler(t))),[e,t]),t}},"./app/utils/profiling/canvasView.tsx":(e,t,i)=>{i.d(t,{i:()=>h});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(i("../node_modules/core-js/modules/es.error.cause.js"),i("../node_modules/gl-matrix/esm/mat3.js")),o=i("../node_modules/gl-matrix/esm/vec2.js"),s=i("./app/utils/profiling/gl/utils.ts"),a=i("./app/utils/profiling/speedscope.tsx");class h{constructor(e){let{canvas:t,options:i,model:o,mode:s}=e;(0,r.Z)(this,"configView",a.UL.Empty()),(0,r.Z)(this,"configSpace",a.UL.Empty()),(0,r.Z)(this,"configSpaceTransform",n.Ue()),(0,r.Z)(this,"inverted",void 0),(0,r.Z)(this,"minWidth",void 0),(0,r.Z)(this,"depthOffset",void 0),(0,r.Z)(this,"barHeight",void 0),(0,r.Z)(this,"model",void 0),(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"mode","anchorTop"),this.mode=s||this.mode,this.inverted=!!i.inverted,this.minWidth=i.minWidth??0,this.model=o,this.canvas=t,this.depthOffset=i.depthOffset??0,this.barHeight=i.barHeight?i.barHeight*window.devicePixelRatio:0,this.configSpaceTransform=i.configSpaceTransform?n.al(i.configSpaceTransform.width||1,0,0,0,i.configSpaceTransform.height||1,0,i.configSpaceTransform.x||0,i.configSpaceTransform.y||0,1):n.Ue(),this.initConfigSpace(t)}setMinWidth(e){if(e<0)throw new Error("View min width cannot be negative");this.minWidth=e}isViewAtTopEdgeOf(e){return this.inverted?e.bottom===this.configView.bottom:e.top===this.configView.top}isViewAtBottomEdgeOf(e){return this.inverted?e.top===this.configView.top:e.bottom===this.configView.bottom}_initConfigSpace(e){"stretchToFit"!==this.mode?this.configSpace=new a.UL(0,0,this.model.configSpace.width,Math.max(this.model.configSpace.height+this.depthOffset,e.physicalSpace.height/this.barHeight)):this.configSpace=new a.UL(0,0,this.model.configSpace.width,this.model.configSpace.height+this.depthOffset)}_initConfigView(e,t){switch(this.mode){case"stretchToFit":return void(this.configView=a.UL.From(t));case"anchorBottom":{const i=e.physicalSpace.height/this.barHeight,r=Math.max(0,Math.ceil(t.y-(i-t.height)));return void(this.configView=a.UL.From(t).withHeight(i).withY(r))}case"anchorTop":return void(this.configView=a.UL.From(t).withHeight(e.physicalSpace.height/this.barHeight));default:throw new Error(`Unknown CanvasView mode: ${this.mode}`)}}initConfigSpace(e){this._initConfigSpace(e),this._initConfigView(e,this.configSpace)}resizeConfigSpace(e){this._initConfigSpace(e),this._initConfigView(e,this.configView)}resetConfigView(e){this._initConfigView(e,this.configSpace)}setConfigView(e,t){this.configView=(0,s.rS)(e,{width:{min:this.minWidth,max:this.configSpace.width,...t?.width??{}},height:{min:0,max:this.configSpace.height,...t?.height??{}}})}transformConfigView(e){this.setConfigView(this.configView.transformRect(e))}toConfigSpace(e){const t=(0,s.Uv)(e,this.configSpace);return this.inverted&&n.Jp(t,this.configSpace.invertYTransform(),t),t}toConfigView(e){const t=(0,s.Uv)(e,this.configView);return this.inverted&&n.Jp(t,this.configView.invertYTransform(),t),t}fromConfigSpace(e){const t=(0,s.Uv)(this.configSpace,e);return this.inverted&&n.Jp(t,e.invertYTransform(),t),t}fromConfigView(e){const t=(0,s.Uv)(this.configView,e);return this.inverted&&n.Jp(t,e.invertYTransform(),t),t}fromTransformedConfigView(e){const t=n.Jp(n.Ue(),(0,s.Uv)(this.configView,e),this.configSpaceTransform);return this.inverted&&n.Jp(t,e.invertYTransform(),t),t}fromTransformedConfigSpace(e){const t=n.Jp(n.Ue(),(0,s.Uv)(this.configSpace,e),this.configSpaceTransform);return this.inverted&&n.Jp(t,e.invertYTransform(),t),t}getConfigSpaceCursor(e,t){const i=o.kK(o.Ue(),e,t.logicalToPhysicalSpace);return o.kK(o.Ue(),i,this.toConfigSpace(t.physicalSpace))}getTransformedConfigSpaceCursor(e,t){const i=o.kK(o.Ue(),e,t.logicalToPhysicalSpace),r=n.Jp(n.Ue(),n.U_(n.Ue(),this.configSpaceTransform),this.toConfigSpace(t.physicalSpace));return o.kK(o.Ue(),i,r)}getConfigViewCursor(e,t){const i=o.kK(o.Ue(),e,t.logicalToPhysicalSpace);return o.kK(o.Ue(),i,this.toConfigView(t.physicalSpace))}getTransformedConfigViewCursor(e,t){const i=o.kK(o.Ue(),e,t.logicalToPhysicalSpace),r=n.Jp(n.Ue(),n.U_(n.Ue(),this.configSpaceTransform),this.toConfigView(t.physicalSpace));return o.kK(o.Ue(),i,r)}toOriginConfigView(e){return e.transformRect(n.U_(n.Ue(),this.configSpaceTransform))}}},"./app/utils/profiling/colors/utils.tsx":(e,t,i)=>{function r(e,t){const i={};let r=0;for(let n=0;n<e.length;n++){const o=t(e[n]);!0!==o?!1!==o&&(i[o]||(i[o]=1,r++)):r++}return r}i.d(t,{Bx:()=>g,JN:()=>d,Jq:()=>f,Pe:()=>u,T1:()=>_,Zx:()=>p,eW:()=>w,sE:()=>n,tC:()=>S,tv:()=>m,uZ:()=>s,v6:()=>a}),i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/core-js/modules/es.error.cause.js");const n=e=>(t,i,r,n)=>{const o=i(t,r,n),s=t.length,a=new Array(4*s*6);for(let i=0;i<s;i++){const r=t[i];if(!r)continue;const n=o.get(r.key),s=n&&3===n.length?n.concat(1):n||e;for(let e=0;e<6;e++){const t=6*i*4+4*e;a[t]=s[0],a[t+1]=s[1],a[t+2]=s[2],a[t+3]=s[3]}}return{colorBuffer:a,colorMap:o}};function o(e){return"number"==typeof e&&!isNaN(e)}function s(e,t,i){if(!o(t)&&!o(i))throw new Error("Clamp requires at least a min or max parameter");if(o(t)&&o(i))return e<t?t:e>i?i:e;if(o(i))return e>i?i:e;if(o(t))return e<t?t:e;throw new Error("Unreachable case detected")}function a(e,t,i,r){return`rgba(${s(255*e,0,255)}, ${s(255*t,0,255)}, ${s(255*i,0,255)}, ${r})`}function h(e){return e.frame.package??e.frame.module??""}function l(e){return`${e.frame.name}:${e.frame.package}:${e.frame.module}`}function c(e,t){return l(e)>l(t)?1:-1}function f(e,t){const i=new Map,n=new Map,o=[...e].sort(c),s=r(o,(e=>l(e)));for(let e=0;e<o.length;e++){const r=o[e],a=l(r);if(!n.has(a)){const i=t(Math.floor(255*e/s)/256);n.set(a,i)}i.set(r.key,n.get(a))}return i}function d(e,t){const i=new Map,n=new Map,o=[...e].sort(c),s=r(o,(e=>!!e.node.recursive));for(let e=0;e<o.length;e++){if(!o[e].node.recursive)continue;const r=o[e],a=l(r);if(!n.has(a)){const i=t(Math.floor(255*e/s)/256);n.set(a,i)}i.set(r.key,n.get(a))}return i}function p(e,t){const i=new Map,n=new Map,o=[...e].sort(((e,t)=>h(e).localeCompare(h(t)))),s=r(o,(e=>h(e)));for(let e=0;e<o.length;e++){const r=o[e],a=h(r);if(!a)continue;const l=n.get(a)||t(Math.floor(255*e/s)/256);n.set(a,l),i.set(r.key,l)}return i}function u(e,t){const i=new Map,n=new Map,o=[...e].sort(((e,t)=>l(e).localeCompare(l(t)))),s=r(o,(e=>l(e)));for(let e=0;e<o.length;e++){if(o[e].frame.is_application)continue;const r=l(o[e]);if(!n.has(r)){const i=t(Math.floor(255*e/s)/256);n.set(r,i)}i.set(o[e].key,n.get(r))}return i}function m(e,t,i){const r=new Map,n=new Map,o=[...e].sort(((e,t)=>l(e).localeCompare(l(t))));for(let e=0;e<o.length;e++){const t=l(o[e]);o[e].frame.is_application?n.set(t,i.COLORS.FRAME_APPLICATION_COLOR):n.set(t,i.COLORS.FRAME_SYSTEM_COLOR),r.set(o[e].key,n.get(t))}return r}function g(e,t){const i=new Map,n=new Map,o=[...e].sort(((e,t)=>l(e).localeCompare(l(t)))),s=r(o,(e=>l(e)));for(let e=0;e<o.length;e++){if(!o[e].frame.is_application)continue;const r=l(o[e]);if(!n.has(r)){const i=t(Math.floor(255*e/s)/256);n.set(r,i)}i.set(o[e].key,n.get(r))}return i}function w(e,t){let i=0;const r=new Map,n=new Map;for(let t=0;t<e.length;t++){const n=l(e[t]);r.has(n)||r.set(n,0);const o=r.get(n);r.set(n,o+1),i=Math.max(i,o+1)}for(let o=0;o<e.length;o++){const s=e[o],a=l(s),h=r.get(a),[c,f,d]=t(.7),p=[c,f,d,Math.max(h/i,.1)];n.set(s.key,p)}return n}function _(e,t){const i=new Map,r=function(e,t){const i=t,r=new Set,n=[];for(let t=0;t<e.length;t++){const o=e[t],s=null==o?o:i(o);null==s||r.has(s)||(r.add(s),n.push(o))}return n}(e,(e=>e.node.span.op??""));for(let e=0;e<r.length;e++){const n=r[e].node.span.op??"";"missing span instrumentation"!==n&&i.set(n,t(e/r.length))}for(let t=0;t<e.length;t++)i.set(e[t].node.span.span_id,i.get(e[t].node.span.op??""));return i}function S(e){return`rgba(${Math.floor(255*e[0])}, ${Math.floor(255*e[1])}, ${Math.floor(255*e[2])}, ${e[3]??1})`}},"./app/utils/profiling/flamegraph.ts":(e,t,i)=>{i.d(t,{O:()=>u});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/core-js/modules/es.error.cause.js"),i("./app/components/events/interfaces/frame/utils.tsx")),o=i("./app/utils/profiling/profile/profile.tsx"),s=i("./app/utils/profiling/profile/sampledProfile.tsx"),a=i("./app/utils/profiling/units/units.ts"),h=i("./app/utils/profiling/callTreeNode.tsx"),l=i("./app/utils/profiling/frame.tsx"),c=i("./app/utils/profiling/speedscope.tsx");function f(e){return t=>{const i=[t];for(;i.length>0;){const t=i.pop();t.children.sort(e);for(let e=0;e<t.children.length;e++)i.push(t.children[e])}}}const d=f((function(e,t){return e.frame.name.localeCompare(t.frame.name)})),p=f((function(e,t){return t.totalWeight-e.totalWeight}));class u{static Empty(){return new u(o.N.Empty,0,{inverted:!1,sort:"call order"})}static Example(){return new u(s.J.Example,0,{inverted:!1,sort:"call order"})}static From(e,t){let{inverted:i=!1,sort:r="call order"}=t;return new u(e.profile,e.profileIndex,{inverted:i,sort:r})}constructor(e,t){let{inverted:i=!1,sort:n="call order",configSpace:o,filterFn:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};switch((0,r.Z)(this,"profile",void 0),(0,r.Z)(this,"frames",[]),(0,r.Z)(this,"profileIndex",void 0),(0,r.Z)(this,"inverted",!1),(0,r.Z)(this,"sort","call order"),(0,r.Z)(this,"depth",0),(0,r.Z)(this,"configSpace",c.UL.Empty()),(0,r.Z)(this,"root",{key:-1,parent:null,frame:new l.R({...l.R.Root}),node:new h.n(new l.R({...l.R.Root}),null),depth:-1,start:0,end:0,children:[]}),(0,r.Z)(this,"formatter",void 0),(0,r.Z)(this,"timelineFormatter",void 0),this.inverted=i,this.sort=n,this.profile=e,this.profileIndex=t,this.sort){case"left heavy":this.frames=this.buildSortedChart(e,p,s);break;case"alphabetical":if("flamechart"===this.profile.type)throw new TypeError("Flamechart does not support alphabetical sorting");this.frames=this.buildSortedChart(e,d,s);break;case"call order":if("flamegraph"===this.profile.type)throw new TypeError("Flamegraph does not support call order sorting");this.frames=this.buildCallOrderChart(e,s);break;default:throw new TypeError(`Unknown flamechart sort type: ${this.sort}`)}this.formatter=(0,a.s4)(e.unit),this.timelineFormatter=(0,a.ab)(e.unit),this.profile.duration>0?this.configSpace=new c.UL(0,0,o?o.width:this.profile.duration,this.depth):this.configSpace=new c.UL(0,0,"nanoseconds"===this.profile.unit?1e9:"microseconds"===this.profile.unit?1e6:"milliseconds"===this.profile.unit?1e3:1,this.depth);const f=this.root.children.reduce(((e,t)=>e+t.node.totalWeight),0);this.root.node.totalWeight+=f,this.root.end=this.root.start+f,this.root.frame.totalWeight+=f}buildCallOrderChart(e,t){const i=[],r=[];let n=0;return e.forEach(((e,t)=>{const i=r[r.length-1]??this.root,o={key:n,frame:e.frame,node:e,parent:i,children:[],depth:0,start:t,end:t};i?i.children.push(o):this.root.children.push(o),r.push(o),n++}),((e,t)=>{const n=r.pop();if(!n)throw new Error("Unbalanced stack");n.end=t,n.depth=r.length,n.end-n.start!=0&&(i.push(n),this.depth=Math.max(n.depth,this.depth))}),t),i}buildSortedChart(e,t,i){const r=[],n=[];t(e.callTree);const o={key:-1,frame:h.n.Root.frame,node:h.n.Root,parent:null,children:[],depth:0,start:0,end:0};this.root=o;let s=0;const a=(t,i)=>{const r=n[n.length-1]??this.root,o={key:s,frame:t.frame,node:t,parent:r,children:[],depth:0,start:i,end:i,profileIds:e.callTreeNodeProfileIdMap.get(t)};r?r.children.push(o):this.root.children.push(o),n.push(o),s++},l=(e,t)=>{const i=n.pop();if(!i)throw new Error("Unbalanced stack");i.end=t,i.depth=n.length,i.end-i.start!=0&&(r.push(i),this.depth=Math.max(i.depth,this.depth))};return function e(t,r){if(i&&!i(t)){let i=0;return void t.children.forEach((t=>{e(t,r+i),i+=t.totalWeight}))}t.frame.isRoot||a(t,r);let n=0;t.children.forEach((t=>{e(t,r+n),n+=t.totalWeight})),t.frame.isRoot||l(0,r+t.totalWeight)}(e.callTree,0),r}findAllMatchingFramesBy(e,t){const i=[];if(!t.length)throw new Error("No fields provided");if(1===t.length){for(let r=0;r<this.frames.length;r++)this.frames[r].frame[t[0]]===e&&i.push(this.frames[r]);return i}for(let r=0;r<this.frames.length;r++)for(let n=t.length;n--;)this.frames[r].frame[t[n]]===e&&i.push(this.frames[r]);return i}findAllMatchingFrames(e,t){t=m(t);const i=[];for(let r=0;r<this.frames.length;r++)this.frames[r].frame.name!==e||m(this.frames[r].frame.package)!==t&&this.frames[r].frame.module!==t||i.push(this.frames[r]);return i}}function m(e){return e?(0,n.Q6)(e):e}},"./app/utils/profiling/flamegraph/flamegraphTheme.tsx":(e,t,i)=>{i.d(t,{W0:()=>h,t8:()=>l});var r=i("./app/utils/profiling/colors/utils.tsx"),n=i("./app/utils/theme.tsx"),o=i("./app/utils/profiling/speedscope.tsx");const s={BAR_FONT_SIZE:11,BAR_HEIGHT:20,BAR_PADDING:4,FLAMEGRAPH_DEPTH_OFFSET:12,HOVERED_FRAME_BORDER_WIDTH:2,HIGHLIGHTED_FRAME_BORDER_WIDTH:3,GRID_LINE_WIDTH:2,INTERNAL_SAMPLE_TICK_LINE_WIDTH:1,LABEL_FONT_PADDING:6,LABEL_FONT_SIZE:10,MINIMAP_HEIGHT:100,MINIMAP_POSITION_OVERLAY_BORDER_WIDTH:2,SPANS_BAR_HEIGHT:20,SPANS_DEPTH_OFFSET:3,SPANS_FONT_SIZE:11,MAX_SPANS_HEIGHT:160,TIMELINE_HEIGHT:20,TOOLTIP_FONT_SIZE:12,UI_FRAMES_HEIGHT:60},a={FONT:"ui-monospace, Menlo, Monaco, 'Cascadia Mono', 'Segoe UI Mono', 'Roboto Mono',\n'Oxygen Mono', 'Ubuntu Monospace', 'Source Code Pro', 'Fira Mono', 'Droid Sans Mono',\n'Courier New', monospace",FRAME_FONT:n.Wb.text.familyMono},h={SIZES:s,COLORS:{BAR_LABEL_FONT_COLOR:"#000",COLOR_BUCKET:(0,o.NT)({C_0:.25,C_d:.2,L_0:.8,L_d:.15}),SPAN_COLOR_BUCKET:(0,o.NT)({C_0:.3,C_d:.25,L_0:.8,L_d:.15},140,220),COLOR_MAPS:{"by symbol name":r.Jq,"by system frame":r.Pe,"by application frame":r.Bx,"by library":r.Zx,"by recursion":r.JN,"by frequency":r.eW,"by system vs application frame":r.tv},CURSOR_CROSSHAIR:"#bbbbbb",DIFFERENTIAL_DECREASE:[.309,.2058,.98],DIFFERENTIAL_INCREASE:[.98,.2058,.4381],FOCUSED_FRAME_BORDER_COLOR:n.Wb.focus,FRAME_GRAYSCALE_COLOR:[.5,.5,.6,.1],FRAME_APPLICATION_COLOR:[.1,.1,.8,.2],FRAME_SYSTEM_COLOR:[.7,.1,.1,.2],SPAN_FALLBACK_COLOR:[0,0,0,.1],GRID_FRAME_BACKGROUND_COLOR:"rgb(250, 249, 251, 1)",GRID_LINE_COLOR:"#e5e7eb",HIGHLIGHTED_LABEL_COLOR:[240,240,0,1],HOVERED_FRAME_BORDER_COLOR:"rgba(0, 0, 0, 0.8)",LABEL_FONT_COLOR:"#1f233a",MINIMAP_POSITION_OVERLAY_BORDER_COLOR:"rgba(0,0,0, 0.2)",MINIMAP_POSITION_OVERLAY_COLOR:"rgba(0,0,0,0.1)",SAMPLE_TICK_COLOR:[255,0,0,.5],UI_FRAME_COLOR_SLOW:[.96,.69,0,.55],UI_FRAME_COLOR_FROZEN:[.96,.329,.349,.8],SEARCH_RESULT_FRAME_COLOR:"vec4(0.99, 0.70, 0.35, 1.0)",SEARCH_RESULT_SPAN_COLOR:"#fdb359",SELECTED_FRAME_BORDER_COLOR:n.Wb.blue400,SPAN_FRAME_LINE_PATTERN:"#dedae3",SPAN_FRAME_LINE_PATTERN_BACKGROUND:"#f4f2f7",SPAN_FRAME_BORDER:"rgba(200, 200, 200, 1)",STACK_TO_COLOR:(0,r.sE)([0,0,0,.035])},FONTS:a},l={SIZES:s,COLORS:{BAR_LABEL_FONT_COLOR:"rgb(255 255 255 / 80%)",COLOR_BUCKET:(0,o.NT)({C_0:.2,C_d:.1,L_0:.2,L_d:.1}),SPAN_COLOR_BUCKET:(0,o.NT)({C_0:.3,C_d:.15,L_0:.2,L_d:.1},140,220),COLOR_MAPS:{"by symbol name":r.Jq,"by system frame":r.Pe,"by application frame":r.Bx,"by library":r.Zx,"by recursion":r.JN,"by frequency":r.eW,"by system vs application frame":r.tv},CURSOR_CROSSHAIR:"#828285",DIFFERENTIAL_DECREASE:[.309,.2058,.98],DIFFERENTIAL_INCREASE:[.98,.2058,.4381],FOCUSED_FRAME_BORDER_COLOR:n.$_.focus,FRAME_GRAYSCALE_COLOR:[.5,.5,.5,.4],FRAME_APPLICATION_COLOR:[.1,.1,.8,.4],FRAME_SYSTEM_COLOR:[.7,.1,.1,.5],SPAN_FALLBACK_COLOR:[1,1,1,.3],GRID_FRAME_BACKGROUND_COLOR:"rgb(26, 20, 31,1)",GRID_LINE_COLOR:"#222227",HIGHLIGHTED_LABEL_COLOR:[136,50,0,1],HOVERED_FRAME_BORDER_COLOR:"rgba(255, 255, 255, 0.8)",LABEL_FONT_COLOR:"rgba(255, 255, 255, 0.8)",MINIMAP_POSITION_OVERLAY_BORDER_COLOR:"rgba(255,255,255, 0.35)",MINIMAP_POSITION_OVERLAY_COLOR:"rgba(255,255,255,0.1)",SAMPLE_TICK_COLOR:[255,0,0,.5],UI_FRAME_COLOR_SLOW:[.96,.69,0,.6],UI_FRAME_COLOR_FROZEN:[.96,.329,.349,.5],SEARCH_RESULT_FRAME_COLOR:"vec4(0.99, 0.70, 0.35, 0.7)",SPAN_FRAME_LINE_PATTERN:"#594b66",SPAN_FRAME_LINE_PATTERN_BACKGROUND:"#1a1724",SELECTED_FRAME_BORDER_COLOR:n.Wb.blue400,SEARCH_RESULT_SPAN_COLOR:"#b9834a",SPAN_FRAME_BORDER:"#57575b",STACK_TO_COLOR:(0,r.sE)([1,1,1,.1])},FONTS:a}},"./app/utils/profiling/flamegraph/flamegraphThemeProvider.tsx":(e,t,i)=>{i.d(t,{FW:()=>c,i0:()=>f,s6:()=>d});var r=i("../node_modules/react/index.js"),n=i("../node_modules/lodash/cloneDeep.js"),o=i.n(n),s=i("./app/stores/configStore.tsx"),a=i("./app/stores/useLegacyStore.tsx"),h=i("./app/utils/profiling/flamegraph/flamegraphTheme.tsx"),l=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=(0,r.createContext)(null),f=(0,r.createContext)(null);function d(e){const{theme:t}=(0,a.X)(s.Z),[i,n]=(0,r.useState)(null),d=(0,r.useCallback)((e=>{n((()=>e))}),[]),p=(0,r.useMemo)((()=>{const e="light"===t?h.W0:h.t8;if(!i)return e;const r=o()(e);return i(r,t)}),[i,t]);return(0,l.tZ)(f.Provider,{value:d,children:(0,l.tZ)(c.Provider,{value:p,children:e.children})})}d.displayName="FlamegraphThemeProvider"},"./app/utils/profiling/flamegraph/useFlamegraphTheme.ts":(e,t,i)=>{i.d(t,{P:()=>s,W:()=>o}),i("../node_modules/core-js/modules/es.error.cause.js");var r=i("../node_modules/react/index.js"),n=i("./app/utils/profiling/flamegraph/flamegraphThemeProvider.tsx");function o(){const e=(0,r.useContext)(n.FW);if(!e)throw new Error("useFlamegraphTheme was called outside of FlamegraphThemeProvider");return e}function s(){const e=(0,r.useContext)(n.i0);if(!e)throw new Error("useMutateFlamegraphTheme was called outside of FlamegraphThemeProvider");return e}},"./app/utils/profiling/flamegraphCanvas.tsx":(e,t,i)=>{i.d(t,{c:()=>a});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=i("../node_modules/gl-matrix/esm/mat3.js"),o=i("./app/utils/profiling/gl/utils.ts"),s=i("./app/utils/profiling/speedscope.tsx");class a{constructor(e,t){(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"origin",void 0),(0,r.Z)(this,"physicalSpace",s.UL.Empty()),(0,r.Z)(this,"logicalSpace",s.UL.Empty()),(0,r.Z)(this,"physicalToLogicalSpace",n.Ue()),(0,r.Z)(this,"logicalToPhysicalSpace",n.Ue()),this.canvas=e,this.origin=t,this.initPhysicalSpace()}initPhysicalSpace(){this.physicalSpace=new s.UL(this.origin[0],this.origin[1],this.canvas.width-this.origin[0],this.canvas.height-this.origin[1]),this.logicalSpace=this.physicalSpace.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),this.logicalToPhysicalSpace=(0,o.Uv)(this.logicalSpace,this.physicalSpace),this.physicalToLogicalSpace=(0,o.Uv)(this.physicalSpace,this.logicalSpace)}}},"./app/utils/profiling/flamegraphFrame.tsx":(e,t,i)=>{function r(e){return e.frame.name+(e.frame.file?e.frame.file:"")+String(e.start)}i.d(t,{M:()=>r})},"./app/utils/profiling/gl/utils.ts":(e,t,i)=>{i.d(t,{AN:()=>u,DB:()=>k,DL:()=>c,FW:()=>p,G:()=>x,HO:()=>l,IL:()=>f,Lo:()=>w,NR:()=>F,OI:()=>g,Oc:()=>b,SO:()=>A,Tw:()=>I,U_:()=>y,Uv:()=>_,X1:()=>C,XU:()=>B,Xi:()=>d,YG:()=>L,Zw:()=>U,dH:()=>E,e:()=>R,ef:()=>h,fw:()=>S,i7:()=>N,kv:()=>M,rS:()=>v,uJ:()=>P,v5:()=>T,xO:()=>O}),i("../node_modules/core-js/modules/es.error.cause.js");var r=i("../node_modules/react/index.js"),n=i("../node_modules/gl-matrix/esm/mat3.js"),o=i("../node_modules/gl-matrix/esm/vec2.js"),s=i("./app/utils/profiling/colors/utils.tsx"),a=i("./app/utils/profiling/speedscope.tsx");function h(e,t,i){const r=e.createShader(t);if(!r)throw new Error("Could not create shader");if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;throw e.deleteShader(r),new Error(`Failed to compile ${t} shader`)}function l(e,t,i){const r=e.createProgram();if(!r)throw new Error("Could not create program");if(e.attachShader(r,t),e.attachShader(r,i),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS))return r;throw e.deleteProgram(r),new Error("Failed to create program")}function c(e,t,i){const r=e.getUniformLocation(t,i);if(!r)throw new Error(`Could not locate uniform ${i} in shader`);return r}function f(e,t,i){const r=e.getAttribLocation(t,i);if(-1===r)throw new Error(`Could not locate attribute ${i} in shader`);return r}function d(e,t,i){const r=e.createBuffer();if(!r)throw new Error("Could not create buffer");return e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,t,i),r}function p(e,t,i){e.vertexAttribPointer(t,i.size,i.type,i.normalized,i.stride,i.offset),e.enableVertexAttribArray(t)}function u(e,t){const i=n.Ue();return n.Iu(i,i,o.al(-1,1)),n.bA(i,i,o.cs(o.Ue(),o.al(2,-2),o.al(e,t))),i}const m=new Map,g=(e,t)=>{for(const t of e)m.set(t,[t.width,t.height]);const i=new ResizeObserver(((e,i)=>{!function(e){for(const t of e){let e,i,r=window.devicePixelRatio;t.devicePixelContentBoxSize?(e=t.devicePixelContentBoxSize[0].inlineSize,i=t.devicePixelContentBoxSize[0].blockSize,r=1):t.contentBoxSize?t.contentBoxSize[0]?(e=t.contentBoxSize[0].inlineSize,i=t.contentBoxSize[0].blockSize):(e=t.contentBoxSize.inlineSize,i=t.contentBoxSize.blockSize):(e=t.contentRect.width,i=t.contentRect.height);const n=Math.round(e*r),o=Math.round(i*r);m.set(t.target,[n,o]),w(t.target)}}(e),t?.(e,i)}));try{e.forEach((e=>{i.observe(e,{box:"device-pixel-content-box"})}))}catch(t){e.forEach((e=>{i.observe(e,{box:"content-box"})}))}return i};function w(e){const t=m.get(e);if(!t){const t=e.clientWidth*window.devicePixelRatio,i=e.clientHeight*window.devicePixelRatio;return e.width=t,e.height=i,!1}const[i,r]=t,n=e.width!==i||e.height!==r;return n&&(e.width=i,e.height=r),n}function _(e,t){return n.al(t.width/e.width,0,0,0,t.height/e.height,0,t.x-e.x*(t.width/e.width),t.y-e.y*(t.height/e.height),1)}function S(e,t){const i="webgl"===t?e.getContext(t,{antialias:!1}):e.getContext(t);if(!i)throw new Error(`Could not get context ${t}`);return i}function C(e,t){if(!e)return a.UL.Empty();const i=(t||S(document.createElement("canvas"),"2d")).measureText(e);return new a.UL(0,0,i.width,i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}function x(e,t){let i=0,r=t.length;if(0===r)return 0;if(1===r)return t[0].start<e?1:0;for(;i!==r;){const n=i+Math.floor((r-i)/2);t[n].start<e?i=n+1:r=n}return i}function R(e,t){let i=0,r=t.length;if(0===r)return 0;if(1===r)return t[0].end<e?1:0;for(;i!==r;){const n=i+Math.floor((r-i)/2);t[n].end<e?i=n+1:r=n}return i}function b(e,t){const i=t.getColorForFrame(e);return Array.isArray(i)?4===i.length?`rgba(${i.slice(0,3).map((e=>255*e)).join(",")}, ${i[3]})`:`rgba(${i.map((e=>255*e)).join(",")}, 1.0)`:""}function O(e,t){const i=t.getColorForFrame(e);return 4===i.length?`rgba(${i.slice(0,3).map((e=>255*e)).join(",")}, ${i[3]})`:`rgba(${i.map((e=>255*e)).join(",")}, 1.0)`}const E="â€¦";function v(e,t){let{width:i,height:r}=t;if(!e.isValid())throw new Error(e.toString());const n=(0,s.uZ)(e.width,i.min,i.max),o=(0,s.uZ)(e.height,r.min,r.max),h=i.max-n,l=Math.max(r.max-o,0),c=(0,s.uZ)(e.x,0,h),f=(0,s.uZ)(e.y,0,l);return new a.UL(c,f,n,o)}function y(e,t){if(!t.length)return e;const i=e[0]>=t.start&&e[0]<=t.end,r=e[1]>=t.start&&e[1]<=t.end;if(i&&r)return[t.start,t.start+1];if(e[0]<t.start){if(e[1]<t.start)return[e[0],e[1]];if(r)return[e[0],t.start+1];if(e[1]>t.end)return[e[0],e[1]-t.length+1]}if(i&&e[1]>t.end)return[t.start,e[1]-t.length+1];if(e[0]>t.end)return[e[0]-t.length+1,e[1]-t.length+1];throw new Error(`Unhandled case: ${JSON.stringify(e)} ${t}`)}function A(e,t,i){if("exact"===e)return i.withHeight(t.height);if("min"===e){if(t.containsRect(i))return t;if(t.width<=i.width)return i.withHeight(t.height);let e=t.clone();return i.left<t.left?e=e.withX(i.x):i.right>t.right&&(e=t.withX(e.x+i.right-e.right)),i.bottom<t.top?e=e.withY(i.top):i.bottom>t.bottom&&(e=e.translateY(e.y+i.bottom-e.bottom)),e}return i.withHeight(t.height)}function T(e,t){if(!t.length)return e;if(1===t.length)return new a.UL(t[0].x,t[0].y,t[0].width,e.height);const i=t.reduce(((e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),right:Math.max(e.right,t.right),bottom:0})),{x:Number.MAX_SAFE_INTEGER,y:Number.MAX_SAFE_INTEGER,right:0,bottom:0});return A("exact",e,new a.UL(i.x,i.y,i.right-i.x,e.height))}function L(e,t){const i=o.al(e,t);return o.bA(o.Ue(),i,window.devicePixelRatio)}function M(e,t){const i=o.al(-t[0],-t[1]),r=n.Ue();return n.vc(r,t),n.bA(r,r,e),n.Iu(r,r,i),r}function F(e,t,i,r){const n=i.getConfigViewCursor(t,r),s=o.al(n[0],i.configView.y);return M(o.al(e,1),s)}function I(e,t){const i=o.al(e,t);return n.vc(n.Ue(),i)}function U(e,t,i,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.8,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;const h=o.al(e*s,t*a),l=n.U_(n.Ue(),i.fromConfigView(r.physicalSpace)),[c,f,d,p,u,m]=l,g=o.kK(o.Ue(),h,[c,f,d,p,u,m,0,0,0]);return I(g[0],g[1])}function N(e,t,i,r,s,a){const h=L(e,t),l=a?o.$X(o.Ue(),h,i):o.$X(o.Ue(),i,h);if(0===l[0]&&0===l[1])return null;const c=n.U_(n.Ue(),r.fromConfigView(s.physicalSpace)),[f,d,p,u,m,g]=c,w=o.kK(o.Ue(),l,[f,d,p,u,m,g,0,0,0]);return n.vc(n.Ue(),w)}function P(e,t,i,r,s,a){const h=L(e,t),l=a?o.$X(o.Ue(),h,i):o.$X(o.Ue(),i,h);if(0===l[0]&&0===l[1])return null;const c=n.U_(n.Ue(),r.fromConfigSpace(s.physicalSpace)),[f,d,p,u,m,g]=c,w=o.kK(o.Ue(),l,[f,d,p,u,m,g,0,0,0]);return n.vc(n.Ue(),w)}function B(e,t,i){return e&&t?Math.min(Math.abs(e.left-t[0]),Math.abs(e.right-t[0]))<=i?"ew-resize":e.contains(t)?"grab":"col-resize":"col-resize"}function k(e,t,i,n){const[o,s]=(0,r.useState)(a.UL.Empty());return(0,r.useLayoutEffect)((()=>{if(!i||!e.length)return;if(e.some((e=>null===e)))return;const r=g(e,(e=>{const r=e[0].contentRect??e[0].target.getBoundingClientRect();s(new a.UL(r.x,r.y,r.width,r.height)),i.initPhysicalSpace(),n&&n.resizeConfigSpace(i),t.drawSync()}));return()=>{r.disconnect()}}),[e,i,n,t]),o}},"./app/utils/profiling/renderers/flamegraphRenderer.tsx":(e,t,i)=>{i.d(t,{o:()=>o,r:()=>n});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js");i("../node_modules/core-js/modules/es.array.push.js");const n={colorCoding:"by symbol name",draw_border:!1};class o{constructor(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"flamegraph",void 0),(0,r.Z)(this,"theme",void 0),(0,r.Z)(this,"options",void 0),(0,r.Z)(this,"frames",void 0),(0,r.Z)(this,"roots",void 0),(0,r.Z)(this,"colorBuffer",void 0),(0,r.Z)(this,"colorMap",void 0),this.canvas=e,this.flamegraph=t,this.theme=i,this.options=o,this.frames=this.flamegraph.frames,this.roots=this.flamegraph.root.children;const{colorBuffer:s,colorMap:a}=this.theme.COLORS.STACK_TO_COLOR(this.frames,this.theme.COLORS.COLOR_MAPS[this.options.colorCoding],this.theme.COLORS.COLOR_BUCKET,this.theme);this.colorBuffer=s,this.colorMap=a}getColorForFrame(e){return this.colorMap.get(e.key)??this.theme.COLORS.FRAME_GRAYSCALE_COLOR}findHoveredNode(e){if(e[1]>this.flamegraph.configSpace.bottom+1)return null;if(e[0]<this.flamegraph.configSpace.left)return null;if(e[0]>this.flamegraph.configSpace.right)return null;let t=null;const i=[...this.roots];for(;i.length&&!t;){const r=i.pop();if(!(e[0]<r.start||e[0]>r.end)){if(e[1]>=r.depth&&e[1]<=r.depth+1){t=r;break}for(let e=0;e<r.children.length;e++)i.push(r.children[e])}}return t}}},"./app/utils/profiling/renderers/flamegraphTextRenderer.tsx":(e,t,i)=>{i.d(t,{G:()=>h});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(i("../node_modules/core-js/modules/es.array.push.js"),i("./app/utils/profiling/gl/utils.ts")),o=i("./app/utils/profiling/renderers/textRenderer.tsx"),s=i("./app/utils/profiling/flamegraphFrame.tsx"),a=i("./app/utils/profiling/speedscope.tsx");class h extends o.t{constructor(e,t,i){super(e,t),(0,r.Z)(this,"flamegraph",void 0),this.canvas=e,this.theme=t,this.flamegraph=i,this.textCache={},this.context=(0,n.fw)(e,"2d"),(0,n.Lo)(e)}draw(e,t,i){const r=this.theme.SIZES.BAR_FONT_SIZE*window.devicePixelRatio;this.context.font=`${r}px ${this.theme.FONTS.FRAME_FONT}`,this.context.textBaseline="alphabetic",this.maybeInvalidateCache();const o=this.measureAndCacheText(n.dH).width,h=2*this.theme.SIZES.BAR_PADDING*window.devicePixelRatio,l=h/2,c=(this.theme.SIZES.BAR_HEIGHT-this.theme.SIZES.BAR_FONT_SIZE/2)*window.devicePixelRatio,f=`rgb(${this.theme.COLORS.HIGHLIGHTED_LABEL_COLOR.join(", ")})`,d=e.top-1,p=e.bottom+1,u=i&&i.size>0,m=r/2-c,g=(0,n.e)(e.left,this.flamegraph.root.children),w=(0,n.G)(e.right,this.flamegraph.root.children),_=this.flamegraph.root.children.slice(g,w);for(;_.length>0;){const g=_.pop();if(g.depth>p)continue;const w=Math.max(g.start,e.left),S=Math.min(g.end,e.right),C=(S-w)*t[0]+t[3],x=C-h;if(x<=o)continue;const R=(0,n.G)(e.right,g.children);for(let t=(0,n.e)(e.left,g.children);t<R;t++)_.push(g.children[t]);if(g.depth<d)continue;const b=(S-w)*t[1]+t[4],O=w*t[0]+g.depth*t[3]+t[6],E=w*t[1]+g.depth*t[4]+t[7]+(b<0?b:0)+c,v=O+(C<0?C:0)+l,y=(0,a.B2)(g.frame.name,(0,a.fd)({low:0,high:x},(e=>this.measureAndCacheText(g.frame.name.substring(0,e)).width),x)[0]);if(u){const e=(0,s.M)(g),t=i.get(e);if(t){this.context.fillStyle=f;for(let e=0;e<t.match.length;e++){const i=(0,n.U_)(t.match[e],y),o=y.text.slice(0,i[0]),s=this.measureAndCacheText(y.text.substring(i[0],i[1])).width;this.context.fillRect(v+this.measureAndCacheText(o).width,E+m,s,r)}}}this.context.fillStyle=this.theme.COLORS.LABEL_FONT_COLOR,this.context.fillText(y.text,v,E)}}}},"./app/utils/profiling/renderers/textRenderer.tsx":(e,t,i)=>{i.d(t,{t:()=>s});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=i("./app/utils/profiling/gl/utils.ts");const o="Who knows if this changed, font-display: swap wont tell me";class s{constructor(e,t){(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"theme",void 0),(0,r.Z)(this,"context",void 0),(0,r.Z)(this,"textCache",void 0),this.canvas=e,this.theme=t,this.textCache={},this.context=(0,n.fw)(e,"2d"),(0,n.Lo)(e)}measureAndCacheText(e){return this.textCache[e]||(this.textCache[e]=this.context.measureText(e)),this.textCache[e]}maybeInvalidateCache(){if(void 0===this.textCache[o])return void this.measureAndCacheText(o);const e=this.context.measureText(o);e!==this.textCache[o]&&(this.textCache={[o]:e})}}},"./app/utils/profiling/speedscope.tsx":(e,t,i)=>{i.d(t,{B2:()=>d,NT:()=>f,NV:()=>p,UL:()=>h,fd:()=>l});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/gl-matrix/esm/vec2.js")),o=i("../node_modules/gl-matrix/esm/mat3.js"),s=i("./app/utils/profiling/colors/utils.tsx"),a=i("./app/utils/profiling/gl/utils.ts");class h{constructor(e,t,i,o){(0,r.Z)(this,"origin",void 0),(0,r.Z)(this,"size",void 0),this.origin=n.al(e,t),this.size=n.al(i,o)}clone(){return h.From(this)}isValid(){return this.toMatrix().every((e=>!isNaN(e)))}isEmpty(){return 0===this.width&&0===this.height}static Empty(){return new h(0,0,0,0)}static From(e){return new h(e.x,e.y,e.width,e.height)}get x(){return this.origin[0]}get y(){return this.origin[1]}get width(){return this.size[0]}get height(){return this.size[1]}get left(){return this.x}get right(){return this.left+this.width}get top(){return this.y}get bottom(){return this.top+this.height}get centerX(){return this.x+this.width/2}get centerY(){return this.y+this.height/2}get center(){return[this.centerX,this.centerY]}static decode(e){let t=e;if("string"==typeof e&&(t=e.split(",")),!Array.isArray(t))return null;if(4!==t.length)return null;const i=new h(...t.map((e=>parseFloat(e))));return i.isValid()?i:null}static encode(e){return e.toString()}toString(){return[this.x,this.y,this.width,this.height].map((e=>Math.round(e))).join(",")}toMatrix(){const{width:e,height:t,x:i,y:r}=this;return o.al(e,0,0,0,t,0,i,r,1)}hasIntersectionWith(e){const t=Math.max(this.top,e.top);if(Math.max(t,Math.min(this.bottom,e.bottom))-t==0)return!1;const i=Math.max(this.left,e.left);return Math.max(i,Math.min(this.right,e.right))-i!=0}containsX(e){return e[0]>=this.left&&e[0]<=this.right}containsY(e){return e[1]>=this.top&&e[1]<=this.bottom}contains(e){return this.containsX(e)&&this.containsY(e)}containsRect(e){return this.left<=e.left&&e.right<=this.right&&this.top<=e.top&&e.bottom<=this.bottom}leftOverlapsWith(e){return e.left<=this.left&&e.right>=this.left}rightOverlapsWith(e){return this.right>=e.left&&this.right<=e.right}overlapsX(e){return this.left<=e.right&&this.right>=e.left}overlapsY(e){return this.top<=e.bottom&&this.bottom>=e.top}overlaps(e){return this.overlapsX(e)&&this.overlapsY(e)}transformRect(e){if(!e)return this.clone();const t=this.x*e[0]+this.y*e[3]+e[6],i=this.x*e[1]+this.y*e[4]+e[7],r=this.width*e[0]+this.height*e[3],n=this.width*e[1]+this.height*e[4];return new h(t+(r<0?r:0),i+(n<0?n:0),Math.abs(r),Math.abs(n))}invertYTransform(){return o.al(1,0,0,0,-1,0,0,2*this.y+this.height,1)}withHeight(e){return new h(this.x,this.y,this.width,e)}withWidth(e){return new h(this.x,this.y,e,this.height)}withX(e){return new h(e,this.y,this.width,this.height)}withY(e){return new h(this.x,e,this.width,this.height)}toBounds(){return[this.x,this.y,this.x+this.width,this.y+this.height]}toArray(){return[this.x,this.y,this.width,this.height]}between(e){return new h(e.x,e.y,e.width/this.width,e.height/this.height)}translate(e,t){return new h(e,t,this.width,this.height)}translateX(e){return new h(e,this.y,this.width,this.height)}translateY(e){return new h(this.x,e,this.width,this.height)}scaleX(e){return new h(this.x,this.y,this.width*e,this.height)}scaleY(e){return new h(this.x,this.y,this.width,this.height*e)}scale(e,t){return new h(this.x*e,this.y*t,this.width*e,this.height*t)}scaleOriginBy(e,t){return new h(this.x*e,this.y*t,this.width,this.height)}scaledBy(e,t){return new h(this.x,this.y,this.width*e,this.height*t)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}notEqualTo(e){return!this.equals(e)}}function l(e,t,i){let{low:r,high:n}=e,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;for(;;){if(n-r<=o)return[r,n];const e=(n+r)/2;t(e)<i?r=e:n=e}}const c=e=>2*Math.abs((e=>e-Math.floor(e))(e)-.5)-1;function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:360,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r=>{const n=c(30*r),o=.9*r,a=t<360?i+t*o:t*o,h=e.C_0+e.C_d*n;return function(e,t,i){const r=i/60,n=t*(1-Math.abs(r%2-1)),[o,a,h]=r<1?[t,n,0]:r<2?[n,t,0]:r<3?[0,t,n]:r<4?[0,n,t]:r<5?[n,0,t]:[t,0,n],l=e-(.35*o+.35*a+.35*h);return[(0,s.uZ)(o+l,0,1),(0,s.uZ)(a+l,0,1),(0,s.uZ)(h+l,0,1)]}(e.L_0-e.L_d*n,h,a)}}function d(e,t){if(t>=e.length)return{text:e,start:0,end:0,length:0};const i=Math.floor(t/2),r=t-i-1,n=i,o=Math.floor(e.length-r+a.dH.length);return{text:`${e.substring(0,n)}${a.dH}${e.substring(o)}`,start:n,end:o,length:o-n}}function p(e,t,i){const r=i(t,200)-e.left;let n=Math.pow(10,Math.floor(Math.log10(r)));r/n>5?n*=5:r/n>2&&(n*=2);let o=Math.ceil(e.left/n)*n;const s=[];for(;o<=e.right;)s.push(o),o+=n;return s}}}]);
//# sourceMappingURL=../sourcemaps/app_components_profiling_flamegraph_flamegraphTooltip_tsx-app_utils_profiling_canvasScheduler-e4bf3f.7c45c71dabfd7a8413cab8cabdca1c93.js.map