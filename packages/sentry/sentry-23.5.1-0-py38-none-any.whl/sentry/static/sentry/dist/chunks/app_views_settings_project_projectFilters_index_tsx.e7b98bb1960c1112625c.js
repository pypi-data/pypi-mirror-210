"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_projectFilters_index_tsx"],{"./app/data/forms/inboundFilters.tsx":(e,t,s)=>{s.r(t),s.d(t,{customFilterFields:()=>h,default:()=>p,getOptionsData:()=>c,route:()=>o});var r=s("../node_modules/react/index.js"),i=s("./app/components/links/externalLink.tsx"),a=s("./app/locale.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o="/settings/:orgId/projects/:projectId/filters/",l=(0,a.t)("Separate multiple entries with a newline."),d=(0,a._N)("Allows [link:glob pattern matching].",{link:(0,n.tZ)(i.Z,{href:"https://en.wikipedia.org/wiki/Glob_(programming)"})}),c=e=>({options:e}),p=[{title:(0,a.t)("Custom Filters"),fields:[{name:"filters:blacklisted_ips",type:"string",multiline:!0,autosize:!0,rows:1,maxRows:10,placeholder:"e.g. 127.0.0.1 or 10.0.0.0/8",label:(0,a.t)("IP Addresses"),help:(0,n.BX)(r.Fragment,{children:[(0,a.t)("Filter events from these IP addresses. "),l]}),getData:c}]}],h=[{name:"filters:releases",type:"string",multiline:!0,autosize:!0,maxRows:10,rows:1,placeholder:"e.g. 1.* or [!3].[0-9].*",label:(0,a.t)("Releases"),help:(0,n.BX)(r.Fragment,{children:[(0,a.t)("Filter events from these releases. "),l," ",d]}),getData:c},{name:"filters:error_messages",type:"string",multiline:!0,autosize:!0,maxRows:10,rows:1,placeholder:"e.g. TypeError* or *: integer division or modulo by zero",label:(0,a.t)("Error Message"),help:(0,n.BX)(r.Fragment,{children:[(0,a.t)("Filter events by error messages. "),l," ",d]}),getData:c}]},"./app/views/settings/project/permissionAlert.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("./app/components/acl/access.tsx"),i=s("./app/components/alert.tsx"),a=s("./app/locale.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{access:t=["project:write"],project:s,team:o,...l}=e;return(0,n.tZ)(r.Z,{access:t,project:s,team:o,children:e=>{let{hasAccess:t}=e;return!t&&(0,n.tZ)(i.bZ,{"data-test-id":"project-permission-alert",type:"warning",...l,children:(0,a.t)("These settings can only be edited by users with the organization-level owner, manager, or team-level admin roles.")})}})}o.displayName="PermissionAlert";const l=o},"./app/views/settings/project/projectFilters/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>xe});var r=s("../node_modules/react/index.js"),i=s("./app/components/links/link.tsx"),a=s("./app/components/navTabs.tsx"),n=s("./app/components/sentryDocumentTitle.tsx"),o=s("./app/locale.tsx"),l=s("./app/utils/recreateRoute.tsx"),d=s("./app/views/settings/components/settingsPageHeader.tsx"),c=s("./app/views/settings/components/text/textBlock.tsx"),p=s("./app/views/settings/project/permissionAlert.tsx"),h=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),m=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),u=s("./app/actionCreators/indicator.tsx"),g=s("./app/components/acl/access.tsx"),b=s("./app/components/asyncComponent.tsx"),Z=s("./app/components/avatar/index.tsx"),f=s("./app/components/button.tsx"),x=s("./app/components/confirm.tsx"),y=s("./app/components/emptyMessage.tsx"),w=s("./app/components/eventOrGroupHeader.tsx"),j=s("./app/components/pagination.tsx"),v=s("./app/components/panels/index.tsx"),D=s("./app/icons/index.tsx"),F=s("./app/styles/space.tsx"),S=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function k(e){let{data:t,disabled:s,onUndiscard:r}=e;const i=t.actor;return(0,S.BX)(v.Lv,{center:!0,children:[(0,S.tZ)(T,{children:(0,S.tZ)(w.Z,{includeLink:!1,hideIcons:!0,className:"truncate",size:"normal",data:t,source:"group-tombstome"})}),(0,S.tZ)(_,{children:i&&(0,S.tZ)(Z.Z,{user:i,hasTooltip:!0,tooltip:(0,o.t)("Discarded by %s",i.name||i.email)})}),(0,S.tZ)(P,{children:(0,S.tZ)(x.Z,{message:(0,o.t)("Undiscarding this issue means that incoming events that match this will no longer be discarded. New incoming events will count toward your event quota and will display on your issues dashboard. Are you sure you wish to continue?"),onConfirm:()=>r(t.id),disabled:s,children:(0,S.tZ)(f.zx,{"aria-label":(0,o.t)("Undiscard"),title:s?(0,o.t)("You do not have permission to perform this action"):(0,o.t)("Undiscard"),size:"xs",icon:(0,S.tZ)(D.Fz,{size:"xs"}),disabled:s})})})]})}k.displayName="GroupTombstoneRow";class B extends b.Z{constructor(){super(...arguments),(0,h.Z)(this,"handleUndiscard",(e=>{const{organization:t,project:s}=this.props,r=`/projects/${t.slug}/${s.slug}/tombstones/${e}/`;this.api.requestPromise(r,{method:"DELETE"}).then((()=>{(0,u.S9)((0,o.t)("Events similar to these will no longer be filtered")),this.fetchData()})).catch((()=>{(0,u.Iw)((0,o.t)("We were unable to undiscard this issue")),this.fetchData()}))}))}getEndpoints(){const{organization:e,project:t}=this.props;return[["tombstones",`/projects/${e.slug}/${t.slug}/tombstones/`,{},{paginate:!0}]]}renderEmpty(){return(0,S.tZ)(v.s_,{children:(0,S.tZ)(y.Z,{children:(0,o.t)("You have no discarded issues")})})}renderBody(){const{project:e}=this.props,{tombstones:t,tombstonesPageLinks:s}=this.state;return t.length?(0,S.tZ)(g.Z,{access:["project:write"],project:e,children:e=>{let{hasAccess:i}=e;return(0,S.BX)(r.Fragment,{children:[(0,S.tZ)(v.s_,{children:t.map((e=>(0,S.tZ)(k,{data:e,disabled:!i,onUndiscard:this.handleUndiscard},e.id)))}),s&&(0,S.tZ)(j.Z,{pageLinks:s})]})}}):this.renderEmpty()}}const T=(0,m.Z)("div",{target:"e1tveyih2"})({name:"mfxqnx",styles:"flex:1;align-items:center;min-width:0"}),_=(0,m.Z)("div",{target:"e1tveyih1"})("margin:0 ",(0,F.D)(3),";flex-shrink:1;align-items:center;"),P=(0,m.Z)("div",{target:"e1tveyih0"})({name:"nq9fxm",styles:"flex-shrink:1;align-items:center"}),z=B;var E=s("./app/components/charts/miniBarChart.tsx"),C=s("./app/components/loadingError.tsx"),I=s("./app/components/placeholder.tsx"),N=s("./app/utils/theme.tsx"),X=s("./app/utils/withApi.tsx");const $={"browser-extensions":{title:(0,o.t)("Browser Extension"),color:N.ZP.gray200},cors:{title:"CORS",color:N.ZP.yellow300},"error-message":{title:(0,o.t)("Error Message"),color:N.ZP.purple300},"discarded-hash":{title:(0,o.t)("Discarded Issue"),color:N.ZP.gray200},"invalid-csp":{title:(0,o.t)("Invalid CSP"),color:N.ZP.blue300},"ip-address":{title:(0,o.t)("IP Address"),color:N.ZP.red200},"legacy-browsers":{title:(0,o.t)("Legacy Browser"),color:N.ZP.gray200},localhost:{title:(0,o.t)("Localhost"),color:N.ZP.blue300},"release-version":{title:(0,o.t)("Release"),color:N.ZP.purple200},"web-crawlers":{title:(0,o.t)("Web Crawler"),color:N.ZP.red300}};class A extends r.Component{constructor(){super(...arguments),(0,h.Z)(this,"state",{loading:!0,error:!1,statsError:!1,formattedData:[],blankStats:!0}),(0,h.Z)(this,"fetchData",(()=>{this.getFilterStats()}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){e.project!==this.props.project&&this.fetchData()}formatData(e){const t=new Set,s=Object.keys($).map((s=>({data:e[s].map((e=>{let[r,i]=e;return i>0&&(t.add($[s].title),this.setState({blankStats:!1})),{name:1e3*r,value:i}})),seriesName:$[s].title,color:$[s].color})));return s.filter((e=>t.has(e.seriesName)))}getFilterStats(){const e=Object.keys($),{organization:t,project:s}=this.props,r=Math.floor((new Date).getTime()/1e3),i=r-2592e3,a=`/projects/${t.slug}/${s.slug}/stats/`,n={since:i,until:r,resolution:"1d"},o=e.map((e=>this.props.api.requestPromise(a,{query:Object.assign({stat:e},n)})));Promise.all(o).then((t=>{const s={};for(let r=0;r<e.length;r++)s[e[r]]=t[r];this.setState({formattedData:this.formatData(s),error:!1,loading:!1})})).catch((()=>{this.setState({error:!0,loading:!1})}))}render(){const{loading:e,error:t,formattedData:s}=this.state,r=e||!s,i=!r&&t,a=!r&&!t,n=s?s.map((e=>e.color||N.ZP.gray200)):void 0;return(0,S.BX)(v.s_,{children:[(0,S.tZ)(v.V9,{children:(0,o.t)("Errors filtered in the last 30 days (by day)")}),(0,S.BX)(v.N,{withPadding:!0,children:[r&&(0,S.tZ)(I.Z,{height:"100px"}),i&&(0,S.tZ)(C.Z,{onRetry:this.fetchData}),a&&!this.state.blankStats&&(0,S.tZ)(E.Z,{series:s,colors:n,height:100,isGroupedByDate:!0,stacked:!0,labelYAxisExtents:!0}),a&&this.state.blankStats&&(0,S.tZ)(y.Z,{title:(0,o.t)("Nothing filtered in the last 30 days."),description:(0,o.t)("Issues filtered as a result of your settings below will be shown here.")})]})]})}}A.displayName="ProjectFiltersChart";const R=(0,X.Z)(A);var U=s("../src/sentry/static/sentry/images/logos/logo-android.svg"),O=s("../src/sentry/static/sentry/images/logos/logo-ie.svg"),L=s("../src/sentry/static/sentry/images/logos/logo-opera.svg"),M=s("../src/sentry/static/sentry/images/logos/logo-safari.svg"),V=s("./app/components/acl/feature.tsx"),q=s("./app/components/acl/featureDisabled.tsx"),G=s("./app/components/buttonBar.tsx"),W=s("./app/components/forms/fieldFromConfig.tsx"),Y=s("./app/components/forms/form.tsx"),H=s("./app/components/forms/formField/index.tsx"),J=s("./app/components/forms/jsonForm.tsx"),K=s("./app/components/loadingIndicator.tsx"),Q=s("./app/components/switchButton.tsx"),ee=s("./app/data/forms/inboundFilters.tsx"),te=s("./app/stores/projectsStore.tsx"),se=s("./app/utils/queryClient.tsx"),re=s("./app/utils/useOrganization.tsx");const ie={ie_pre_9:{icon:O,helpText:"Version 8 and lower",title:"Internet Explorer"},ie9:{icon:O,helpText:"Version 9",title:"Internet Explorer"},ie10:{icon:O,helpText:"Version 10",title:"Internet Explorer"},ie11:{icon:O,helpText:"Version 11",title:"Internet Explorer"},safari_pre_6:{icon:M,helpText:"Version 5 and lower",title:"Safari"},opera_pre_15:{icon:L,helpText:"Version 14 and lower",title:"Opera"},opera_mini_pre_8:{icon:L,helpText:"Version 8 and lower",title:"Opera Mini"},android_pre_4:{icon:U,helpText:"Version 3 and lower",title:"Android"}},ae=Object.keys(ie);var ne={name:"nb8u23",styles:"flex-shrink:0;margin-left:6px"};class oe extends r.Component{constructor(e){let t;super(e),(0,h.Z)(this,"handleToggleSubfilters",((e,t)=>{let{subfilters:s}=this.state;!0===e?s=new Set(ae):!1===e?s=new Set:s.has(e)?s.delete(e):s.add(e),this.setState({subfilters:new Set(s)},(()=>{this.props.onToggle(this.props.data,s,t)}))})),t=!0===e.data.active?new Set(ae):!1===e.data.active?new Set:new Set(e.data.active),this.state={loading:!1,error:!1,subfilters:t}}render(){const{disabled:e}=this.props;return(0,S.BX)("div",{children:[!e&&(0,S.BX)(be,{children:[(0,S.BX)(Ze,{children:[(0,o.t)("Filter"),":"]}),(0,S.BX)(G.ZP,{gap:1,children:[(0,S.tZ)(f.zx,{priority:"link",borderless:!0,onClick:this.handleToggleSubfilters.bind(this,!0),children:(0,o.t)("All")}),(0,S.tZ)(f.zx,{priority:"link",borderless:!0,onClick:this.handleToggleSubfilters.bind(this,!1),children:(0,o.t)("None")})]})]}),(0,S.tZ)(pe,{children:ae.map((t=>{const s=ie[t];return(0,S.BX)(he,{children:[(0,S.tZ)(me,{src:s.icon}),(0,S.BX)("div",{children:[(0,S.tZ)(ue,{children:s.title}),(0,S.tZ)(ge,{children:s.helpText})]}),(0,S.tZ)(Q.Z,{"aria-label":`${s.title} ${s.helpText}`,isActive:this.state.subfilters.has(t),isDisabled:e,css:ne,toggle:this.handleToggleSubfilters.bind(this,t),size:"lg"})]},t)}))})]})}}function le(e){let{project:t,disabled:s}=e;return(0,S.tZ)(V.Z,{features:["projects:custom-inbound-filters"],hookName:"feature-disabled:custom-inbound-filters",project:t,renderDisabled:e=>{let{children:t,...s}=e;return"function"==typeof t?t({...s,renderDisabled:e=>(0,S.tZ)(q.Z,{featureName:(0,o.t)("Custom Inbound Filters"),features:e.features,alert:v.aU,message:(0,o.t)("Release and Error Message filtering are not enabled on your Sentry installation")})}):null},children:e=>{let{hasFeature:i,organization:a,renderDisabled:n,...l}=e;return(0,S.BX)(r.Fragment,{children:[!i&&"function"==typeof n&&n({organization:a,hasFeature:i,children:null,...l}),ee.customFilterFields.map((e=>(0,S.tZ)(W.Z,{field:e,disabled:s||!i},e.name))),i&&t.options?.["filters:error_messages"]&&(0,S.tZ)(v.aU,{type:"warning","data-test-id":"error-message-disclaimer",children:(0,o.t)("Minidumps, errors in the minified production build of React, and Internet Explorer's i18n errors cannot be filtered by message.")})]})}})}function de(e){let{project:t,params:s,features:i}=e;const a=(0,re.Z)(),{projectId:n}=s,l=`/projects/${a.slug}/${n}/`,d=`${l}filters/`,{data:c,isLoading:p,isError:h,refetch:m}=(0,se.WE)([`/projects/${a.slug}/${n}/filters/`],{staleTime:1/0}),u=c??[],b=(0,r.useCallback)((e=>{let{onChange:t,onBlur:s,event:r,subfilters:i}=e;t?.(i,r),s?.(i,r)}),[]);return p?(0,S.tZ)(K.Z,{}):h?(0,S.tZ)(C.Z,{onRetry:m}):(0,S.tZ)(g.Z,{access:["project:write"],project:t,children:e=>{let{hasAccess:s}=e;return(0,S.BX)(r.Fragment,{children:[(0,S.BX)(v.s_,{children:[(0,S.tZ)(v.V9,{children:(0,o.t)("Filters")}),(0,S.BX)(v.N,{children:[u.map((e=>{const t={name:e.id,label:e.name,help:e.description,disabled:!s};return(0,S.tZ)(v.Lv,{noPadding:!0,children:(0,S.tZ)(ce,{apiMethod:"PUT",apiEndpoint:`${d}${e.id}/`,initialData:{[e.id]:e.active},saveOnBlur:!0,children:"legacy-browsers"!==e.id?(0,S.tZ)(W.Z,{getData:t=>({active:t[e.id]}),field:{type:"boolean",...t}},e.id):(0,S.tZ)(H.Z,{inline:!1,...t,getData:t=>({subfilters:[...t[e.id]]}),children:t=>{let{onChange:r,onBlur:i}=t;return(0,S.tZ)(oe,{data:e,disabled:!s,onToggle:(e,t,s)=>b({onChange:r,onBlur:i,event:s,subfilters:t})},e.id)}})})},e.id)})),(0,S.tZ)(v.Lv,{noPadding:!0,children:(0,S.tZ)(ce,{apiMethod:"PUT",apiEndpoint:l,initialData:{"filters:react-hydration-errors":t.options?.["filters:react-hydration-errors"]},saveOnBlur:!0,onSubmitSuccess:e=>te.Z.onUpdateSuccess(e),children:(0,S.tZ)(W.Z,{getData:ee.getOptionsData,field:{type:"boolean",name:"filters:react-hydration-errors",label:(0,o.t)("Filter out hydration errors"),help:(0,o.t)("React falls back to do a full re-render on a page and these errors are often not actionable."),disabled:!s}})})})]})]}),(0,S.tZ)(Y.Z,{apiMethod:"PUT",apiEndpoint:l,initialData:t.options,saveOnBlur:!0,onSubmitSuccess:e=>te.Z.onUpdateSuccess(e),children:(0,S.tZ)(J.Z,{features:i,forms:ee.default,disabled:!s,renderFooter:()=>(0,S.tZ)(le,{disabled:!s,project:t})})})]})}})}oe.displayName="LegacyBrowserFilterRow",le.displayName="CustomFilters",de.displayName="ProjectFiltersSettings";const ce=(0,m.Z)(Y.Z,{target:"e9jh1b67"})({name:"82a6rk",styles:"flex:1"}),pe=(0,m.Z)("div",{target:"e9jh1b66"})("display:grid;grid-template-columns:1fr 1fr;gap:",(0,F.D)(1.5),";margin-top:",(0,F.D)(2),";"),he=(0,m.Z)("div",{target:"e9jh1b65"})("display:grid;grid-template-columns:max-content 1fr max-content;gap:",(0,F.D)(1),";align-items:center;background:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";padding:",(0,F.D)(1.5),";"),me=(0,m.Z)("img",{target:"e9jh1b64"})({name:"hggq3y",styles:"width:38px;height:38px"}),ue=(0,m.Z)("div",{target:"e9jh1b63"})("font-size:",(e=>e.theme.fontSizeMedium),";font-weight:bold;white-space:nowrap;"),ge=(0,m.Z)("div",{target:"e9jh1b62"})("color:",(e=>e.theme.subText),";font-size:",(e=>e.theme.fontSizeSmall),";white-space:nowrap;"),be=(0,m.Z)("div",{target:"e9jh1b61"})("display:flex;align-items:center;gap:",(0,F.D)(.5),";"),Ze=(0,m.Z)("span",{target:"e9jh1b60"})("font-weight:bold;margin-right:",(0,F.D)(.75),";");function fe(e){const{organization:t,project:s,params:h,location:m}=e,{projectId:u,filterType:g}=h;if(!s)return null;const b=new Set(s.features);return(0,S.BX)(r.Fragment,{children:[(0,S.tZ)(n.Z,{title:(0,o.t)("Inbound Filters"),projectSlug:u}),(0,S.tZ)(d.Z,{title:(0,o.t)("Inbound Data Filters")}),(0,S.tZ)(c.Z,{children:(0,o.t)("Filters allow you to prevent Sentry from storing events in certain situations. Filtered events are tracked separately from rate limits, and do not apply to any project quotas.")}),(0,S.tZ)(p.Z,{project:s}),(0,S.BX)("div",{children:[(0,S.tZ)(R,{project:s,organization:t}),b.has("discard-groups")&&(0,S.BX)(a.Z,{underlined:!0,style:{paddingTop:"30px"},children:[(0,S.tZ)("li",{className:"data-filters"===g?"active":"",children:(0,S.tZ)(i.Z,{to:(0,l.Z)("data-filters/",{...e,stepBack:-1}),children:(0,o.t)("Data Filters")})}),(0,S.tZ)("li",{className:"discarded-groups"===g?"active":"",children:(0,S.tZ)(i.Z,{to:(0,l.Z)("discarded-groups/",{...e,stepBack:-1}),children:(0,o.t)("Discarded Issues")})})]}),"discarded-groups"===g?(0,S.tZ)(z,{organization:t,project:s,location:m}):(0,S.tZ)(de,{project:s,params:h,features:b})]})]})}fe.displayName="ProjectFilters";const xe=fe}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectFilters_index_tsx.056c21eab98ac6970eef793e6639bd77.js.map