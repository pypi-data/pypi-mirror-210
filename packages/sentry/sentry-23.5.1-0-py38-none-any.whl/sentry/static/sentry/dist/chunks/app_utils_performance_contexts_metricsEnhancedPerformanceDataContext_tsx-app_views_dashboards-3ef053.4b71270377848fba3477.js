"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_utils_performance_contexts_metricsEnhancedPerformanceDataContext_tsx-app_views_dashboards-3ef053"],{"./app/actionCreators/dashboards.tsx":(e,t,s)=>{s.d(t,{AK:()=>p,JR:()=>u,QL:()=>h,Y:()=>g,a_:()=>c,iM:()=>m,j2:()=>l});var i=s("../node_modules/lodash/omit.js"),r=s.n(i),a=s("./app/actionCreators/indicator.tsx"),o=s("./app/constants/pageFilters.tsx"),n=s("./app/locale.tsx"),d=s("./app/views/dashboards/utils.tsx");function l(e,t){const s=e.requestPromise(`/organizations/${t}/dashboards/`,{method:"GET",query:{sort:"myDashboardsAndRecentlyViewed"}});return s.catch((e=>{const t=e?.responseJSON??null;if(t){const e=(0,d.Tk)(t,{});(0,a.Iw)(e[Object.keys(e)[0]])}else(0,a.Iw)((0,n.t)("Unable to fetch dashboards"))})),s}function u(e,t,s,i){const{title:o,widgets:l,projects:u,environment:c,period:p,start:g,end:m,filters:h,utc:f}=s,b=e.requestPromise(`/organizations/${t}/dashboards/`,{method:"POST",data:{title:o,widgets:l.map((e=>r()(e,["tempId"]))),duplicate:i,projects:u,environment:c,period:p,start:g,end:m,filters:h,utc:f},query:{project:u}});return b.catch((e=>{const t=e?.responseJSON??null;if(t){const e=(0,d.Tk)(t,{});(0,a.Iw)(e[Object.keys(e)[0]])}else(0,a.Iw)((0,n.t)("Unable to create dashboard"))})),b}function c(e,t,s){return e.requestPromise(`/organizations/${t}/dashboards/${s}/visit/`,{method:"POST"})}function p(e,t,s){const i=e.requestPromise(`/organizations/${t}/dashboards/${s}/`,{method:"GET"});return i.catch((e=>{const t=e?.responseJSON??null;if(t){const e=(0,d.Tk)(t,{});(0,a.Iw)(e[Object.keys(e)[0]])}else(0,a.Iw)((0,n.t)("Unable to load dashboard"))})),i}function g(e,t,s){const{title:i,widgets:o,projects:l,environment:u,period:c,start:p,end:g,filters:m,utc:h}=s,f={title:i,widgets:o.map((e=>r()(e,["tempId"]))),projects:l,environment:u,period:c,start:p,end:g,filters:m,utc:h},b=e.requestPromise(`/organizations/${t}/dashboards/${s.id}/`,{method:"PUT",data:f,query:{project:l}});return b.catch((e=>{const t=e?.responseJSON??null;if(t){const e=(0,d.Tk)(t,{});(0,a.Iw)(e[Object.keys(e)[0]])}else(0,a.Iw)((0,n.t)("Unable to update dashboard"))})),b}function m(e,t,s){const i=e.requestPromise(`/organizations/${t}/dashboards/${s}/`,{method:"DELETE"});return i.catch((e=>{const t=e?.responseJSON??null;if(t){const e=(0,d.Tk)(t,{});(0,a.Iw)(e[Object.keys(e)[0]])}else(0,a.Iw)((0,n.t)("Unable to delete dashboard"))})),i}function h(e,t,s){return e.requestPromise(`/organizations/${t}/dashboards/widgets/`,{method:"POST",data:s,query:{project:[o.mP]}})}},"./app/actionCreators/sessions.tsx":(e,t,s)=>{s.d(t,{K:()=>o});var i=s("./app/components/charts/utils.tsx"),r=s("./app/components/organizations/pageFilters/parse.tsx"),a=s("./app/utils.tsx");const o=(e,t)=>{let{field:s,orgSlug:o,cursor:n,environment:d,groupBy:l,interval:u,project:c,orderBy:p,query:g,includeAllArgs:m=!1,includeSeries:h,includeTotals:f,statsPeriodStart:b,statsPeriodEnd:y,limit:w,...x}=t;const{start:v,end:_,statsPeriod:S}=(0,r.fK)(x,{allowEmptyPeriod:!0}),T=Object.fromEntries(Object.entries({field:s.filter((e=>!!e)),cursor:n,end:_,environment:d,groupBy:l?.filter((e=>!!e)),interval:u||(0,i.ZS)({start:v,end:_,period:S}),orderBy:p,per_page:w,query:g||void 0,project:c,start:v,statsPeriod:S,statsPeriodStart:b,statsPeriodEnd:y,includeSeries:!1===h?"0":"1",includeTotals:!1===f?"0":"1"}).filter((e=>{let[,t]=e;return(0,a.ri)(t)&&""!==t})));return e.requestPromise(`/organizations/${o}/sessions/`,{includeAllArgs:m,query:T})}},"./app/components/charts/simpleTableChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>_,p:()=>v});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),a=s("./app/components/panels/panelTable.tsx"),o=s("./app/components/tooltip.tsx"),n=s("./app/components/truncate.tsx"),d=s("./app/styles/space.tsx"),l=s("./app/utils/discover/fieldRenderers.tsx"),u=s("./app/utils/discover/fields.tsx"),c=s("./app/utils/useProjects.tsx"),p=s("./app/utils/withOrganization.tsx"),g=s("./app/views/discover/table/tableView.tsx"),m=s("./app/views/discover/table/topResultsIndicator.tsx"),h=s("./app/views/discover/utils.tsx"),f=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function b(e){let{className:t,loading:s,eventView:i,fields:a,metadata:n,data:d,title:p,fieldHeaderMap:b,stickyHeaders:_,getCustomFieldRenderer:S,organization:T,topResultsIndicators:O,location:R,fieldAliases:E,loader:D}=e;const{projects:Z}=(0,c.Z)(),A=n??{},C=(0,h.Hg)(a.map(((e,t)=>({field:e,alias:E[t]}))));return(0,f.BX)(r.Fragment,{children:[p&&(0,f.tZ)("h4",{children:p}),(0,f.tZ)(w,{className:t,isLoading:s,loader:D,headers:C.map(((e,t)=>{const s=(0,u.qG)(e.name,e.type,A),i=e.column.alias||(b?.[e.key]??e.name);return(0,f.tZ)(x,{align:s,children:(0,f.tZ)(o.u,{title:i,children:(0,f.tZ)(y,{value:i,maxLength:30,expandable:!1})})},t)})),isEmpty:!d?.length,stickyHeaders:_,disablePadding:!0,children:d?.map(((e,t)=>function(e,t,s,r){return r.map(((r,a)=>{const o=S?.(r.key,s,T)??(0,l.Js)(r.key,s),n=s.units?.[r.key];let d=o(t,{organization:T,location:R,eventView:i,unit:n});return"transaction"===r.key&&t.transaction&&(d=(0,f.tZ)(g.F,{to:(0,h.vT)(t,T,Z,i,R),children:d})),(0,f.BX)(v,{children:[O&&0===a&&(0,f.tZ)(m.C,{count:O,index:e}),d]},`${e}-${a}:${r.name}`)}))}(t,e,A,C)))})]})}b.displayName="SimpleTableChart";const y=(0,i.Z)(n.Z,{target:"e9vexrd3"})({name:"1bmnxg7",styles:"white-space:nowrap"}),w=(0,i.Z)(a.Z,{target:"e9vexrd2"})("border-radius:0;border-left:0;border-right:0;border-bottom:0;margin:0;",a.z,"{height:min-content;}"),x=(0,i.Z)("div",{target:"e9vexrd1"})((e=>e.align?`text-align: ${e.align};`:"")," padding:",(0,d.D)(1)," ",(0,d.D)(3),";"),v=(0,i.Z)("div",{target:"e9vexrd0"})("padding:",(0,d.D)(1)," ",(0,d.D)(3),";"),_=(0,p.Z)(b)},"./app/components/modals/widgetViewerModal/utils.tsx":(e,t,s)=>{let i;function r(e){return e.match(/\/widget\/[0-9]+\/$/)}s.d(t,{R:()=>i,X:()=>r}),function(e){e.SORT="sort",e.QUERY="query",e.LEGEND="legend",e.PAGE="page",e.CURSOR="cursor",e.WIDTH="width",e.START="viewerStart",e.END="viewerEnd"}(i||(i={}))},"./app/utils/dashboards/issueFieldRenderers.tsx":(e,t,s)=>{s.d(t,{N:()=>v,O:()=>A});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),a=s("./app/components/assigneeSelector.tsx"),o=s("./app/components/count.tsx"),n=s("./app/components/links/link.tsx"),d=s("./app/components/organizations/timeRangeSelector/utils.tsx"),l=s("./app/components/tooltip.tsx"),u=s("./app/constants/index.tsx"),c=s("./app/locale.tsx"),p=s("./app/stores/memberListStore.tsx"),g=s("./app/styles/space.tsx"),m=s("./app/utils/discover/eventView.tsx"),h=s("./app/views/dashboards/widgetBuilder/issueWidget/fields.tsx"),f=s("./app/utils/discover/styles.tsx"),b=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const y={issue:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;const i=e["issue.id"];if(!i)return(0,b.tZ)(f.W2,{children:(0,b.tZ)(f.PV,{shortId:`${e.issue}`})});const r={pathname:`/organizations/${s.slug}/issues/${i}/`};return(0,b.tZ)(f.W2,{children:(0,b.tZ)(f.Jo,{to:r,"aria-label":i,children:(0,b.tZ)(f.PV,{shortId:`${e.issue}`})})})}},assignee:{sortField:null,renderFunc:e=>{const t=p.Z.getAll();return(0,b.tZ)(D,{children:(0,b.tZ)(a.Z,{id:e.id,memberList:t,noDropdown:!0})})}},lifetimeEvents:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return w(e,s,"lifetimeEvents")}},lifetimeUsers:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return w(e,s,"lifetimeUsers")}},events:{sortField:"freq",renderFunc:(e,t)=>{let{organization:s}=t;return w(e,s,"events")}},users:{sortField:"user",renderFunc:(e,t)=>{let{organization:s}=t;return w(e,s,"users")}},lifetimeCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return w(e,s,"lifetimeEvents")}},lifetimeUserCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return w(e,s,"lifetimeUsers")}},count:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return w(e,s,"events")}},userCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return w(e,s,"users")}},links:{sortField:null,renderFunc:e=>{let{links:t}=e;return(0,b.tZ)(Z,{dangerouslySetInnerHTML:{__html:t}})}}},w=(e,t,s)=>{const{start:i,end:a,period:n}=e,p=!!/user/i.exec(s.toLowerCase()),g=e[s],m=e[p?"users":"events"],h=e[p?"lifetimeUsers":"lifetimeEvents"],y=e[p?"filteredUsers":"filteredEvents"],w=x(e,t),v=x(e,t,!0),_=i&&a?"time range":(0,d.TI)(n||u.GY).toLowerCase();return(0,b.tZ)(f.W2,{children:(0,b.tZ)(l.u,{isHoverable:!0,skipWrapper:!0,overlayStyle:{padding:0},title:(0,b.BX)("div",{children:[y?(0,b.BX)(r.Fragment,{children:[(0,b.BX)(T,{to:v,children:[(0,c.t)("Matching search filters"),(0,b.tZ)(R,{value:y})]}),(0,b.tZ)(E,{})]}):null,(0,b.BX)(T,{to:w,children:[(0,c.t)("Total in %s",_),(0,b.tZ)(R,{value:m})]}),(0,b.tZ)(E,{}),(0,b.BX)(S,{children:[(0,c.t)("Since issue began"),(0,b.tZ)(R,{value:h})]})]}),children:(0,b.tZ)("span",{children:["events","users"].includes(s)&&y?(0,b.BX)(r.Fragment,{children:[(0,b.tZ)(o.Z,{value:y}),(0,b.tZ)(O,{value:g})]}):(0,b.tZ)(o.Z,{value:g})})})})};w.displayName="issuesCountRenderer";const x=(e,t,s)=>{const i={projects:[Number(e.projectId)]};return m.ZP.fromSavedQuery({...i,id:void 0,start:e.start,end:e.end,range:e.period,name:e.title,fields:["title","release","environment","user","timestamp"],orderby:"-timestamp",query:`issue.id:${e.id}${s?e.discoverSearchQuery:""}`,version:2}).getResultsViewUrlTarget(t.slug)};function v(e){if(y.hasOwnProperty(e))return y[e].sortField;switch(e){case h.Sh.LAST_SEEN:return"date";case h.Sh.FIRST_SEEN:return"new";default:return null}}const _={name:"s5gdgx",styles:"width:100%;justify-content:space-between;display:flex;padding:6px 10px"},S=(0,i.Z)("div",{target:"e11k7yd46"})(_,";"),T=(0,i.Z)(n.Z,{target:"e11k7yd45"})(_,";color:",(e=>e.theme.gray400),";&:hover{color:",(e=>e.theme.gray400),";background:",(e=>e.theme.hover),";}"),O=(0,i.Z)(o.Z,{target:"e11k7yd44"})(":before{content:'/';padding-left:",(0,g.D)(.25),";padding-right:2px;}"),R=(0,i.Z)((e=>{let{value:t,...s}=e;return(0,b.tZ)("div",{...s,children:(0,b.tZ)(o.Z,{value:t})})}),{target:"e11k7yd43"})("text-align:right;font-weight:bold;font-variant-numeric:tabular-nums;padding-left:",(0,g.D)(2),";color:",(e=>e.theme.subText),";"),E=(0,i.Z)("div",{target:"e11k7yd42"})("height:1px;overflow:hidden;background-color:",(e=>e.theme.innerBorder),";"),D=(0,i.Z)("div",{target:"e11k7yd41"})({name:"1sl6pdq",styles:"display:flex;justify-content:left;margin-left:18px;height:24px;:hover{cursor:default;}"}),Z=(0,i.Z)("span",{target:"e11k7yd40"})({name:"1bmnxg7",styles:"white-space:nowrap"});function A(e){return y.hasOwnProperty(e)?y[e].renderFunc:null}},"./app/utils/performance/contexts/metricsEnhancedPerformanceDataContext.tsx":(e,t,s)=>{s.d(t,{AQ:()=>m,EA:()=>g,UT:()=>p,hX:()=>h});var i=s("../node_modules/react/index.js"),r=s("./app/components/tag.tsx"),a=s("./app/utils/useOrganization.tsx"),o=s("./app/views/performance/landing/widgets/utils.tsx"),n=s("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),d=s("./app/utils/performance/contexts/utils.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[u,c]=(0,d.n)({name:"MetricsEnhancedPerformanceDataContext"});function p(e){let{children:t,chartSetting:s}=e;const{setAutoSampleState:r}=(0,n.Eg)(),[a,d]=(0,i.useState)(void 0),c=(0,i.useCallback)((e=>{o.zS.includes(s)||(!0===e?r(n.nl.metrics):!1===e&&r(n.nl.transactions),d(e))}),[r,d,s]);return(0,l.tZ)(u,{value:{isMetricsData:a,setIsMetricsData:c},children:t})}p.displayName="MEPDataProvider";const g=c;function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e?.meta?.isMetricsData??e?.seriesAdditionalInfo?.[t]?.isMetricsData??e?.histograms?.meta?.isMetricsData??e?.tableData?.meta?.isMetricsData}function h(){const{isMetricsData:e}=g();if(!(0,a.Z)().features.includes("performance-use-metrics"))return null;if(void 0===e)return(0,l.tZ)("span",{"data-test-id":"no-metrics-data-tag"});const t=e?"processed":"indexed";return(0,l.tZ)(r.Z,{"data-test-id":"has-metrics-data-tag",children:t})}h.displayName="MEPTag"},"./app/utils/useCustomMeasurements.tsx":(e,t,s)=>{s.d(t,{Z:()=>a}),s("../node_modules/core-js/modules/es.error.cause.js");var i=s("../node_modules/react/index.js"),r=s("./app/utils/customMeasurements/customMeasurementsContext.tsx");function a(){const e=(0,i.useContext)(r.z);if(!e)throw new Error("useCustomMeasurements was called outside of CustomMeasurementsProvider");return e}},"./app/views/dashboards/dashboard.tsx":(e,t,s)=>{s.d(t,{re:()=>U,ey:()=>Q,ZP:()=>se});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react-grid-layout/css/styles.css"),s("../node_modules/react-resizable/css/styles.css"),s("../node_modules/react/index.js")),o=s("../node_modules/react-grid-layout/index.js"),n=s("../node_modules/react-lazyload/lib/index.js"),d=s("../node_modules/lodash/cloneDeep.js"),l=s.n(d),u=s("../node_modules/lodash/debounce.js"),c=s.n(u),p=s("../node_modules/lodash/isEqual.js"),g=s.n(p),m=s("./app/actionCreators/dashboards.tsx"),h=s("./app/actionCreators/indicator.tsx"),f=s("./app/actionCreators/members.tsx"),b=s("./app/actionCreators/tags.tsx"),y=s("./app/components/button.tsx"),w=s("./app/icons/index.tsx"),x=s("./app/locale.tsx"),v=s("./app/stores/groupStore.tsx"),_=s("./app/styles/space.tsx"),S=s("./app/utils/theme.tsx"),T=s("./app/utils/withApi.tsx"),O=s("./app/utils/withDomainRequired.tsx"),R=s("./app/utils/withPageFilters.tsx"),E=s("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js"),D=s("./app/views/dashboards/types.tsx"),Z=s("../node_modules/framer-motion/dist/es/render/dom/motion.mjs");const A=(0,r.Z)(Z.E.div,{target:"ekh4oo10"})("position:relative;touch-action:manipulation;",(e=>"big_number"===e.displayType?`\n          /* 2 cols */\n          grid-area: span 1 / span 2;\n\n          @media (min-width: ${e.theme.breakpoints.small}) {\n            /* 4 cols */\n            grid-area: span 1 / span 1;\n          }\n\n          @media (min-width: ${e.theme.breakpoints.xlarge}) {\n            /* 6 and 8 cols */\n            grid-area: span 1 / span 2;\n          }\n        `:"\n          /* 2, 4, 6 and 8 cols */\n          grid-area: span 2 / span 2;\n        "),";");var C=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const I="add-widget-button",F={x:0,y:0,scaleX:1,scaleY:1};function M(e){let{onAddWidget:t}=e;const{setNodeRef:s,transform:i}=(0,E.nB)({disabled:!0,id:I,transition:null});return(0,C.tZ)(A,{ref:s,displayType:D.FO.BIG_NUMBER,layoutId:I,style:{originX:0,originY:0},animate:i?{x:i.x,y:i.y,scaleX:i?.scaleX&&i.scaleX<=1?i.scaleX:1,scaleY:i?.scaleY&&i.scaleY<=1?i.scaleY:1}:F,transition:{duration:.25},children:(0,C.tZ)(P,{onClick:t,children:(0,C.tZ)(L,{"data-test-id":"widget-add",icon:(0,C.tZ)(w.N_,{size:"lg",isCircled:!0,color:"inactive"}),"aria-label":(0,x.t)("Add widget")})})},"add")}M.displayName="AddWidget";const j=M,L=(0,r.Z)(y.zx,{target:"eg8m0jy1"})({name:"6ayxgl",styles:"border:none;&,&:focus,&:active,&:hover{background:transparent;box-shadow:none;}"}),P=(0,r.Z)("div",{target:"eg8m0jy0"})("width:100%;height:110px;border:2px dashed ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";display:flex;align-items:center;justify-content:center;cursor:",(e=>e.onClick?"pointer":""),";");var $=s("./app/views/dashboards/layoutUtils.tsx"),W=s("./app/components/panels/panelAlert.tsx"),N=s("./app/views/dashboards/widgetCard/index.tsx");function B(e){const{widget:t,isEditing:s,widgetLimitReached:i,onDelete:r,onEdit:a,onDuplicate:o,isPreview:n,isMobile:d,windowWidth:l,index:u,dashboardFilters:c}=e,p={widget:t,isEditing:s,widgetLimitReached:i,onDelete:r,onEdit:a,onDuplicate:o,showContextMenu:!0,isPreview:n,index:u,dashboardFilters:c,renderErrorMessage:e=>"string"==typeof e&&(0,C.tZ)(W.Z,{type:"error",children:e}),isMobile:d,windowWidth:l,tableItemLimit:20};return(0,C.tZ)(k,{children:(0,C.tZ)(N.ZP,{...p})})}B.displayName="SortableWidget";const z=B,k=(0,r.Z)("div",{target:"en5z12u0"})({name:"13udsys",styles:"height:100%"});var q=s("./app/views/dashboards/utils.tsx");const U="widget-drag",V="widget-resize",H="desktop",G="mobile",Q=6,X=[16,16],Y={x:0,y:Number.MAX_SAFE_INTEGER},J=parseInt(S.ZP.breakpoints.small,10),K={[G]:0,[H]:J},ee={[G]:2,[H]:Q};class te extends a.Component{constructor(e){super(e),(0,i.Z)(this,"forceCheckTimeout",void 0),(0,i.Z)(this,"debouncedHandleResize",c()((()=>{this.setState({windowWidth:window.innerWidth})}),250)),(0,i.Z)(this,"handleStartAdd",(()=>{const{organization:e,router:t,location:s,paramDashboardId:i}=this.props;i?t.push((0,O.D)({pathname:`/organizations/${e.slug}/dashboard/${i}/widget/new/`,query:{...s.query,source:D.EN.DASHBOARDS}})):t.push((0,O.D)({pathname:`/organizations/${e.slug}/dashboards/new/widget/new/`,query:{...s.query,source:D.EN.DASHBOARDS}}))})),(0,i.Z)(this,"handleUpdateComplete",(e=>t=>{const{isEditing:s,onUpdate:i,handleUpdateWidgetList:r}=this.props;let a=[...this.props.dashboard.widgets];const o=a.indexOf(e),n={...t,tempId:e.tempId};(0,$.I_)(e.displayType)!==(0,$.I_)(t.displayType)?(a[o]=(0,$.W8)(n),a=(0,$.Bb)(a)):a[o]=n,i(a),s||r(a)})),(0,i.Z)(this,"handleDeleteWidget",(e=>()=>{const{dashboard:t,onUpdate:s,isEditing:i,handleUpdateWidgetList:r}=this.props;let a=t.widgets.filter((t=>t!==e));a=(0,$.Bb)(a),s(a),i||r(a)})),(0,i.Z)(this,"handleDuplicateWidget",((e,t)=>()=>{const{dashboard:s,onUpdate:i,isEditing:r,handleUpdateWidgetList:a}=this.props,o=l()((0,$.TE)({...e,id:void 0,tempId:void 0}));let n=[...s.widgets];n.splice(t,0,o),n=(0,$.Bb)(n),i(n),r||a(n)})),(0,i.Z)(this,"handleEditWidget",(e=>()=>{const{organization:t,router:s,location:i,paramDashboardId:r}=this.props;r?s.push((0,O.D)({pathname:`/organizations/${t.slug}/dashboard/${r}/widget/${e}/edit/`,query:{...i.query,source:D.EN.DASHBOARDS}})):s.push((0,O.D)({pathname:`/organizations/${t.slug}/dashboards/new/widget/${e}/edit/`,query:{...i.query,source:D.EN.DASHBOARDS}}))})),(0,i.Z)(this,"handleLayoutChange",((e,t)=>{const{isMobile:s}=this.state,{dashboard:i,onUpdate:r}=this.props,a=e=>{let{i:t}=e;return t!==I},o={[H]:t[H].filter(a),[G]:t[G].filter(a)};let d=(0,$.Sp)(o[H]);const l=i.widgets.map((e=>{const t=(0,$.Yb)(e);let i=o[H].find((e=>{let{i:s}=e;return s===t}));if(!i){const r=(0,$.I_)(e.displayType),a={w:$.c6,h:r,minH:r,i:t},[n,l]=(0,$.Hh)(d,r);if(d=l,i={...a,...n},s){const e=o[G].filter((e=>{let{i:s}=e;return s!==t}));e.push({...a,...Y}),o[G]=e}}return{...e,layout:(0,$.hq)(i)}}));this.setState({layouts:o}),r(l),window.clearTimeout(this.forceCheckTimeout),this.forceCheckTimeout=window.setTimeout(n.be,400)})),(0,i.Z)(this,"handleBreakpointChange",(e=>{const{layouts:t}=this.state,{dashboard:{widgets:s}}=this.props;e!==G?this.setState({isMobile:!1}):this.setState({isMobile:!0,layouts:{...t,[G]:(0,$.VW)(t[H],s)}})}));const{dashboard:t}=e,s=(0,$.RI)(t.widgets);this.state={isMobile:!1,layouts:{[H]:s,[G]:(0,$.VW)(s,t.widgets)},windowWidth:window.innerWidth}}static getDerivedStateFromProps(e,t){if(t.isMobile)return null;const s=(0,$.RI)(e.dashboard.widgets);return g()(s.map($.hq),t.layouts[H].map($.hq))?null:{...t,layouts:{[H]:s,[G]:(0,$.VW)(s,e.dashboard.widgets)}}}componentDidMount(){const{newWidget:e}=this.props;window.addEventListener("resize",this.debouncedHandleResize),this.fetchTags(),e&&this.addNewWidget(),this.fetchMemberList()}componentDidUpdate(e){const{selection:t,newWidget:s}=this.props;s&&s!==e.newWidget&&this.addNewWidget(),g()(e.selection.projects,t.projects)||this.fetchMemberList()}componentWillUnmount(){window.removeEventListener("resize",this.debouncedHandleResize),window.clearTimeout(this.forceCheckTimeout),v.Z.reset()}fetchMemberList(){const{api:e,selection:t}=this.props;(0,f.MA)(e,this.props.organization.slug,t.projects?.map((e=>String(e))))}async addNewWidget(){const{api:e,organization:t,newWidget:s,handleAddCustomWidget:i,onSetNewWidget:r}=this.props;if(s)try{await(0,m.QL)(e,t.slug,s),i(s),r?.()}catch(e){(0,h.Iw)(e)}}fetchTags(){const{api:e,organization:t,selection:s}=this.props;(0,b.QK)(e,t.slug,s)}getWidgetIds(){return[...this.props.dashboard.widgets.map(((e,t)=>(0,$.$n)(e,t))),I]}renderWidget(e,t){const{isMobile:s,windowWidth:i}=this.state,{isEditing:r,widgetLimitReached:a,isPreview:o,dashboard:n,location:d}=this.props,l={widget:e,isEditing:r,widgetLimitReached:a,onDelete:this.handleDeleteWidget(e),onEdit:this.handleEditWidget(t),onDuplicate:this.handleDuplicateWidget(e,t),isPreview:o,dashboardFilters:(0,q.lM)(d)??n.filters},u=(0,$.Yb)(e);return(0,C.tZ)("div",{"data-grid":e.layout,children:(0,C.tZ)(z,{...l,isMobile:s,windowWidth:i,index:String(t)})},u)}get addWidgetLayout(){const{isMobile:e,layouts:t}=this.state;let s=Y;if(!e){const e=(0,$.Sp)(t[H]),[i]=(0,$.Hh)(e,1);s=i}return{...s,w:$.c6,h:1,isResizable:!1}}render(){const{layouts:e,isMobile:t}=this.state,{isEditing:s,dashboard:i,widgetLimitReached:r,organization:a}=this.props;let{widgets:o}=i;o=o.filter((e=>{let{widgetType:t}=e;return t!==D.l9.RELEASE||a.features.includes("dashboards-rh-widget")}));const n=(0,$.Sp)(e[H]),d=(0,$._F)(o,n),l=!t&&s;return(0,C.BX)(re,{breakpoints:K,cols:ee,rowHeight:120,margin:X,draggableHandle:`.${U}`,draggableCancel:`.${V}`,layouts:e,onLayoutChange:this.handleLayoutChange,onBreakpointChange:this.handleBreakpointChange,isDraggable:l,isResizable:l,resizeHandle:(0,C.tZ)(ae,{"aria-label":(0,x.t)("Resize Widget"),"data-test-id":"custom-resize-handle",className:V,size:"xs",borderless:!0,icon:(0,C.tZ)(w.Iq,{size:"xs"})}),useCSSTransforms:!1,isBounded:!0,children:[d.map(((e,t)=>this.renderWidget(e,t))),s&&!r&&(0,C.tZ)(ie,{"data-grid":this.addWidgetLayout,children:(0,C.tZ)(j,{onAddWidget:this.handleStartAdd})},I)]})}}te.displayName="Dashboard";const se=(0,T.Z)((0,R.Z)(te)),ie=(0,r.Z)("div",{target:"e105tu292"})("z-index:5;background-color:",(e=>e.theme.background),";"),re=(0,r.Z)((0,o.WidthProvider)(o.Responsive),{target:"e105tu291"})("margin:-",(0,_.D)(2),";.react-grid-item.react-grid-placeholder{background:",(e=>e.theme.purple200),";border-radius:",(e=>e.theme.borderRadius),";}"),ae=(0,r.Z)(y.zx,{target:"e105tu290"})("position:absolute;z-index:2;bottom:",(0,_.D)(.5),";right:",(0,_.D)(.5),";color:",(e=>e.theme.subText),";cursor:nwse-resize;.react-resizable-hide &{display:none;}")},"./app/views/dashboards/datasetConfig/base.tsx":(e,t,s)=>{s.d(t,{N:()=>p,v:()=>c});var i=s("../node_modules/lodash/trimStart.js"),r=s.n(i),a=s("./app/utils/discover/fields.tsx"),o=s("./app/views/dashboards/types.tsx"),n=s("./app/views/dashboards/utils.tsx"),d=s("./app/views/dashboards/datasetConfig/errorsAndTransactions.tsx"),l=s("./app/views/dashboards/datasetConfig/issues.tsx"),u=s("./app/views/dashboards/datasetConfig/releases.tsx");function c(e){switch(e){case o.l9.ISSUE:return l.f;case o.l9.RELEASE:return u.u$;case o.l9.DISCOVER:default:return d.g}}function p(e,t){const s=r()(e.orderby,"-"),i=e.orderby.startsWith("-")?"-":"";if(!t.includes(s)&&""!==e.orderby){const r=e.aggregates.includes(s),o=(0,a.GO)(s),d=e.columns.includes(s),l=r||o||d,u=(0,a.GO)(e.aggregates[0]??"")?`equation[${(0,n.yd)(e.aggregates)-1}]`:t[0];e.orderby=l&&e.orderby||`${i}${u}`}return e}},"./app/views/dashboards/datasetConfig/errorsAndTransactions.tsx":(e,t,s)=>{s.d(t,{g:()=>$}),s("../node_modules/core-js/modules/es.array.push.js");var i=s("../node_modules/lodash/trimStart.js"),r=s.n(i),a=s("./app/actionCreators/events.tsx"),o=s("./app/components/charts/utils.tsx"),n=s("./app/components/links/link.tsx"),d=s("./app/components/tooltip.tsx"),l=s("./app/locale.tsx"),u=s("./app/utils.tsx"),c=s("./app/utils/discover/fieldRenderers.tsx"),p=s("./app/utils/discover/fields.tsx"),g=s("./app/utils/discover/genericDiscoverQuery.tsx"),m=s("./app/utils/discover/styles.tsx"),h=s("./app/utils/discover/types.tsx"),f=s("./app/utils/discover/urls.tsx"),b=s("./app/utils/events.tsx"),y=s("./app/utils/fields/index.ts"),w=s("./app/utils/measurements/measurements.tsx"),x=s("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),v=s("./app/views/discover/table/types.tsx"),_=s("./app/views/discover/utils.tsx"),S=s("./app/views/performance/traceDetails/utils.tsx"),T=s("./app/views/performance/utils.tsx"),O=s("./app/views/dashboards/types.tsx"),R=s("./app/views/dashboards/utils.tsx"),E=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),D=s("./app/components/events/searchBar.tsx"),Z=s("./app/constants/index.tsx"),A=s("./app/types/index.tsx"),C=s("./app/utils/useCustomMeasurements.tsx"),I=s("./app/views/dashboards/widgetBuilder/utils.tsx"),F=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function M(e){let{organization:t,pageFilters:s,onClose:i,widgetQuery:r}=e;const{customMeasurements:a}=(0,C.Z)(),o=s.projects,n=(0,R.tT)("",r,s),d=n.hasAggregateField()?(0,p.db)(t,n.fields):n.fields;return(0,F.tZ)(j,{searchSource:"widget_builder",organization:t,projectIds:o,query:r.conditions,fields:d,onClose:i,useFormWrapper:!1,maxQueryLength:Z.dI,maxSearchItems:I.yM,maxMenuHeight:I.CD,savedSearchType:A.L4.EVENT,customMeasurements:a})}M.displayName="EventsSearchBar";const j=(0,E.Z)(D.Z,{target:"ewp53780"})({name:"1ff36h2",styles:"flex-grow:1"});var L=s("./app/views/dashboards/widgetBuilder/buildSteps/sortByStep/index.tsx"),P=s("./app/views/dashboards/widgetCard/widgetQueries.tsx");const $={defaultWidgetQuery:{name:"",fields:["count()"],columns:[],fieldAliases:[],aggregates:["count()"],conditions:"",orderby:"-count()"},enableEquations:!0,getCustomFieldRenderer:function(e,t){return"id"===e?N:"trace"===e?B:["title","transaction"].includes(e)?function(s,i){return s[e]===T.og?(0,F.tZ)(m.W2,{children:(0,F.tZ)(n.Z,{to:(0,T.uq)({location:i.location,organization:i.organization,source:T.Pv.DISCOVER}),children:s[e]})}):(0,c.Js)(e,t,!1)(s,i)}:(0,c.Js)(e,t,!1)},SearchBar:M,filterSeriesSortOptions:function(e){return t=>t.value.kind===v.L.FUNCTION||t.value.kind===v.L.EQUATION||e.has(t.value.meta.name)||t.value.meta.name===L.E},filterYAxisAggregateParams:function(e,t){return s=>{if(t===O.FO.BIG_NUMBER)return!0;if(e.kind!==v.L.FUNCTION)return!0;const i=e.function[0],r=(0,p.Xh)(i,s.value.meta.name);return r?(0,p.HW)(r):s.value.kind!==v.L.FUNCTION&&s.value.kind!==v.L.EQUATION&&(0,p.HW)(s.value.meta.dataType)}},filterYAxisOptions:function(e){return t=>{if(e!==O.FO.BIG_NUMBER&&t.value.kind===v.L.FUNCTION){const e=(0,p.Xh)(t.value.meta.name,void 0);if(e)return(0,p.HW)(e)}return t.value.kind===v.L.FUNCTION}},getTableFieldOptions:W,getTimeseriesSortOptions:function(e,t,s){const i={};i[`field:${L.E}`]={label:"Custom Equation",value:{kind:v.L.EQUATION,meta:{name:L.E}}};let r=0;[...t.aggregates,...t.columns].filter((e=>!!e)).forEach((e=>{let t;const s=(0,p.bQ)(e);(0,p.GO)(e)&&(t=`equation[${r}]`,r+=1,i[`equation:${t}`]={label:s,value:{kind:v.L.EQUATION,meta:{name:t??e}}})}));const a=W(e,s);return{...i,...a}},getTableSortOptions:function(e,t){const{columns:s,aggregates:i}=t,r=[];let a=0;return[...i,...s].filter((e=>!!e)).forEach((e=>{let t;const s=(0,p.bQ)(e);(0,p.GO)(e)&&(t=`equation[${a}]`,a+=1),r.push({label:s,value:t??e})})),r},getGroupByFieldOptions:W,handleOrderByReset:s("./app/views/dashboards/datasetConfig/base.tsx").N,supportedDisplayTypes:[O.FO.AREA,O.FO.BAR,O.FO.BIG_NUMBER,O.FO.LINE,O.FO.TABLE,O.FO.TOP_N,O.FO.WORLD_MAP],getTableRequest:(e,t,s,i,r,a,o,n)=>z(`/organizations/${s.slug}/events/`,e,t,s,i,r,a,o,n),getSeriesRequest:function(e,t,s,i,o,n,d){const l=t.queries[s],{displayType:c,limit:g}=t,{environments:m,projects:f}=o,{start:b,end:y,period:w}=o.datetime,v=(0,R.s)(c,{start:b,end:y,period:w}),_=(i.features.includes("dashboards-mep")||i.features.includes("mep-rollout-flag"))&&(0,u.ri)(d)&&d!==x.oR.transactionsOnly;let S;if(c===O.FO.TOP_N)S={organization:i,interval:v,start:b,end:y,project:f,environment:m,period:w,query:l.conditions,yAxis:l.aggregates[l.aggregates.length-1],includePrevious:!1,referrer:n,partial:!0,field:[...l.columns,...l.aggregates],queryExtras:(0,R.Gl)(_),includeAllArgs:!0,topEvents:h.hY},l.orderby&&(S.orderby=l.orderby);else if(S={organization:i,interval:v,start:b,end:y,project:f,environment:m,period:w,query:l.conditions,yAxis:l.aggregates,orderby:l.orderby,includePrevious:!1,referrer:n,partial:!0,queryExtras:(0,R.Gl)(_),includeAllArgs:!0},0!==l.columns?.length){S.topEvents=g??h.hY,S.field=[...l.columns,...l.aggregates];const e=r()(l.orderby,"-");if(!l.orderby||(0,p.uI)(e)||S.field.includes(e)||S.field.push(e),S.excludeOther=1!==l.aggregates.length||1!==t.queries.length,(0,p.GO)(r()(l.orderby,"-"))){const e=(0,R.yd)(l.aggregates),t=l.orderby.startsWith("-")?"-":"";S.orderby=`${t}equation[${e}]`,S.field=[...l.columns,...l.aggregates,r()(l.orderby,"-")]}}return(0,a.lI)(e,S)},getWorldMapRequest:(e,t,s,i,r,a,o)=>z(`/organizations/${s.slug}/events-geo/`,e,t,s,i,r,a,o),transformSeries:function(e,t){let s=[];const i=t.name;if((0,o.Xe)(e)){let r=[];r=t.aggregates.length>1&&t.columns.length?(0,P.vD)(e,i):Object.keys(e).map((t=>{const s=i?`${i} : ${t}`:t,r=e[t];return[r.order||0,(0,P.FN)(r,s,t)]})),s=[...r.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]))]}else{const r=t.aggregates[0],a=i?`${i} : ${r}`:r,o=(0,P.FN)(e,a,r);s.push(o)}return s},transformTable:function(e,t){let s=e;const{fields:i,...r}=e.meta??{};return s={...e,meta:{...i,...r}},s},filterAggregateParams:function(e,t){return!(e.value.kind===v.L.CUSTOM_MEASUREMENT&&"function"===t?.kind&&t?.function&&!e.value.meta.functions.includes(t.function[0])||e.value.meta.name===y.Sh.TOTAL_COUNT)},getSeriesResultType:function(e,t){const s=t.aggregates[0],i={};return(0,o.Xe)(e)?Object.keys(e).forEach((t=>i[t]=e[t].meta?.fields[(0,p.LY)(t)])):i[s]=e.meta?.fields[(0,p.LY)(s)],i}};function W(e,t,s){const i=(0,w.i)();return(0,_.R0)({organization:e,tagKeys:Object.values(t??{}).map((e=>{let{key:t}=e;return t})),measurementKeys:Object.values(i).map((e=>{let{key:t}=e;return t})),spanOperationBreakdownKeys:p.$4,customMeasurements:e.features.includes("dashboards-mep")||e.features.includes("mep-rollout-flag")?Object.values(s??{}).map((e=>{let{key:t,functions:s}=e;return{key:t,functions:s}})):void 0})}function N(e,t){let{eventView:s,organization:i}=t;const r=e?.id;if(!s||"string"!=typeof r)return null;const a=(0,f.JE)(e),o=(0,f.eQ)({orgSlug:i.slug,eventSlug:a,eventView:s});return(0,F.tZ)(d.u,{title:(0,l.t)("View Event"),children:(0,F.tZ)(n.Z,{"data-test-id":"view-event",to:o,children:(0,F.tZ)(m.W2,{children:(0,b.XQ)(r)})})})}function B(e,t){let{eventView:s,organization:i,location:r}=t;const a=e?.trace;if(!s||"string"!=typeof a)return null;const o=s.normalizeDateSelection(r),u=(0,S.YA)(i,String(e.trace),o,{});return(0,F.tZ)(d.u,{title:(0,l.t)("View Trace"),children:(0,F.tZ)(n.Z,{"data-test-id":"view-trace",to:u,children:(0,F.tZ)(m.W2,{children:(0,b.XQ)(a)})})})}function z(e,t,s,i,r,a,o,n,d){const l=(i.features.includes("dashboards-mep")||i.features.includes("mep-rollout-flag"))&&(0,u.ri)(d)&&d!==x.oR.transactionsOnly,c=(0,R.tT)("",s,r),p={per_page:a,cursor:o,referrer:n,...(0,R.Gl)(l)};return s.orderby&&(p.sort="string"==typeof s.orderby?[s.orderby]:s.orderby),(0,g.AA)(t,e,{...c.generateQueryStringObject(),...p},{retry:{statusCodes:[429],tries:3}})}N.displayName="renderEventIdAsLinkable",B.displayName="renderTraceAsLinkable"},"./app/views/dashboards/datasetConfig/issues.tsx":(e,t,s)=>{s.d(t,{f:()=>S}),s("../node_modules/core-js/modules/es.array.push.js");var i=s("./app/components/searchSyntax/parser.tsx"),r=s("./app/locale.tsx"),a=s("./app/stores/groupStore.tsx"),o=s("./app/utils/dashboards/issueFieldRenderers.tsx"),n=s("./app/utils/dates.tsx"),d=s("./app/views/issueList/utils.tsx"),l=s("./app/views/dashboards/types.tsx"),u=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),c=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),p=s("./app/views/dashboards/widgetBuilder/utils.tsx"),g=s("./app/views/issueList/searchBar.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function h(e){let{onClose:t,widgetQuery:s,organization:i}=e;return(0,m.tZ)(c.ms,{children:e=>{let{css:a}=e;return(0,m.tZ)(f,{searchSource:"widget_builder",organization:i,query:s.conditions||"",onClose:t,placeholder:(0,r.t)("Search for issues, status, assigned, and more"),maxSearchItems:p.yM,dropdownClassName:a`
            max-height: ${p.CD}px;
            overflow-y: auto;
          `})}})}h.displayName="IssuesSearchBar";const f=(0,u.Z)(g.Z,{target:"els7enb0"})({name:"1hoyb5r",styles:"flex-grow:1;button:not([aria-label='Clear search']){display:none;}"});var b=s("./app/views/dashboards/widgetBuilder/issueWidget/fields.tsx"),y=s("./app/views/discover/table/types.tsx");const w=[d.qh.DATE,d.qh.NEW,d.qh.FREQ,d.qh.PRIORITY,d.qh.USER],x={name:"",fields:["issue","assignee","title"],columns:["issue","assignee","title"],fieldAliases:[],aggregates:[],conditions:"",orderby:d.qh.DATE},v=d.qh.DATE,_=["owners"],S={defaultWidgetQuery:x,enableEquations:!1,disableSortOptions:function(e){return{disableSort:!1,disableSortDirection:!0,disableSortReason:(0,r.t)("Issues dataset does not yet support descending order")}},getTableRequest:function(e,t,s,i,r,a){const o=`/organizations/${s.slug}/issues/`,d={project:i.projects??[],environment:i.environments??[],query:t.conditions,sort:t.orderby||v,expand:_,limit:r??l.$V,cursor:a};return i.datetime.period&&(d.statsPeriod=i.datetime.period),i.datetime.end&&(d.end=(0,n.v5)(i.datetime.end)),i.datetime.start&&(d.start=(0,n.v5)(i.datetime.start)),i.datetime.utc&&(d.utc=i.datetime.utc),e.requestPromise(o,{includeAllArgs:!0,method:"GET",data:{...d}})},getCustomFieldRenderer:o.O,SearchBar:h,getTableSortOptions:function(e,t){return[...w].map((e=>({label:(0,d._k)(e),value:e})))},getTableFieldOptions:e=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.$L;const t=Object.keys(e).sort(),s={};return t.forEach((t=>{s[`field:${t}`]={label:t,value:{kind:y.L.FIELD,meta:{name:t,dataType:e[t]}}}})),s}(),fieldHeaderMap:b.kh,supportedDisplayTypes:[l.FO.TABLE],transformTable:function(e,t,s,r){a.Z.add(e);const o=[];return e.forEach((e=>{let{id:s,shortId:a,title:l,lifetime:u,filtered:c,count:p,userCount:g,project:m,annotations:h,...f}=e;const b={};Object.keys(f).filter((e=>["number","string"].includes(typeof f[e]))).forEach((e=>{b[e]=f[e]}));const y={...b,events:p,users:g,id:s,"issue.id":s,issue:a,title:l,project:m.slug,links:h?.join(", ")};u&&(y.lifetimeEvents=u?.count,y.lifetimeUsers=u?.userCount),c&&(y.filteredEvents=c?.count,y.filteredUsers=c?.userCount);const w=t.conditions,x=(0,i.UG)(w),v=x?.filter((e=>!(e.type===i.WU.Filter&&d.QL.includes(e.key.text))));y.discoverSearchQuery=(0,i.D3)(v,!0),y.projectId=m.id;const{period:_,start:S,end:T}=r.datetime||{};S&&T&&(y.start=(0,n.v5)(S),y.end=(0,n.v5)(T)),y.period=_??"",o.push(y)})),{data:o}}}},"./app/views/dashboards/datasetConfig/releases.tsx":(e,t,s)=>{s.d(t,{u$:()=>B}),s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/core-js/modules/es.error.cause.js");var i=s("../node_modules/lodash/omit.js"),r=s.n(i),a=s("../node_modules/lodash/trimStart.js"),o=s.n(a),n=s("./app/components/charts/utils.tsx"),d=s("./app/components/organizations/pageFilters/parse.tsx"),l=s("./app/utils.tsx");const u=(e,t)=>{let{field:s,orgSlug:i,cursor:r,environment:a,groupBy:o,includeSeries:u,includeTotals:c,interval:p,limit:g,orderBy:m,project:h,query:f,includeAllArgs:b=!1,statsPeriodStart:y,statsPeriodEnd:w,...x}=t;const{start:v,end:_,statsPeriod:S}=(0,d.fK)(x,{allowEmptyPeriod:!0}),T=Object.fromEntries(Object.entries({field:s.filter((e=>!!e)),cursor:r,end:_,environment:a,groupBy:o?.filter((e=>!!e)),includeSeries:u,includeTotals:c,interval:p||(0,n.ZS)({start:v,end:_,period:S}),query:f||void 0,per_page:g,project:h,orderBy:m,start:v,statsPeriod:S,statsPeriodStart:y,statsPeriodEnd:w}).filter((e=>{let[,t]=e;return(0,l.ri)(t)&&""!==t}))),O=`/organizations/${i}/metrics/data/`;return e.requestPromise(O,{includeAllArgs:b,query:T})};var c=s("./app/actionCreators/sessions.tsx"),p=s("./app/locale.tsx"),g=s("./app/types/index.tsx"),m=s("./app/utils/dates.tsx"),h=s("./app/utils/discover/fieldRenderers.tsx"),f=s("./app/views/discover/table/types.tsx"),b=s("./app/views/dashboards/types.tsx"),y=s("./app/views/dashboards/utils.tsx"),w=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),x=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),v=s("../node_modules/lodash/memoize.js"),_=s.n(v),S=s("./app/actionCreators/tags.tsx"),T=s("./app/components/smartSearchBar/index.tsx"),O=s("./app/constants/index.tsx"),R=s("./app/utils/useApi.tsx"),E=s("./app/views/dashboards/widgetBuilder/utils.tsx"),D=s("./app/views/dashboards/widgetBuilder/releaseWidget/fields.tsx"),Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const A=new RegExp(`^${O.c$}|\\${O.ir}`,"g");function C(e){let{organization:t,pageFilters:s,widgetQuery:i,onClose:r}=e;const a=t.slug,o=s.projects,n=(0,R.Z)();function d(e){return e.replace(A,"")}function l(e,t){if("session.status"===e.name)return Promise.resolve(D._I);const s=o?.map(String);return(0,S.Fo)({api:n,orgSlug:a,tagKey:e.key,search:t,projectIds:s,includeTransactions:!0}).then((e=>e.map((e=>{let{value:t}=e;return t}))),(()=>{throw new Error("Unable to fetch tag values")}))}const u=Object.values(D.Wt).reduce(((e,t)=>(e[t]={key:t,name:t},e)),{});return(0,Z.tZ)(x.ms,{children:e=>{let{css:t}=e;return(0,Z.tZ)(I,{onGetTagValues:_()(l,((e,t)=>{let{key:s}=e;return`${s}-${t}`})),supportedTags:u,placeholder:(0,p.t)("Search for release version, session status, and more"),prepareQuery:d,dropdownClassName:t`
            max-height: ${E.CD??300}px;
            overflow-y: auto;
          `,onClose:r,maxQueryLength:O.dI,maxSearchItems:E.yM,searchSource:"widget_builder",query:i.conditions,savedSearchType:g.L4.SESSION,hasRecentSearches:!0,highlightUnsupportedTags:!0})}})}C.displayName="ReleaseSearchBar";const I=(0,w.Z)(T.Z,{target:"e185ylgn0"})({name:"1ff36h2",styles:"flex-grow:1"});var F=s("./app/views/dashboards/widgetCard/releaseWidgetQueries.tsx");function M(e,t,s){const i=Object.entries(t.by).map((e=>{let[t,s]=e;return`${s}`})).join(", ");return`${s?`${s} > `:""}${i?`${i} : ${(0,F.nD)(e)}`:(0,F.nD)(e)}`}var j=s("./app/utils/discover/fields.tsx");function L(e){const t={};for(const[s,i]of Object.entries(e))t[(0,F.nD)(s)]=i;return t}function P(e,t,s){const i={};return s.length?(void 0===e["session.status"]||s.forEach((s=>{const r=s.match(D.$4);r&&(e["session.status"]===r[1]?"session"===r[2]?i[s]=t["sum(session)"]:"user"===r[2]&&(i[s]=t["count_unique(user)"]):i[s]=0)})),i):i}var $=s("./app/views/dashboards/datasetConfig/base.tsx");const W={name:"",fields:[`crash_free_rate(${g.r2.SESSION})`],columns:[],fieldAliases:[],aggregates:[`crash_free_rate(${g.r2.SESSION})`],conditions:"",orderby:`-crash_free_rate(${g.r2.SESSION})`},N=new Date("2022-07-12"),B={defaultWidgetQuery:W,enableEquations:!1,disableSortOptions:function(e){const{columns:t}=e;return t.includes("session.status")?{disableSort:!0,disableSortDirection:!0,disableSortReason:(0,p.t)("Sorting currently not supported with session.status")}:{disableSort:!1,disableSortDirection:!1}},getTableRequest:(e,t,s,i,r,a)=>U(0,1,e,t,s,i,void 0,r,a),getSeriesRequest:function(e,t,s,i,r){const a=t.queries[s],{displayType:o,limit:n}=t,{datetime:d}=r,{start:l,end:u,period:c}=d,p=(0,F.Vl)(a);return U(1,a.columns.length>0?1:0,e,a,i,r,(0,y.s)(o,{start:l,end:u,period:c},"5m",p?"low":void 0),n)},getTableSortOptions:function(e,t){const{columns:s,aggregates:i}=t,r=[];return[...i,...s].filter((e=>!!e)).filter((e=>!D.d2.includes(e))).filter((e=>!D.aE.includes(e))).forEach((e=>{r.push({label:e,value:e})})),r},getTimeseriesSortOptions:function(e,t){const s=new Set(t.columns),i=(0,D.e1)(Object.values(D.Jo),D.ve),r={};return Object.entries(i).forEach((e=>{let[t,i]=e;["count_healthy","count_errored"].includes(i.value.meta.name)||(i.value.kind!==f.L.FIELD||"release"===i.value.meta.name&&s.has(i.value.meta.name))&&(r[t]=i)})),r},filterTableOptions:z,filterAggregateParams:k,filterYAxisAggregateParams:(e,t)=>k,filterYAxisOptions:function(e){return e=>[f.L.FUNCTION,f.L.NUMERIC_METRICS].includes(e.value.kind)},getCustomFieldRenderer:(e,t)=>(0,h.Js)(e,t,!1),SearchBar:C,getTableFieldOptions:function(e){return(0,D.e1)(Object.values(D.Jo),D.ve)},getGroupByFieldOptions:e=>(0,D.e1)([],D.ve),handleColumnFieldChangeOverride:function(e){if(0===e.aggregates.length){const t=`crash_free_rate(${g.r2.SESSION})`;e.aggregates=[t],e.fields=e.fields?[...e.fields,t]:[t]}return e},handleOrderByReset:function(e,t){return e.columns.includes("session.status")&&(e.orderby=""),(0,$.N)(e,t)},filterSeriesSortOptions:function(e){return t=>!["count_healthy","count_errored"].includes(t.value.meta.name)&&(t.value.kind===f.L.FIELD?e.has(t.value.meta.name)&&"release"===t.value.meta.name:z(t))},supportedDisplayTypes:[b.FO.AREA,b.FO.BAR,b.FO.BIG_NUMBER,b.FO.LINE,b.FO.TABLE,b.FO.TOP_N],transformSeries:function(e,t){if(null===e)return[];const s=t.name,i=t.columns.includes("session.status"),{derivedStatusFields:r,injectedFields:a}=(0,F.gp)(t.aggregates,t.orderby,i),o=[];return e.groups.length?(e.groups.forEach((t=>{Object.keys(t.series).forEach((i=>{a.includes((0,F.nD)(i))||o.push({seriesName:M(i,t,s),data:e.intervals.map(((e,s)=>({name:e,value:t.series[i][s]??0})))})})),r.length&&(0,l.ri)(t.by["session.status"])&&r.forEach((i=>{const r=i.match(D.$4);if(r){let a;t.by["session.status"]===r[1]&&("session"===r[2]?a="sum(session)":"user"===r[2]&&(a="count_unique(user)")),o.push({seriesName:M(i,t,s),data:e.intervals.map(((e,s)=>({name:e,value:a?t.series[a][s]??0:0})))})}}))})),o):[{seriesName:`(${(0,p.t)("no results")})`,data:e.intervals.map((e=>({name:e,value:0})))}]},transformTable:function(e,t){const s=t.columns.includes("session.status"),{derivedStatusFields:i,injectedFields:a}=(0,F.gp)(t.aggregates,t.orderby,s),o=e.groups.map(((e,t)=>({id:String(t),...L(e.by),...r()(L(e.totals),a),...P(e.by,e.totals,i)}))),n=o[0];return{meta:{...(d=r()(n,"id"),Object.keys(d??{}).reduce(((e,t)=>(e[t]=D.ve.includes(t)?"string":(0,j.Px)(t),e)),{}))},data:o};var d}};function z(e){return[f.L.FUNCTION,f.L.FIELD,f.L.NUMERIC_METRICS].includes(e.value.kind)}function k(e){return e.value.kind===f.L.METRICS}function q(e){return D.wg[e]??e}function U(e,t,s,i,r,a,n,d,l){const{environments:g,projects:h,datetime:f}=a,{start:b,end:y,period:w}=f;let x=!1;if(b){let e;e="string"==typeof b?new Date(b):b,x=e<N}else if(w){const e=(0,m.Ri)(w),t=new Date;x=new Date((new Date).setDate(t.getDate()-e))<N}if(x)return Promise.reject(new Error((0,p.t)("Releases data is only available from Jul 12. Please retry your query with a more recent date range.")));const v=i.columns.includes("session.status"),_=(0,F.Vl)(i),S=i.orderby.startsWith("-"),T=o()(i.orderby,"-"),O=D.d2.includes(T)||v||"release"===T,R=i.columns,{aggregates:E,injectedFields:Z}=(0,F.gp)(i.aggregates,i.orderby,v);let A,C;return v?(A={field:E.filter((e=>!Object.values(D.Xg).includes(e))),orgSlug:r.slug,end:y,environment:g,groupBy:R,limit:void 0,orderBy:"",interval:n,project:h,query:i.conditions,start:b,statsPeriod:w,includeAllArgs:!0,cursor:l},C=c.K):(A={field:E.map(q),orgSlug:r.slug,end:y,environment:g,groupBy:R.map(q),limit:0===R.length?1:_?100:d,orderBy:O?"":S?`-${q(T)}`:q(T),interval:n,project:h,query:i.conditions,start:b,statsPeriod:w,includeAllArgs:!0,cursor:l,includeSeries:e,includeTotals:t},C=u,!T||O||E.includes(T)||R.includes(T)||(A.field=[...A.field,q(T)],Z.includes(T)||Z.push(T))),C(s,A)}},"./app/views/dashboards/layoutUtils.tsx":(e,t,s)=>{s.d(t,{$n:()=>b,Bb:()=>Z,Hh:()=>R,I_:()=>S,RI:()=>v,Sp:()=>O,TE:()=>w,VW:()=>x,W8:()=>D,WJ:()=>T,Yb:()=>y,_F:()=>E,c6:()=>m,hq:()=>_});var i=s("../node_modules/react-grid-layout/build/utils.js"),r=s("../node_modules/lodash/pickBy.js"),a=s.n(r),o=s("../node_modules/lodash/sortBy.js"),n=s.n(o),d=s("../node_modules/lodash/zip.js"),l=s.n(d),u=s("./app/utils.tsx"),c=s("./app/utils/guid.tsx"),p=s("./app/views/dashboards/dashboard.tsx"),g=s("./app/views/dashboards/types.tsx");const m=2,h="grid-item",f=["x","y","w","h","minW","maxW","minH","maxH"];function b(e,t){return e.id?`${e.id}-index-${t}`:`index-${t}`}function y(e){return`${h}-${e.id??e.tempId}`}function w(e){return e.id??e.tempId?e:{...e,tempId:(0,c.E)()}}function x(e,t){if(0===e.length)return[];const s=l()(e,t);return n()(s,["0.y","0.x"]).map(((e,t)=>{let[s,i]=e;return{...s,x:0,y:2*t,w:2,h:i.displayType===g.FO.BIG_NUMBER?1:2}}))}function v(e){return e.filter((e=>(0,u.ri)(e.layout))).map((e=>{let{layout:t,...s}=e;return{...t,i:y(s)}}))}function _(e){return a()(e,((e,t)=>(0,u.ri)(e)&&f.includes(t)))}function S(e){return e===g.FO.BIG_NUMBER?1:2}function T(){return Array(p.ey).fill(0)}function O(e){const t=T();return e.forEach((e=>{let{x:s,w:i,y:r,h:a}=e;for(let e=s;e<s+i;e++)t[e]=Math.max(r+a,t[e])})),t}function R(e,t){const s=[...e],i=Math.max(...s);for(let e=0;e<=i;e++)for(let i=0;i<=s.length-m;i++){if(s[i]>e)continue;const r=i+m;if(s.slice(i,r).every((t=>t<=e))){for(let r=i;r<i+m;r++)s[r]=e+t;return[{x:i,y:e},[...s]]}}for(let e=0;e<m;e++)s[e]=i;return[{x:0,y:i},[...s]]}function E(e,t){let s=[...t];return e.map((e=>{if((0,u.ri)(e.layout))return e;const t=S(e.displayType),[i,r]=R(s,t);return s=r,{...e,layout:{...i,h:t,minH:t,w:m}}}))}function D(e){const{displayType:t,layout:s}=e,i={...e};if(!(0,u.ri)(s))return i;const r=S(t),a={...s,h:Math.max(s?.h??r,r),minH:r};return{...i,layout:a}}function Z(e){const t=(0,i.compact)(v(e),"vertical",p.ey);return e.map((e=>{const s=t.find((t=>{let{i:s}=t;return s===y(e)}));return s?{...e,layout:s}:e}))}},"./app/views/dashboards/widgetBuilder/buildSteps/buildStep.tsx":(e,t,s)=>{s.d(t,{F:()=>n});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("./app/components/list/listItem.tsx"),a=s("./app/styles/space.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n(e){let{title:t,description:s,required:i=!1,children:r,...a}=e;return(0,o.BX)(d,{...a,children:[(0,o.BX)(l,{children:[t,i&&(0,o.tZ)(p,{})]}),(0,o.tZ)(u,{children:s}),(0,o.tZ)(c,{children:r})]})}n.displayName="BuildStep";const d=(0,i.Z)(r.Z,{target:"er6xldl4"})({name:"vetbs0",styles:"display:grid"}),l=(0,i.Z)("h5",{target:"er6xldl3"})("margin-bottom:0;color:",(e=>e.theme.gray500),";"),u=(0,i.Z)("small",{target:"er6xldl2"})("color:",(e=>e.theme.gray300),";padding:",(0,a.D)(.25)," ",(0,a.D)(2)," ",(0,a.D)(2)," 0;@media (max-width: ",(e=>e.theme.breakpoints.small),"){padding-top:",(0,a.D)(1),";margin-left:-",(0,a.D)(4),";}"),c=(0,i.Z)("div",{target:"er6xldl1"})("display:grid;@media (max-width: ",(e=>e.theme.breakpoints.small),"){margin-left:-",(0,a.D)(4),";}"),p=(0,i.Z)("div",{target:"er6xldl0"})("background:",(e=>e.theme.red300),";opacity:0.6;width:5px;height:5px;border-radius:5px;margin-left:",(0,a.D)(.5),";display:inline-block;vertical-align:super;")},"./app/views/dashboards/widgetBuilder/buildSteps/sortByStep/index.tsx":(e,t,s)=>{s.d(t,{E:()=>R,j:()=>E});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),a=s("../node_modules/lodash/trimStart.js"),o=s.n(a),n=s("./app/components/forms/controls/selectControl.tsx"),d=s("./app/components/forms/fieldGroup/index.tsx"),l=s("./app/components/tooltip.tsx"),u=s("./app/locale.tsx"),c=s("./app/styles/space.tsx"),p=s("./app/views/dashboards/datasetConfig/base.tsx"),g=s("./app/views/dashboards/types.tsx"),m=s("./app/views/dashboards/widgetBuilder/utils.tsx"),h=s("./app/views/dashboards/widgetBuilder/buildSteps/buildStep.tsx"),f=s("../node_modules/lodash/uniqBy.js"),b=s.n(f),y=s("./app/utils/discover/fields.tsx"),w=s("./app/utils/useOrganization.tsx"),x=s("./app/views/discover/table/arithmeticInput.tsx"),v=s("./app/views/discover/table/queryField.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function S(e){let{values:t,widgetType:s,onChange:i,disableSortReason:a,disableSort:d,disableSortDirection:c,widgetQuery:h,displayType:f}=e;const S=(0,p.v)(s),E=(0,w.Z)(),D=new Set(h.columns),[Z,A]=(0,r.useState)(!1),[C,I]=(0,r.useState)({sortBy:`${y.qe}`,sortDirection:t.sortDirection});return(0,r.useEffect)((()=>{const e=(0,y.GO)(o()(t.sortBy,"-"));e&&I({sortBy:o()(t.sortBy,"-"),sortDirection:t.sortDirection}),A(e)}),[t.sortBy,t.sortDirection]),(0,_.BX)(T,{children:[(0,_.tZ)(l.u,{title:a,disabled:!c||c&&d,children:(0,_.tZ)(n.Z,{name:"sortDirection","aria-label":"Sort direction",menuPlacement:"auto",disabled:c,options:Object.keys(m.Qj).map((e=>({label:m.Qj[e],value:e}))),value:t.sortDirection,onChange:e=>{i({sortBy:t.sortBy,sortDirection:e.value})}})}),(0,_.tZ)(l.u,{title:a,disabled:!d||c&&d,children:f===g.FO.TABLE?(0,_.tZ)(n.Z,{name:"sortBy","aria-label":"Sort by",menuPlacement:"auto",disabled:d,placeholder:`${(0,u.t)("Select a column")}…`,value:t.sortBy,options:b()(S.getTableSortOptions(E,h),(e=>{let{value:t}=e;return t})),onChange:e=>{i({sortBy:e.value,sortDirection:t.sortDirection})}}):(0,_.tZ)(v.q,{disabled:d,fieldValue:Z?(0,y.HM)({field:R}):(0,y.HM)({field:t.sortBy}),fieldOptions:S.getTimeseriesSortOptions(E,h),filterPrimaryOptions:S.filterSeriesSortOptions?S.filterSeriesSortOptions(D):void 0,filterAggregateParameters:S.filterAggregateParams,onChange:e=>{if(e.alias&&(0,y.uI)(e.alias))return void i({sortBy:e.alias,sortDirection:t.sortDirection});const s=(0,y.sN)(e),r=(0,y.GO)(s);A(r),i(r?C:{sortBy:s,sortDirection:t.sortDirection})}})}),Z&&(0,_.tZ)(O,{children:(0,_.tZ)(x.Z,{name:"arithmetic",type:"text",required:!0,placeholder:(0,u.t)("Enter Equation"),value:(0,y.vp)(C.sortBy),onUpdate:e=>{const s={sortBy:`${y.qe}${e}`,sortDirection:t.sortDirection};i(s),I(s)},hideFieldOptions:!0})})]})}S.displayName="SortBySelectors";const T=(0,i.Z)("div",{target:"ei4dc871"})("display:grid;gap:",(0,c.D)(1),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:200px 1fr;}"),O=(0,i.Z)("div",{target:"ei4dc870"})({name:"18iuzk9",styles:"grid-column:1/-1"}),R="custom-equation";function E(e){let{displayType:t,onSortByChange:s,queries:i,widgetType:a,error:n,limit:c,onLimitChange:f,tags:b}=e;const y=(0,p.v)(a);let w,x=!1,v=!1;y.disableSortOptions&&({disableSort:x,disableSortDirection:v,disableSortReason:w}=y.disableSortOptions(i[0]));const T=i[0].orderby,O=o()(T,"-"),R=(0,m.oA)(i.length,i[0].aggregates.length),E=[g.FO.LINE,g.FO.BAR,g.FO.AREA].includes(t);return(0,r.useEffect)((()=>{c&&c>R&&f(R)}),[c,R,f]),(0,_.tZ)(h.F,{title:t===g.FO.TABLE?(0,u.t)("Sort by a column"):(0,u.t)("Sort by a y-axis"),description:t===g.FO.TABLE?(0,u.t)("Choose one of the columns you've created to sort by."):(0,u.t)("Choose one of the y-axis you've created to sort by."),"data-test-id":"sort-by-step",children:(0,_.tZ)(l.u,{title:w,disabled:!(v&&x),children:(0,_.BX)(d.Z,{inline:!1,error:n,flexibleControlStateSize:!0,stacked:!0,children:[[g.FO.AREA,g.FO.BAR,g.FO.LINE].includes(t)&&c&&(0,_.tZ)(D,{disabled:v&&x,name:"resultsLimit",menuPlacement:"auto",options:[...Array(R).keys()].map((e=>{const t=e+1;return{label:(0,u.tn)("Limit to %s result","Limit to %s results",t),value:t}})),value:c,onChange:e=>{f(e.value)}}),(0,_.tZ)(S,{displayType:t,widgetType:a,hasGroupBy:E&&!!i[0].columns.length,disableSortReason:w,disableSort:x,disableSortDirection:v,widgetQuery:i[0],values:{sortDirection:"-"===T[0]?m.Sr.HIGH_TO_LOW:m.Sr.LOW_TO_HIGH,sortBy:O},onChange:e=>{let{sortDirection:t,sortBy:i}=e;const r=t===m.Sr.HIGH_TO_LOW?`-${i}`:i;s(r)},tags:b})]})})})}E.displayName="SortByStep";const D=(0,i.Z)(n.Z,{target:"e1jlvjy40"})("margin-bottom:",(0,c.D)(1),";")},"./app/views/dashboards/widgetBuilder/utils.tsx":(e,t,s)=>{s.d(t,{CD:()=>D,Qj:()=>x,Sr:()=>w,V0:()=>A,Zi:()=>T,_4:()=>S,_k:()=>h,eQ:()=>O,hV:()=>v,i0:()=>b,oA:()=>Z,qg:()=>y,wc:()=>_,yM:()=>E}),s("../node_modules/core-js/modules/es.array.push.js");var i=s("../node_modules/lodash/cloneDeep.js"),r=s.n(i),a=s("../node_modules/lodash/isEqual.js"),o=s.n(a),n=s("../node_modules/lodash/trimStart.js"),d=s.n(n),l=s("./app/locale.tsx"),u=s("./app/utils/discover/fields.tsx"),c=s("./app/views/dashboards/types.tsx"),p=(s("./app/views/discover/table/types.tsx"),s("./app/views/discover/utils.tsx"),s("./app/views/issueList/utils.tsx")),g=s("./app/views/dashboards/utils.tsx"),m=s("./app/views/dashboards/widgetBuilder/releaseWidget/fields.tsx");const h=5,f=10,b="new";let y,w;!function(e){e.EVENTS="events",e.ISSUES="issues",e.RELEASES="releases"}(y||(y={})),function(e){e.HIGH_TO_LOW="high_to_low",e.LOW_TO_HIGH="low_to_high"}(w||(w={}));const x={[w.HIGH_TO_LOW]:(0,l.t)("High to low"),[w.LOW_TO_HIGH]:(0,l.t)("Low to high")},v={[c.FO.AREA]:(0,l.t)("Area Chart"),[c.FO.BAR]:(0,l.t)("Bar Chart"),[c.FO.LINE]:(0,l.t)("Line Chart"),[c.FO.TABLE]:(0,l.t)("Table"),[c.FO.WORLD_MAP]:(0,l.t)("World Map"),[c.FO.BIG_NUMBER]:(0,l.t)("Big Number")};function _(e,t){return Object.keys(e).forEach((s=>{const i=e[s];"string"!=typeof i?Array.isArray(i)&&"string"==typeof i[0]?t[s]=i[0]:Array.isArray(i)&&"object"==typeof i[0]?t[s]=i.map((e=>_(e,{}))):t[s]=_(i,{}):t[s]=i})),t}const S=e=>{let{aggregates:t,columns:s,widgetType:i}=e;const r=i===c.l9.RELEASE,a=[];let o=0;return(r?[...t.map(u.hr),...s]:[...t,...s]).filter((e=>!!e)).filter((e=>!m.d2.includes(e))).filter((e=>!r||!m.aE.includes(e))).forEach((e=>{let t;const s=(0,u.bQ)(e);(0,u.GO)(e)&&(t=`equation[${o}]`,o+=1),a.push({label:s,value:t??e})})),a};function T(e){let{displayType:t,queries:s,widgetType:i}=e;const a=A(t),n=[c.FO.TABLE,c.FO.TOP_N].includes(t);if(s=r()(s),[c.FO.TABLE,c.FO.WORLD_MAP,c.FO.BIG_NUMBER].includes(t)?s=s.slice(0,1):a&&(s=s.slice(0,3)),s=s.map((e=>{const{fields:r=[],columns:a}=e;if(e.fields=n?[...new Set([...r,...a])]:r.filter((e=>!a.includes(e))),A(t)&&!e.columns.filter((e=>!!e)).length)return e.orderby="",e;const o=i===c.l9.RELEASE?(0,u.hr)(s[0].orderby):s[0].orderby,l=d()(o,"-"),m=!(n&&(0,u.GO)(l)||!(0,u.GO)(l)&&!(0,u.uI)(l)&&![...e.columns,...e.aggregates].includes(l)||(0,u.uI)(l)&&(0,u.G5)(l)>(0,g.yd)([...e.columns,...e.aggregates])-1)&&d()(o,"-")||(i===c.l9.ISSUE?o??p.qh.DATE:S({widgetType:i??c.l9.DISCOVER,columns:s[0].columns,aggregates:s[0].aggregates})[0]?.value);if(!m)return e.orderby="",e;const h=!e.orderby||i!==c.l9.ISSUE&&o.startsWith("-");return e.orderby=h?`-${String(m)}`:String(m),e})),n)return s;if(s=s.map((e=>{let s=e.aggregates;return(a||t===c.FO.WORLD_MAP)&&(s=s.filter((e=>(0,u.HW)((0,u.Px)(e))))),a&&s.length&&s.length>3&&(s=s.slice(0,3)),{...e,fields:s.length?s:["count()"],columns:e.columns?e.columns:[],aggregates:s.length?s:["count()"]}})),a){const e=[...s[0].aggregates];e:for(const t of s){if(e.length>=3)break;if(!o()(e,t.aggregates))for(const s of t.aggregates){if(e.length>=3)break e;e.includes(s)||e.push(s)}}s=s.map((t=>({...t,columns:t.columns?t.columns:[],aggregates:e,fields:e})))}return[c.FO.WORLD_MAP,c.FO.BIG_NUMBER].includes(t)&&(s=s.map((e=>({...e,fields:e.aggregates.slice(0,1),aggregates:e.aggregates.slice(0,1),orderby:"",columns:[]})))),s}function O(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""),t=Object.fromEntries(e.entries());if(!Object.keys(t).length)return;const s=t.columns?R(t.columns):[],i=t.aggregates?R(t.aggregates):[],r=[...s,...i];return{...t,fields:r,columns:s,aggregates:i}}function R(e){return e.split(/,(?![^(]*\))/g)}const E=5,D=250;function Z(e,t){return 0===e||0===t?h:Math.floor(f/(e*t))}function A(e){return[c.FO.LINE,c.FO.AREA,c.FO.BAR].includes(e)}},"./app/views/dashboards/widgetCard/chart.tsx":(e,t,s)=>{s.d(t,{R:()=>j,Z:()=>P});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("../node_modules/react/index.js"),o=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),n=s("../node_modules/lodash/isEqual.js"),d=s.n(n),l=s("../node_modules/lodash/omit.js"),u=s.n(l),c=s("./app/components/charts/areaChart.tsx"),p=s("./app/components/charts/barChart.tsx"),g=s("./app/components/charts/chartZoom.tsx"),m=s("./app/components/charts/errorPanel.tsx"),h=s("./app/components/charts/lineChart.tsx"),f=s("./app/components/charts/simpleTableChart.tsx"),b=s("./app/components/charts/transitionChart.tsx"),y=s("./app/components/charts/transparentLoadingMask.tsx"),w=s("./app/components/charts/utils.tsx"),x=s("./app/components/charts/worldMapChart.tsx"),v=s("./app/components/loadingIndicator.tsx"),_=s("./app/components/placeholder.tsx"),S=s("./app/components/tooltip.tsx"),T=s("./app/icons/index.tsx"),O=s("./app/styles/space.tsx"),R=s("./app/utils/discover/charts.tsx"),E=s("./app/utils/discover/fieldRenderers.tsx"),D=s("./app/utils/discover/fields.tsx"),Z=s("./app/utils/getDynamicText.tsx"),A=s("./app/views/dashboards/utils.tsx"),C=s("./app/views/dashboards/datasetConfig/base.tsx"),I=s("./app/views/dashboards/types.tsx"),F=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const M="Other",j=60;class L extends a.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{containerHeight:0})}shouldComponentUpdate(e,t){if(this.props.widget.displayType===I.FO.BIG_NUMBER&&e.widget.displayType===I.FO.BIG_NUMBER&&(this.props.windowWidth!==e.windowWidth||!d()(this.props.widget?.layout,e.widget?.layout)))return!0;const s={...u()(this.props,["windowWidth"]),widget:{...this.props.widget,title:""}};return e={...u()(e,["windowWidth"]),widget:{...e.widget,title:""}},!d()(s,e)||!d()(this.state,t)}tableResultComponent(e){let{loading:t,errorMessage:s,tableResults:i}=e;const{location:r,widget:a,organization:o,selection:n}=this.props;if(s)return(0,F.tZ)(U,{children:(0,F.tZ)(T.FC,{color:"gray500",size:"lg"})});if(void 0===i)return(0,F.tZ)(N,{});const d=(0,C.v)(a.widgetType);return i.map(((e,s)=>{const l=a.queries[s]?.fields?.map(D.hr)??[],u=a.queries[s]?.fieldAliases??[],c=(0,A.tT)(a.title,a.queries[0],n,a.displayType);return(0,F.tZ)(q,{eventView:c,fieldAliases:u,location:r,fields:l,title:i.length>1?e.title:"",loading:t,loader:(0,F.tZ)(N,{}),metadata:e.meta,data:e.data,organization:o,stickyHeaders:!0,getCustomFieldRenderer:d.getCustomFieldRenderer},`table:${e.title}`)}))}bigNumberComponent(e){let{loading:t,errorMessage:s,tableResults:i}=e;if(s)return(0,F.tZ)(U,{children:(0,F.tZ)(T.FC,{color:"gray500",size:"lg"})});if(void 0===i||t)return(0,F.tZ)(z,{children:"—"});const{containerHeight:r}=this.state,{location:a,organization:o,widget:n,isMobile:d,expandNumbers:l}=this.props;return i.map((e=>{const t={...e.meta},s=Object.keys(t)[0],i=!!l&&"integer"===t[s];if(i&&(t[s]="string"),!s||!e.data?.length)return(0,F.tZ)(z,{children:"—"},`big_number:${e.title}`);const u=e.data[0],c=(0,E.fK)(s,t,!1),p=t.units?.[s],g=c(i?{[s]:u[s].toLocaleString()}:u,{location:a,organization:o,unit:p});if(!n.id&&!n.tempId||d)return(0,F.tZ)(z,{children:g},`big_number:${e.title}`);const m=l?`max(min(8vw, 90px), ${(0,O.D)(4)})`:r-parseInt((0,O.D)(1),10)-parseInt((0,O.D)(3),10);return(0,F.tZ)(z,{style:{fontSize:m,...l?{padding:`${(0,O.D)(1)} ${(0,O.D)(3)} 0 ${(0,O.D)(3)}`}:{}},children:(0,F.tZ)(S.u,{title:g,showOnlyOnOverflow:!0,children:g})},`big_number:${e.title}`)}))}chartComponent(e){const{widget:t}=this.props,s=t.queries[0]?.columns.length>0;switch(t.displayType){case"bar":return(0,F.tZ)(p.v,{...e,stacked:s});case"area":case"top_n":return(0,F.tZ)(c.T,{stacked:!0,...e});case"world_map":return(0,F.tZ)(x.y,{...e});default:return(0,F.tZ)(h.w,{...e})}}render(){const{theme:e,tableResults:t,timeseriesResults:s,errorMessage:i,loading:r,widget:a,onZoom:o,legendOptions:n,expandNumbers:d,showSlider:l,noPadding:u,chartZoomOptions:c,timeseriesResultsTypes:p}=this.props;if("table"===a.displayType)return(0,Z.Z)({value:(0,F.BX)(b.Z,{loading:r,reloading:r,children:[(0,F.tZ)(W,{loading:r}),this.tableResultComponent({tableResults:t,loading:r,errorMessage:i})]}),fixed:(0,F.tZ)(_.Z,{height:"200px",testId:"skeleton-ui"})});if("big_number"===a.displayType)return(0,F.BX)(b.Z,{loading:r,reloading:r,children:[(0,F.tZ)(W,{loading:r}),(0,F.tZ)(B,{ref:e=>{if(null!==e&&!d){const{height:t}=e.getBoundingClientRect();t!==this.state.containerHeight&&this.setState({containerHeight:t})}},children:this.bigNumberComponent({tableResults:t,loading:r,errorMessage:i})})]});if(i)return(0,F.tZ)(U,{children:(0,F.tZ)(T.FC,{color:"gray500",size:"lg"})});const{location:m,router:h,selection:f,onLegendSelectChanged:y}=this.props,{start:x,end:v,period:S,utc:O}=f.datetime,E=Boolean(a.id||a.tempId);if("world_map"===a.displayType){const{data:e,title:s}=(0,w.JT)(t),i=[{seriesName:s,data:e}];return(0,F.BX)(b.Z,{loading:r,reloading:r,children:[(0,F.tZ)(W,{loading:r}),(0,F.tZ)(k,{autoHeightResize:E,children:(0,Z.Z)({value:this.chartComponent({series:i,autoHeightResize:E}),fixed:(0,F.tZ)(_.Z,{height:"200px",testId:"skeleton-ui"})})})]})}const A={left:0,top:0,selected:(0,w.RI)(m),formatter:e=>{const t=(0,D.hW)(e);if(null!==t){const s=(0,D.b8)(t);null!==s&&(e=s.toUpperCase())}return(0,D.by)(e)&&(e=(0,D.bQ)(e)),e},...n},C=a.queries[0]?.aggregates?.[0]??"count()",I=(0,D.GO)(C)?(0,D.vp)(C):C,L={autoHeightResize:E,grid:{left:0,right:4,top:"40px",bottom:l?j:0},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:(e,t)=>{const s=t?.split(":").pop()?.trim();return s?p?(0,R.CX)(e,p[s]):(0,R.CX)(e,(0,D.Px)(s)):(0,R.CX)(e,"number")}},yAxis:{axisLabel:{color:e.chartLabel,formatter:e=>{if(p){const t=1===new Set(Object.values(p)).size?p[I]:"number";return(0,R.x1)(e,t)}return(0,R.gu)(e,(0,D.Px)(I))}}}};return(0,F.tZ)(g.Z,{router:h,period:S,start:x,end:v,utc:O,showSlider:l,chartZoomOptions:c,children:t=>{if(i)return(0,F.tZ)(U,{children:(0,F.tZ)(T.FC,{color:"gray500",size:"lg"})});const a=new RegExp(`(?:.* : ${M}$)|^${M}$`),n=s?.some((e=>{let{seriesName:t}=e;return t&&t.match(a)})),d=s?e.charts.getColorPalette(s.length-(n?3:2)):[];n&&(d[d.length]=e.chartOther);const l=s?s.map(((e,t)=>{let s="";return void 0!==e.seriesName&&(s=(0,D.GO)(e.seriesName)?(0,D.vp)(e.seriesName):e.seriesName),{...e,seriesName:s,color:d[t]}})):[],c=l[0]?.data[0]?.name,p=l[0]?.data[l[0].data.length-1]?.name;return(0,F.BX)(b.Z,{loading:r,reloading:r,children:[(0,F.tZ)(W,{loading:r}),(0,F.tZ)(k,{autoHeightResize:E,noPadding:u,children:(0,Z.Z)({value:this.chartComponent({...t,...L,...o?{onDataZoom:(e,t)=>o({...e,seriesStart:c,seriesEnd:p},t)}:{},legend:A,series:l,onLegendSelectChanged:y}),fixed:(0,F.tZ)(_.Z,{height:"200px",testId:"skeleton-ui"})})})]})}})}}L.displayName="WidgetCardChart";const P=(0,o.b)(L),$=(0,r.Z)((e=>(0,F.tZ)(y.Z,{...e,maskBackgroundColor:"transparent"})),{target:"e1p214r6"})({name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"});function W(e){let{loading:t}=e;return t?(0,F.tZ)($,{visible:t,children:(0,F.tZ)(v.Z,{mini:!0})}):null}W.displayName="LoadingScreen";const N=(0,r.Z)((e=>{let{className:t}=e;return(0,F.tZ)(_.Z,{height:"200px",className:t})}),{target:"e1p214r5"})("background-color:",(e=>e.theme.surface300),";"),B=(0,r.Z)("div",{target:"e1p214r4"})({name:"af8mp8",styles:"height:100%;width:100%;overflow:hidden"}),z=(0,r.Z)("div",{target:"e1p214r3"})("line-height:1;display:inline-flex;flex:1;width:100%;min-height:0;font-size:32px;color:",(e=>e.theme.headingColor),";padding:",(0,O.D)(1)," ",(0,O.D)(3)," ",(0,O.D)(3)," ",(0,O.D)(3),";*{text-align:left!important;}"),k=(0,r.Z)("div",{target:"e1p214r2"})((e=>e.autoHeightResize&&"height: 100%;")," padding:",(e=>e.noPadding?"0":`0 ${(0,O.D)(3)} ${(0,O.D)(3)}`),";"),q=(0,r.Z)(f.Z,{target:"e1p214r1"})("margin-top:",(0,O.D)(1.5),";border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:none;"),U=(0,r.Z)(m.Z,{target:"e1p214r0"})("padding:",(0,O.D)(2),";")},"./app/views/dashboards/widgetCard/dashboardsMEPContext.tsx":(e,t,s)=>{s.d(t,{HH:()=>d,KC:()=>u,XA:()=>n,k:()=>l});var i=s("../node_modules/react/index.js"),r=s("./app/utils/performance/contexts/utils.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[o,n,d]=(0,r.n)({name:"DashboardsMEPContext"}),l=d.Consumer;function u(e){let{children:t}=e;const[s,r]=(0,i.useState)(void 0);return(0,a.tZ)(o,{value:{isMetricsData:s,setIsMetricsData:r},children:t})}u.displayName="DashboardsMEPProvider"},"./app/views/dashboards/widgetCard/genericWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Z:()=>b});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/cloneDeep.js"),o=s.n(a),n=s("../node_modules/lodash/isEqual.js"),d=s.n(n),l=s("../node_modules/lodash/omit.js"),u=s.n(l),c=s("./app/components/organizations/pageFilters/utils.tsx"),p=s("./app/locale.tsx"),g=s("./app/views/dashboards/utils.tsx"),m=s("./app/views/dashboards/types.tsx");function h(e){let t="";return t=e===m.FO.TABLE?"api.dashboards.tablewidget":e===m.FO.BIG_NUMBER?"api.dashboards.bignumberwidget":e===m.FO.WORLD_MAP?"api.dashboards.worldmapwidget":`api.dashboards.widget.${e}-chart`,t}class f extends r.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{loading:!0,queryFetchID:void 0,errorMessage:void 0,timeseriesResults:void 0,rawResults:void 0,tableResults:void 0,pageLinks:void 0,timeseriesResultsTypes:void 0}),(0,i.Z)(this,"_isMounted",!1)}componentDidMount(){this._isMounted=!0,this.props.loading||this.fetchData()}componentDidUpdate(e){const{selection:t,widget:s,cursor:i,organization:r,config:a,customDidUpdateComparator:o}=this.props,[n,l]=e.widget.queries.map((e=>(e.aggregates=e.aggregates.filter((e=>!!e)),e.columns=e.columns.filter((e=>!!e)),e))).reduce(((e,t)=>{let[s,i]=e,{name:r,...a}=t;return s.push(r),a.fields=a.fields?.filter((e=>!!e))??[],a=u()(a,"fieldAliases"),i.push(a),[s,i]}),[[],[]]),[p,g]=s.queries.map((e=>(e.aggregates=e.aggregates.filter((e=>!!e&&"equation|"!==e)),e.columns=e.columns.filter((e=>!!e&&"equation|"!==e)),e))).reduce(((e,t)=>{let[s,i]=e,{name:r,...a}=t;return s.push(r),a.fields=a.fields?.filter((e=>!!e))??[],a=u()(a,"fieldAliases"),i.push(a),[s,i]}),[[],[]]);(o?!o(e,this.props):s.limit===e.widget.limit&&d()(s.displayType,e.widget.displayType)&&d()(s.interval,e.widget.interval)&&d()(new Set(g),new Set(l))&&d()(this.props.dashboardFilters,e.dashboardFilters)&&(0,c.WO)(t,e.selection)&&i===e.cursor)?this.state.loading||d()(n,p)||this.state.rawResults?.length!==s.queries.length||this.setState((e=>{const t=s.queries.reduce(((t,s,i)=>t.concat(a.transformSeries(e.rawResults[i],s,r))),[]);return{...e,timeseriesResults:t}})):this.fetchData()}componentWillUnmount(){this._isMounted=!1}applyDashboardFilters(e){const{dashboardFilters:t}=this.props,s=(0,g.DF)(t);return e.queries.forEach((e=>{e.conditions=e.conditions+(""===s?"":` ${s}`)})),e}async fetchTableData(e){const{widget:t,limit:s,config:i,api:r,organization:a,selection:n,cursor:d,afterFetchTableData:l,onDataFetched:u,mepSetting:c}=this.props,g=this.applyDashboardFilters(o()(t)),f=await Promise.all(g.queries.map((e=>{let t=s??m.$V,o=i.getTableRequest;if(g.displayType===m.FO.WORLD_MAP&&(t=void 0,o=i.getWorldMapRequest),!o)throw new Error((0,p.t)("This display type is not supported by the selected dataset."));return o(r,e,a,n,t,d,h(g.displayType),c)})));let b,y,w=[];f.forEach(((e,t)=>{let[s,r,o]=e;y=l?.(s,o)??{};const d=i.transformTable(s,g.queries[0],a,n);d.title=g.queries[t]?.name??"",w=[...w,d],b=(o?.getResponseHeader("Link")||o?.getResponseHeader("link"))??void 0})),this._isMounted&&this.state.queryFetchID===e&&(u?.({tableResults:w,pageLinks:b,...y}),this.setState({tableResults:w,pageLinks:b}))}async fetchSeriesData(e){const{widget:t,config:s,api:i,organization:r,selection:a,afterFetchSeriesData:n,onDataFetched:d,mepSetting:l}=this.props,u=this.applyDashboardFilters(o()(t)),c=await Promise.all(u.queries.map(((e,t)=>s.getSeriesRequest(i,u,t,r,a,h(u.displayType),l)))),p=o()(this.state.rawResults)??[],g=[];c.forEach(((e,t)=>{let[i]=e;n?.(i),p[t]=i;const a=s.transformSeries(i,u.queries[t],r);a.forEach(((e,s)=>{g[t*a.length+s]=e}))}));const m=s.getSeriesResultType?.(c[0][0],u.queries[0]);this._isMounted&&this.state.queryFetchID===e&&(d?.({timeseriesResults:g,timeseriesResultsTypes:m}),this.setState({timeseriesResults:g,rawResults:p,timeseriesResultsTypes:m}))}async fetchData(){const{widget:e}=this.props,t=Symbol("queryFetchID");this.setState({loading:!0,tableResults:void 0,timeseriesResults:void 0,errorMessage:void 0,queryFetchID:t});try{[m.FO.TABLE,m.FO.BIG_NUMBER,m.FO.WORLD_MAP].includes(e.displayType)?await this.fetchTableData(t):await this.fetchSeriesData(t)}catch(e){this._isMounted&&this.setState({errorMessage:e?.responseJSON?.detail||e?.message||(0,p.t)("An unknown error occurred.")})}finally{this._isMounted&&this.setState({loading:!1})}}render(){const{children:e}=this.props,{loading:t,tableResults:s,timeseriesResults:i,errorMessage:r,pageLinks:a,timeseriesResultsTypes:o}=this.state;return e({loading:t,tableResults:s,timeseriesResults:i,errorMessage:r,pageLinks:a,timeseriesResultsTypes:o})}}f.displayName="GenericWidgetQueries";const b=f},"./app/views/dashboards/widgetCard/index.tsx":(e,t,s)=>{s.d(t,{f0:()=>G,_:()=>K,ZP:()=>Y});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("../node_modules/react/index.js"),o=s("../node_modules/react-lazyload/lib/index.js"),n=s("./app/components/alert.tsx"),d=s("./app/components/button.tsx"),l=s("./app/components/charts/errorPanel.tsx"),u=s("./app/components/charts/styles.tsx"),c=s("./app/components/errorBoundary.tsx"),p=s("./app/components/links/externalLink.tsx"),g=s("./app/components/panels/index.tsx"),m=s("./app/components/placeholder.tsx"),h=s("./app/components/searchSyntax/parser.tsx"),f=s("./app/components/tooltip.tsx"),b=s("./app/icons/index.tsx"),y=s("./app/locale.tsx"),w=s("./app/styles/space.tsx"),x=s("./app/utils/dates.tsx"),v=s("./app/utils/discover/fields.tsx"),_=s("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),S=s("./app/utils/performanceForSentry/index.tsx"),T=s("./app/utils/withApi.tsx"),O=s("./app/utils/withOrganization.tsx"),R=s("./app/utils/withPageFilters.tsx"),E=s("./app/utils/withSentryRouter.tsx"),D=s("./app/views/dashboards/dashboard.tsx"),Z=s("./app/views/dashboards/types.tsx"),A=s("./app/views/dashboards/widgetBuilder/utils.tsx"),C=s("./app/views/dashboards/widgetCard/dashboardsMEPContext.tsx"),I=s("./app/views/dashboards/widgetCard/widgetCardChartContainer.tsx"),F=(s("../node_modules/core-js/modules/es.array.push.js"),s("./app/actionCreators/modal.tsx")),M=s("./app/components/confirm.tsx"),j=s("./app/components/dropdownMenu/index.tsx"),L=s("./app/components/modals/widgetViewerModal/utils.tsx"),P=s("./app/components/tag.tsx"),$=s("./app/utils/analytics.tsx"),W=s("./app/views/dashboards/utils.tsx"),N=s("./app/views/dashboards/widgetViewer/widgetViewerContext.tsx"),B=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function z(e){let{organization:t,selection:s,widget:i,widgetLimitReached:r,onDelete:a,onDuplicate:o,onEdit:n,showContextMenu:l,isPreview:u,router:c,location:p,index:g,seriesData:m,tableData:h,pageLinks:f,totalIssuesCount:w,seriesResultsType:x}=e;const{isMetricsData:v}=(0,C.XA)();if(!l)return null;const S=[],T=[],O=e=>{(0,L.X)(p.pathname)||c.push({pathname:`${p.pathname}${p.pathname.endsWith("/")?"":"/"}widget/${e}/`,query:p.query})};if(u)return(0,B.tZ)(N.M.Consumer,{children:e=>{let{setData:s}=e;return(0,B.tZ)(_.nP,{children:e=>(0,B.BX)(q,{children:[!t.features.includes("performance-mep-bannerless-ui")&&(t.features.includes("dashboards-mep")||t.features.includes("mep-rollout-flag"))&&!1===v&&e&&e.metricSettingState!==_.oR.transactionsOnly&&(0,B.tZ)(V,{tooltipText:(0,y.t)("This widget is only applicable to indexed events."),children:(0,y.t)("Indexed")}),(0,B.tZ)(U,{items:[{key:"preview",label:(0,y.t)("This is a preview only. To edit, you must add this dashboard.")}],triggerProps:{"aria-label":(0,y.t)("Widget actions"),size:"xs",borderless:!0,showChevron:!1,icon:(0,B.tZ)(b.YR,{direction:"down",size:"sm"})},position:"bottom-end",disabledKeys:[...T,"preview"]}),(0,B.tZ)(d.zx,{"aria-label":(0,y.t)("Open Widget Viewer"),borderless:!0,size:"xs",icon:(0,B.tZ)(b.qp,{size:"xs"}),onClick:()=>{(m||h)&&s({seriesData:m,tableData:h,pageLinks:f,totalIssuesCount:w,seriesResultsType:x}),O(g)}})]})})}});if(t.features.includes("discover-basic")&&i.widgetType===Z.l9.DISCOVER&&i.queries.length){const e=(0,W.z1)(i,s,t,0,v);S.push({key:"open-in-discover",label:(0,y.t)("Open in Discover"),to:1===i.queries.length?e:void 0,onAction:()=>{1!==i.queries.length?((0,$.Gi)("dashboards_views.query_selector.opened",{organization:t,widget_type:i.displayType}),(0,F.openDashboardWidgetQuerySelectorModal)({organization:t,widget:i,isMetricsData:v})):(0,$.Gi)("dashboards_views.open_in_discover.opened",{organization:t,widget_type:i.displayType})}})}if(i.widgetType===Z.l9.ISSUE){const e=(0,W.hS)(i,s,t);S.push({key:"open-in-issues",label:(0,y.t)("Open in Issues"),to:e})}return t.features.includes("dashboards-edit")&&(S.push({key:"duplicate-widget",label:(0,y.t)("Duplicate Widget"),onAction:()=>o?.()}),r&&T.push("duplicate-widget"),S.push({key:"edit-widget",label:(0,y.t)("Edit Widget"),onAction:()=>n?.()}),S.push({key:"delete-widget",label:(0,y.t)("Delete Widget"),priority:"danger",onAction:()=>{(0,M._)({message:(0,y.t)("Are you sure you want to delete this widget?"),priority:"danger",onConfirm:()=>a?.()})}})),S.length?(0,B.tZ)(N.M.Consumer,{children:e=>{let{setData:s}=e;return(0,B.tZ)(_.nP,{children:e=>(0,B.BX)(q,{children:[!t.features.includes("performance-mep-bannerless-ui")&&(t.features.includes("dashboards-mep")||t.features.includes("mep-rollout-flag"))&&!1===v&&e&&e.metricSettingState!==_.oR.transactionsOnly&&(0,B.tZ)(V,{tooltipText:(0,y.t)("This widget is only applicable to indexed events."),children:(0,y.t)("Indexed")}),(0,B.tZ)(U,{items:S,triggerProps:{"aria-label":(0,y.t)("Widget actions"),size:"xs",borderless:!0,showChevron:!1,icon:(0,B.tZ)(b.YR,{direction:"down",size:"sm"})},position:"bottom-end",disabledKeys:[...T]}),(0,B.tZ)(d.zx,{"aria-label":(0,y.t)("Open Widget Viewer"),borderless:!0,size:"xs",icon:(0,B.tZ)(b.qp,{size:"xs"}),onClick:()=>{s({seriesData:m,tableData:h,pageLinks:f,totalIssuesCount:w,seriesResultsType:x}),O(i.id??g)}})]})})}}):null}z.displayName="WidgetCardContextMenu";const k=z,q=(0,r.Z)("div",{target:"ec9t0g62"})("display:flex;align-items:center;height:",(0,w.D)(3),";margin-left:",(0,w.D)(1),";gap:",(0,w.D)(.25),";"),U=(0,r.Z)(j.h,{target:"ec9t0g61"})({name:"1vt4q1p",styles:"display:flex;&>button{z-index:auto;}"}),V=(0,r.Z)(P.Z,{target:"ec9t0g60"})("margin-right:",(0,w.D)(.5),";"),H=new Date("2023-01-12"),G=(0,B.tZ)(g.aU,{type:"warning",children:(0,y.t)("session.duration is no longer being recorded as of %s. Data in this widget may be incomplete.",(0,x.L0)(H,"MMM D, YYYY"))}),Q=["error.handled","error.unhandled","error.mechanism","error.type","error.value"];class X extends a.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{}),(0,i.Z)(this,"setData",(e=>{let{tableResults:t,timeseriesResults:s,totalIssuesCount:i,pageLinks:r,timeseriesResultsTypes:a}=e;this.setState({seriesData:s,tableData:t,totalIssuesCount:i,pageLinks:r,seriesResultsType:a})}))}renderToolbar(){const{onEdit:e,onDelete:t,onDuplicate:s,draggableProps:i,hideToolbar:r,isEditing:a,isMobile:o}=this.props;return a?(0,B.tZ)(ee,{children:(0,B.BX)(te,{style:{visibility:r?"hidden":"visible"},children:[!o&&(0,B.tZ)(se,{size:"xs","aria-label":(0,y.t)("Drag Widget"),icon:(0,B.tZ)(b.LS,{}),borderless:!0,className:D.re,...i?.listeners,...i?.attributes}),(0,B.tZ)(d.zx,{"data-test-id":"widget-edit","aria-label":(0,y.t)("Edit Widget"),size:"xs",borderless:!0,onClick:e,icon:(0,B.tZ)(b.yl,{})}),(0,B.tZ)(d.zx,{"aria-label":(0,y.t)("Duplicate Widget"),size:"xs",borderless:!0,onClick:s,icon:(0,B.tZ)(b.vU,{})}),(0,B.tZ)(d.zx,{"data-test-id":"widget-delete","aria-label":(0,y.t)("Delete Widget"),borderless:!0,size:"xs",onClick:t,icon:(0,B.tZ)(b.Fz,{})})]})}):null}renderContextMenu(){const{widget:e,selection:t,organization:s,showContextMenu:i,isPreview:r,widgetLimitReached:a,onEdit:o,onDuplicate:n,onDelete:d,isEditing:l,router:u,location:c,index:p}=this.props,{seriesData:g,tableData:m,pageLinks:h,totalIssuesCount:f,seriesResultsType:b}=this.state;return l?null:(0,B.tZ)(k,{organization:s,widget:e,selection:t,showContextMenu:i,isPreview:r,widgetLimitReached:a,onDuplicate:n,onEdit:o,onDelete:d,router:u,location:c,index:p,seriesData:g,seriesResultsType:b,tableData:m,pageLinks:h,totalIssuesCount:f})}render(){const{api:e,organization:t,selection:s,widget:i,isMobile:r,renderErrorMessage:n,tableItemLimit:d,windowWidth:l,noLazyLoad:u,showStoredAlert:g,noDashboardsMEPProvider:m,dashboardFilters:w,isWidgetInvalid:x,location:T}=this.props;if(i.displayType===Z.FO.TOP_N){const e=i.queries.map((e=>({...e,aggregates:e.aggregates.length?[e.aggregates[e.aggregates.length-1]]:[]})));i.queries=e,i.limit=A._k}const O=i.queries.some((e=>e.aggregates.some((e=>e.includes("session.duration"))))),R=i.queries.some((e=>{let{columns:t,aggregates:s,conditions:i}=e;return Q.some((e=>t.includes(e)||s.some((t=>(0,v.dL)(t)?.arguments.includes(e)))||(0,h.UG)(i)?.some((t=>t.key?.value===e))))}));return(0,B.tZ)(c.Z,{customComponent:(0,B.tZ)(J,{children:(0,y.t)("Error loading widget data")}),children:(E=(0,B.BX)(a.Fragment,{children:[(0,B.tZ)(S.oF,{id:"DashboardList-FirstWidgetCard",hasData:((this.state.tableData?.length||this.state.seriesData?.length)??0)>0,disabled:0!==Number(this.props.index),children:(0,B.BX)(K,{isDragging:!1,children:[(0,B.BX)(re,{children:[(0,B.BX)(ne,{children:[(0,B.tZ)(f.u,{title:i.title,containerDisplayMode:"grid",showOnlyOnOverflow:!0,children:(0,B.tZ)(ie,{children:i.title})}),(0,B.tZ)(C.k,{children:e=>{let{}=e;return null}})]}),this.renderContextMenu()]}),O&&G,x?(0,B.BX)(a.Fragment,{children:[n?.("Widget query condition is invalid."),(0,B.tZ)(oe,{children:(0,B.tZ)(b.FC,{color:"gray500",size:"lg"})})]}):u?(0,B.tZ)(I.Z,{location:T,api:e,organization:t,selection:s,widget:i,isMobile:r,renderErrorMessage:n,tableItemLimit:d,windowWidth:l,onDataFetched:this.setData,dashboardFilters:w}):(0,B.tZ)(o.ZP,{once:!0,resize:!0,height:200,children:(0,B.tZ)(I.Z,{location:T,api:e,organization:t,selection:s,widget:i,isMobile:r,renderErrorMessage:n,tableItemLimit:d,windowWidth:l,onDataFetched:this.setData,dashboardFilters:w})}),this.renderToolbar()]})}),!t.features.includes("performance-mep-bannerless-ui")&&(t.features.includes("dashboards-mep")||t.features.includes("mep-rollout-flag"))&&(0,B.tZ)(_.nP,{children:e=>(0,B.tZ)(C.k,{children:t=>{let{isMetricsData:s}=t;return g&&!1===s&&i.widgetType===Z.l9.DISCOVER&&e&&e.metricSettingState!==_.oR.transactionsOnly&&!R?(0,B.tZ)(ae,{showIcon:!0,children:(0,y._N)("Your selection is only applicable to [indexedData: indexed event data]. We've automatically adjusted your results.",{indexedData:(0,B.tZ)(p.Z,{href:"https://docs.sentry.io/product/dashboards/widget-builder/#errors--transactions"})})}):null}})})]}),m?E:(0,B.tZ)(C.KC,{children:E}))});var E}}X.displayName="WidgetCard";const Y=(0,T.Z)((0,O.Z)((0,R.Z)((0,E.Z)(X)))),J=(0,r.Z)(m.Z,{target:"epl41xb9"})("display:flex;align-items:center;justify-content:center;background-color:",(e=>e.theme.alert.error.backgroundLight),";border:1px solid ",(e=>e.theme.alert.error.border),";color:",(e=>e.theme.alert.error.textLight),";border-radius:",(e=>e.theme.borderRadius),";margin-bottom:",(0,w.D)(2),";"),K=(0,r.Z)(g.s_,{shouldForwardProp:e=>"isDragging"!==e,target:"epl41xb8"})("margin:0;visibility:",(e=>e.isDragging?"hidden":"visible"),";height:100%;min-height:96px;display:flex;flex-direction:column;"),ee=(0,r.Z)("div",{target:"epl41xb7"})("position:absolute;top:0;left:0;z-index:2;width:100%;height:100%;display:flex;justify-content:flex-end;align-items:flex-start;background-color:",(e=>e.theme.overlayBackgroundAlpha),";border-radius:calc(",(e=>e.theme.panelBorderRadius)," - 1px);"),te=(0,r.Z)("div",{target:"epl41xb6"})("display:flex;margin:",(0,w.D)(1),";touch-action:none;"),se=(0,r.Z)(d.zx,{target:"epl41xb5"})({name:"1fgcczm",styles:"cursor:grab"}),ie=(0,r.Z)(u.Gh,{target:"epl41xb4"})((e=>e.theme.overflowEllipsis),";font-weight:normal;"),re=(0,r.Z)("div",{target:"epl41xb3"})("padding:",(0,w.D)(2)," ",(0,w.D)(1)," 0 ",(0,w.D)(3),";min-height:36px;width:100%;display:flex;align-items:center;justify-content:space-between;"),ae=(0,r.Z)(n.bZ,{target:"epl41xb2"})("margin-top:",(0,w.D)(1),";margin-bottom:0;"),oe=(0,r.Z)(l.Z,{target:"epl41xb1"})("padding:",(0,w.D)(2),";"),ne=(0,r.Z)("div",{target:"epl41xb0"})("display:flex;gap:",(0,w.D)(1),";align-items:center;")},"./app/views/dashboards/widgetCard/issueWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var i=s("../node_modules/react/index.js"),r=s("./app/stores/memberListStore.tsx"),a=s("./app/utils/getDynamicText.tsx"),o=s("./app/views/dashboards/datasetConfig/issues.tsx"),n=s("./app/views/dashboards/widgetCard/genericWidgetQueries.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){let{children:t,api:s,organization:l,selection:u,widget:c,cursor:p,limit:g,dashboardFilters:m,onDataFetched:h}=e;const[f,b]=(0,i.useState)(!1);(0,i.useEffect)((()=>{b(!r.Z.state.loading);const e=r.Z.listen((()=>{b(!r.Z.state.loading)}),void 0);return()=>e()}),[]);const y=o.f;return(0,a.Z)({value:(0,d.tZ)(n.Z,{config:y,api:s,organization:l,selection:u,widget:c,cursor:p,limit:g,dashboardFilters:m,onDataFetched:h,afterFetchTableData:(e,t)=>({totalIssuesCount:t?.getResponseHeader("X-Hits")??void 0}),children:e=>{let{loading:s,...i}=e;return t({loading:s||!f,...i})}}),fixed:(0,d.tZ)("div",{})})}},"./app/views/dashboards/widgetCard/releaseWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Vl:()=>R,ZP:()=>D,gp:()=>O,nD:()=>S});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/cloneDeep.js"),o=s.n(a),n=s("../node_modules/lodash/isEqual.js"),d=s.n(n),l=s("../node_modules/lodash/omit.js"),u=s.n(l),c=s("../node_modules/lodash/trimStart.js"),p=s.n(c),g=s("./app/actionCreators/indicator.tsx"),m=s("./app/components/organizations/pageFilters/utils.tsx"),h=s("./app/locale.tsx"),f=s("./app/utils/discover/fields.tsx"),b=s("./app/utils/discover/types.tsx"),y=s("./app/views/dashboards/datasetConfig/releases.tsx"),w=s("./app/views/dashboards/types.tsx"),x=s("./app/views/dashboards/widgetBuilder/releaseWidget/fields.tsx"),v=s("./app/views/dashboards/widgetCard/genericWidgetQueries.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function S(e){return x.Mg[e]??e}function T(e){let t="";const s=[];t+="release:["+e[0].version,s.push(e[0].version);for(let i=1;i<e.length;i++)t+=","+e[i].version,s.push(e[i].version);return t+="]",e.length<10?{releaseQueryString:t,releasesUsed:s}:e.length>10&&t.length>1500?T(e.slice(0,-10)):{releaseQueryString:t,releasesUsed:s}}function O(e,t,s){const i=e.map(f.hr),r=i.filter((e=>Object.values(x.Xg).includes(e))),a=[],o=p()(t,"-"),n=x.d2.includes(o)||s||"release"===o;return!o||n||e.includes(o)||a.includes(o)||a.push(o),s?(r.forEach((e=>{const t=e.match(x.$4);t&&("user"!==t[2]||i.includes("count_unique(user)")||(a.push("count_unique(user)"),i.push("count_unique(user)")),"session"!==t[2]||i.includes("sum(session)")||(a.push("sum(session)"),i.push("sum(session)")))})),{aggregates:i,derivedStatusFields:r,injectedFields:a}):{aggregates:i,derivedStatusFields:r,injectedFields:a}}function R(e){const t=!e.columns.includes("session.status"),s=p()(e.orderby,"-");return t&&"release"===s}class E extends r.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{loading:!0,errorMessage:void 0,releases:void 0}),(0,i.Z)(this,"config",y.u$),(0,i.Z)(this,"_isMounted",!1),(0,i.Z)(this,"fetchReleases",(async()=>{this.setState({loading:!0,errorMessage:void 0});const{selection:e,api:t,organization:s}=this.props,{environments:i,projects:r}=e;try{const e=await t.requestPromise(`/organizations/${s.slug}/releases/`,{method:"GET",data:{sort:"date",project:r,per_page:50,environment:i}});if(!this._isMounted)return;this.setState({releases:e,loading:!1})}catch(e){if(!this._isMounted)return;const t=e.responseJSON?e.responseJSON.error:(0,h.t)("Error sorting by releases");this.setState({errorMessage:t,loading:!1}),(0,g.Iw)(t)}})),(0,i.Z)(this,"customDidUpdateComparator",((e,t)=>{const{loading:s,limit:i,widget:r,cursor:a,organization:o,selection:n,dashboardFilters:l}=t,c=["queries","title","id","layout","tempId","widgetType"],p=["name","fields","aggregates","columns"];return!(i===e.limit&&o.slug===e.organization.slug&&d()(l,e.dashboardFilters)&&(0,m.WO)(n,e.selection)&&d()(u()(r,c),u()(e.widget,c))&&d()(r.queries.map((e=>u()(e,p))),e.widget.queries.map((e=>u()(e,p))))&&d()(r.queries.flatMap((e=>e.fields?.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.fields?.filter((e=>!!e)))))&&d()(r.queries.flatMap((e=>e.aggregates.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.aggregates.filter((e=>!!e)))))&&d()(r.queries.flatMap((e=>e.columns.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.columns.filter((e=>!!e)))))&&s===e.loading&&a===e.cursor)})),(0,i.Z)(this,"transformWidget",(e=>{const{releases:t}=this.state,s=o()(e),i=R(s.queries[0]),r=s.queries[0].orderby.startsWith("-"),a=s.queries[0].columns.includes("session.status");let n="";const d=[];if(i&&(t&&1===t.length&&(n+=`release:${t[0].version}`,d.push(t[0].version)),t&&t.length>1)){const{releaseQueryString:e,releasesUsed:s}=T(t);n+=e,d.push(...s),r||d.reverse()}return a||s.queries.forEach((e=>{e.conditions=e.conditions+(""===n?"":` ${n}`)})),s})),(0,i.Z)(this,"afterFetchData",(e=>{const{widget:t}=this.props,{releases:s}=this.state,i=t.queries[0].orderby.startsWith("-"),r=[];if(R(t.queries[0])&&(s&&1===s.length&&r.push(s[0].version),s&&s.length>1)){const{releasesUsed:e}=T(s);r.push(...e),i||r.reverse()}r.length&&(e.groups.sort((function(e,t){const s=e.by.release,i=t.by.release;return r.indexOf(s)-r.indexOf(i)})),e.groups=e.groups.slice(0,this.limit))}))}componentDidMount(){this._isMounted=!0,R(this.props.widget.queries[0])&&this.fetchReleases()}componentWillUnmount(){this._isMounted=!1}get limit(){const{limit:e}=this.props;switch(this.props.widget.displayType){case w.FO.TOP_N:return b.hY;case w.FO.TABLE:return e??w.$V;case w.FO.BIG_NUMBER:return 1;default:return e??20}}render(){const{api:e,children:t,organization:s,selection:i,widget:r,cursor:a,dashboardFilters:o,onDataFetched:n}=this.props,d=y.u$;return(0,_.tZ)(v.Z,{config:d,api:e,organization:s,selection:i,widget:this.transformWidget(r),dashboardFilters:o,cursor:a,limit:this.limit,onDataFetched:n,loading:R(r.queries[0])?!this.state.releases:void 0,customDidUpdateComparator:this.customDidUpdateComparator,afterFetchTableData:this.afterFetchData,afterFetchSeriesData:this.afterFetchData,children:e=>{let{errorMessage:s,...i}=e;return t({errorMessage:this.state.errorMessage??s,...i})}})}}E.displayName="ReleaseWidgetQueries";const D=E},"./app/views/dashboards/widgetCard/widgetCardChartContainer.tsx":(e,t,s)=>{s.d(t,{b:()=>E,Z:()=>D});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),a=s("./app/components/charts/transparentLoadingMask.tsx"),o=s("./app/components/loadingIndicator.tsx"),n=s("./app/utils/useLocation.tsx"),d=s("./app/utils/useRouter.tsx"),l=s("./app/views/dashboards/types.tsx"),u=s("./app/views/dashboards/widgetCard/chart.tsx"),c=s("./app/components/charts/errorPanel.tsx"),p=s("./app/components/charts/simpleTableChart.tsx"),g=s("./app/components/placeholder.tsx"),m=s("./app/icons/index.tsx"),h=s("./app/styles/space.tsx"),f=s("./app/utils.tsx"),b=s("./app/views/dashboards/utils.tsx"),y=s("./app/views/dashboards/datasetConfig/base.tsx"),w=s("./app/views/dashboards/widgetBuilder/issueWidget/fields.tsx"),x=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function v(e){let{organization:t,selection:s,widget:i,errorMessage:r,loading:a,transformedResults:o,location:n}=e;const d=(0,y.v)(l.l9.ISSUE);if(r)return(0,x.tZ)(c.Z,{children:(0,x.tZ)(m.FC,{color:"gray500",size:"lg"})});if(a)return(0,x.tZ)(_,{height:"200px"});const u=i.queries[0],p=(0,f.ri)(u.fields)?u.fields:[...u.columns,...u.aggregates],g=u.fieldAliases??[],h=(0,b.tT)(i.title,i.queries[0],s,i.displayType);return(0,x.tZ)(S,{location:n,title:"",eventView:h,fields:p,fieldAliases:g,loading:a,metadata:w.$L,data:o,organization:t,getCustomFieldRenderer:d.getCustomFieldRenderer,fieldHeaderMap:d.fieldHeaderMap,stickyHeaders:!0})}v.displayName="IssueWidgetCard";const _=(0,i.Z)(g.Z,{target:"exqrcis1"})("background-color:",(e=>e.theme.surface300),";"),S=(0,i.Z)(p.Z,{target:"exqrcis0"})("margin-top:",(0,h.D)(1.5),";border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:none;");var T=s("./app/views/dashboards/widgetCard/issueWidgetQueries.tsx"),O=s("./app/views/dashboards/widgetCard/releaseWidgetQueries.tsx"),R=s("./app/views/dashboards/widgetCard/widgetQueries.tsx");function E(e){let{api:t,organization:s,selection:i,widget:a,dashboardFilters:o,isMobile:c,renderErrorMessage:p,tableItemLimit:g,windowWidth:m,onZoom:h,onLegendSelectChanged:f,legendOptions:b,expandNumbers:y,onDataFetched:w,showSlider:_,noPadding:S,chartZoomOptions:E}=e;const D=(0,n.T)(),Z=(0,d.Z)();return a.widgetType===l.l9.ISSUE?(0,x.tZ)(T.Z,{api:t,organization:s,widget:a,selection:i,limit:g,onDataFetched:w,dashboardFilters:o,children:e=>{let{tableResults:t,errorMessage:o,loading:n}=e;return(0,x.BX)(r.Fragment,{children:["function"==typeof p?p(o):null,(0,x.tZ)(A,{loading:n}),(0,x.tZ)(v,{transformedResults:t?.[0].data??[],loading:n,errorMessage:o,widget:a,organization:s,location:D,selection:i})]})}}):a.widgetType===l.l9.RELEASE?(0,x.tZ)(O.ZP,{api:t,organization:s,widget:a,selection:i,limit:a.limit??g,onDataFetched:w,dashboardFilters:o,children:e=>{let{tableResults:t,timeseriesResults:o,errorMessage:n,loading:d}=e;return(0,x.BX)(r.Fragment,{children:["function"==typeof p?p(n):null,(0,x.tZ)(u.Z,{timeseriesResults:o,tableResults:t,errorMessage:n,loading:d,location:D,widget:a,selection:i,router:Z,organization:s,isMobile:c,windowWidth:m,expandNumbers:y,onZoom:h,showSlider:_,noPadding:S,chartZoomOptions:E})]})}}):(0,x.tZ)(R.ZP,{api:t,organization:s,widget:a,selection:i,limit:g,onDataFetched:w,dashboardFilters:o,children:e=>{let{tableResults:t,timeseriesResults:o,errorMessage:n,loading:d,timeseriesResultsTypes:l}=e;return(0,x.BX)(r.Fragment,{children:["function"==typeof p?p(n):null,(0,x.tZ)(u.Z,{timeseriesResults:o,tableResults:t,errorMessage:n,loading:d,location:D,widget:a,selection:i,router:Z,organization:s,isMobile:c,windowWidth:m,onZoom:h,onLegendSelectChanged:f,legendOptions:b,expandNumbers:y,showSlider:_,noPadding:S,chartZoomOptions:E,timeseriesResultsTypes:l})]})}})}E.displayName="WidgetCardChartContainer";const D=E,Z=(0,i.Z)((e=>(0,x.tZ)(a.Z,{...e,maskBackgroundColor:"transparent"})),{target:"e176tkw80"})({name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"});function A(e){let{loading:t}=e;return t?(0,x.tZ)(Z,{visible:t,children:(0,x.tZ)(o.Z,{mini:!0})}):null}A.displayName="LoadingScreen"},"./app/views/dashboards/widgetCard/widgetQueries.tsx":(e,t,s)=>{s.d(t,{FN:()=>g,ZP:()=>f,vD:()=>m}),s("../node_modules/core-js/modules/es.array.push.js");var i=s("../node_modules/react/index.js"),r=s("../node_modules/lodash/omit.js"),a=s.n(r),o=(s("./app/components/charts/utils.tsx"),s("./app/utils/discover/fieldRenderers.tsx")),n=s("./app/utils/discover/fields.tsx"),d=s("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),l=s("./app/views/dashboards/datasetConfig/errorsAndTransactions.tsx"),u=s("./app/views/dashboards/widgetCard/dashboardsMEPContext.tsx"),c=s("./app/views/dashboards/widgetCard/genericWidgetQueries.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function g(e,t,s){const i=e.meta?.units?.[(0,n.LY)(s)],r=(i&&(o.a_[i]??o.en[i]))??1;return{seriesName:t,data:e?.data?.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)*r}}))??[]}}function m(e,t){const s=[];return Object.keys(e).forEach((i=>{Object.keys(a()(e[i],"order")).forEach((r=>{const a=`${i} : ${r}`,o=t?`${t} > ${a}`:a,n=e[i][r];s.push([e[i].order||0,g(n,o,a)])}))})),s}function h(e){let{api:t,children:s,organization:r,selection:a,widget:o,dashboardFilters:n,cursor:g,limit:m,onDataFetched:h}=e;const f=l.g,b=(0,i.useContext)(u.HH),y=(0,d.Eg)();let w;b&&(w=b.setIsMetricsData);const x=[],v=[];return(0,p.tZ)(c.Z,{config:f,api:t,organization:r,selection:a,widget:o,cursor:g,limit:m,dashboardFilters:n,onDataFetched:h,afterFetchSeriesData:e=>{e.data?void 0!==e.isMetricsData&&x.push(e.isMetricsData):Object.keys(e).forEach((t=>{const s=e[t];void 0!==s.isMetricsData&&x.push(s.isMetricsData)})),w?.(!x.includes(!1))},afterFetchTableData:e=>{void 0!==e.meta?.isMetricsData&&v.push(e.meta.isMetricsData),w?.(!v.includes(!1))},mepSetting:y.metricSettingState,children:s})}h.displayName="WidgetQueries";const f=h},"./app/views/dashboards/widgetViewer/widgetViewerContext.tsx":(e,t,s)=>{s.d(t,{M:()=>i});const i=(0,s("../node_modules/react/index.js").createContext)({setData:()=>{}})},"./app/views/performance/landing/widgets/utils.tsx":(e,t,s)=>{s.d(t,{CJ:()=>n,I2:()=>c,gM:()=>l,hD:()=>y,rp:()=>h,zM:()=>f,zS:()=>u});var i=s("./app/utils.tsx"),r=s("./app/utils/localStorage.tsx"),a=s("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),o=s("./app/views/performance/landing/widgets/widgetDefinitions.tsx");const n="app"==s.j?["children","organization","yAxis","period","start","end","environment","project","referrer"]:null,d={};function l(e,t){let s={};const r=d;return(e.shouldQueryProvideMEPAutoParams||t)&&(s={...s,...r,dataset:"metricsEnhanced"},t)?s:(e.shouldQueryProvideMEPTransactionParams&&(s={...s,...r,dataset:"discover"}),e.shouldQueryProvideMEPMetricParams&&(s={...s,...r,dataset:"metrics"}),(0,i.z)(s)?void 0:s)}const u=[o.s.MOST_RELATED_ERRORS,o.s.MOST_RELATED_ISSUES];function c(e,t){if(!u.includes(t))return l(e)}const p="landing-chart-container",g=(e,t,s)=>`landing-chart-container#${t}#${s}#${e}`;function m(){return JSON.parse(r.Z.getItem(p)||"{}")}const h=(e,t,s,i,r)=>{if(r)return i;const a=g(e,s,t),n=m(),d=n?.[a];return d&&Object.values(o.s).includes(d)?d:i},f=(e,t,s,i)=>{const a=g(e,s,t),o=m();o[a]=i,function(e){r.Z.setItem(p,JSON.stringify(e))}(o)},b=[o.s.DURATION_HISTOGRAM,o.s.FCP_HISTOGRAM,o.s.LCP_HISTOGRAM,o.s.FID_HISTOGRAM];function y(e,t,s){return!(0,a.gp)(e)||e.features.includes("performance-mep-reintroduce-histograms")||s.metricSettingState===a.oR.transactionsOnly?t:t.filter((e=>!b.includes(e)))}},"./app/views/performance/landing/widgets/widgetDefinitions.tsx":(e,t,s)=>{s.d(t,{W:()=>u,s:()=>d});var i=s("./app/constants/chartPalette.tsx"),r=s("./app/locale.tsx"),a=s("./app/utils/discover/fields.tsx"),o=s("./app/views/performance/data.tsx"),n=s("./app/views/performance/landing/widgets/types.tsx");let d;!function(e){e.DURATION_HISTOGRAM="duration_histogram",e.LCP_HISTOGRAM="lcp_histogram",e.FCP_HISTOGRAM="fcp_histogram",e.FID_HISTOGRAM="fid_histogram",e.APDEX_AREA="apdex_area",e.P50_DURATION_AREA="p50_duration_area",e.P75_DURATION_AREA="p75_duration_area",e.P95_DURATION_AREA="p95_duration_area",e.P99_DURATION_AREA="p99_duration_area",e.P75_LCP_AREA="p75_lcp_area",e.TPM_AREA="tpm_area",e.FAILURE_RATE_AREA="failure_rate_area",e.USER_MISERY_AREA="user_misery_area",e.WORST_LCP_VITALS="worst_lcp_vitals",e.WORST_FCP_VITALS="worst_fcp_vitals",e.WORST_CLS_VITALS="worst_cls_vitals",e.WORST_FID_VITALS="worst_fid_vitals",e.MOST_IMPROVED="most_improved",e.MOST_REGRESSED="most_regressed",e.MOST_RELATED_ERRORS="most_related_errors",e.MOST_RELATED_ISSUES="most_related_issues",e.SLOW_HTTP_OPS="slow_http_ops",e.SLOW_DB_OPS="slow_db_ops",e.SLOW_RESOURCE_OPS="slow_resource_ops",e.SLOW_BROWSER_OPS="slow_browser_ops",e.COLD_STARTUP_AREA="cold_startup_area",e.WARM_STARTUP_AREA="warm_startup_area",e.SLOW_FRAMES_AREA="slow_frames_area",e.FROZEN_FRAMES_AREA="frozen_frames_area",e.MOST_SLOW_FRAMES="most_slow_frames",e.MOST_FROZEN_FRAMES="most_frozen_frames",e.SPAN_OPERATIONS="span_operations",e.TIME_TO_INITIAL_DISPLAY="time_to_initial_display",e.TIME_TO_FULL_DISPLAY="time_to_full_display"}(d||(d={}));const l=i.$[5],u=e=>{let{organization:t}=e;return{[d.DURATION_HISTOGRAM]:{title:(0,r.t)("Duration Distribution"),titleTooltip:(0,o.$r)(t,o.V$.DURATION_DISTRIBUTION),fields:["transaction.duration"],dataType:n.A.histogram,chartColor:l[5]},[d.LCP_HISTOGRAM]:{title:(0,r.t)("LCP Distribution"),titleTooltip:(0,o.$r)(t,o.V$.DURATION_DISTRIBUTION),fields:["measurements.lcp"],dataType:n.A.histogram,chartColor:l[5]},[d.FCP_HISTOGRAM]:{title:(0,r.t)("FCP Distribution"),titleTooltip:(0,o.$r)(t,o.V$.DURATION_DISTRIBUTION),fields:["measurements.fcp"],dataType:n.A.histogram,chartColor:l[5]},[d.FID_HISTOGRAM]:{title:(0,r.t)("FID Distribution"),titleTooltip:(0,o.$r)(t,o.V$.DURATION_DISTRIBUTION),fields:["measurements.fid"],dataType:n.A.histogram,chartColor:l[5]},[d.WORST_LCP_VITALS]:{title:(0,r.t)("Worst LCP Web Vitals"),titleTooltip:(0,o.$r)(t,o.V$.LCP),fields:["measurements.lcp"],vitalStops:{poor:4e3,meh:2500},dataType:n.A.vitals},[d.WORST_FCP_VITALS]:{title:(0,r.t)("Worst FCP Web Vitals"),titleTooltip:(0,o.$r)(t,o.V$.FCP),fields:["measurements.fcp"],vitalStops:{poor:3e3,meh:1e3},dataType:n.A.vitals},[d.WORST_FID_VITALS]:{title:(0,r.t)("Worst FID Web Vitals"),titleTooltip:(0,o.$r)(t,o.V$.FID),fields:["measurements.fid"],vitalStops:{poor:300,meh:100},dataType:n.A.vitals},[d.WORST_CLS_VITALS]:{title:(0,r.t)("Worst CLS Web Vitals"),titleTooltip:(0,o.$r)(t,o.V$.CLS),fields:["measurements.cls"],vitalStops:{poor:.25,meh:.1},dataType:n.A.vitals},[d.TPM_AREA]:{title:(0,r.t)("Transactions Per Minute"),titleTooltip:(0,o.$r)(t,o.V$.TPM),fields:["tpm()"],dataType:n.A.area,chartColor:l[1],allowsOpenInDiscover:!0},[d.APDEX_AREA]:{title:(0,r.t)("Apdex"),titleTooltip:(0,o.$r)(t,o.V$.APDEX),fields:["apdex()"],dataType:n.A.area,chartColor:l[4],allowsOpenInDiscover:!0},[d.P50_DURATION_AREA]:{title:(0,r.t)("p50 Duration"),titleTooltip:(0,o.$r)(t,o.V$.P50),fields:["p50(transaction.duration)"],dataType:n.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[d.P75_DURATION_AREA]:{title:(0,r.t)("p75 Duration"),titleTooltip:(0,o.$r)(t,o.V$.P75),fields:["p75(transaction.duration)"],dataType:n.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[d.P95_DURATION_AREA]:{title:(0,r.t)("p95 Duration"),titleTooltip:(0,o.$r)(t,o.V$.P95),fields:["p95(transaction.duration)"],dataType:n.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[d.P99_DURATION_AREA]:{title:(0,r.t)("p99 Duration"),titleTooltip:(0,o.$r)(t,o.V$.P99),fields:["p99(transaction.duration)"],dataType:n.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[d.P75_LCP_AREA]:{title:(0,r.t)("p75 LCP"),titleTooltip:(0,o.$r)(t,o.V$.P75),fields:["p75(measurements.lcp)"],dataType:n.A.area,chartColor:l[1],allowsOpenInDiscover:!0},[d.FAILURE_RATE_AREA]:{title:(0,r.t)("Failure Rate"),titleTooltip:(0,o.$r)(t,o.V$.FAILURE_RATE),fields:["failure_rate()"],dataType:n.A.area,chartColor:l[2],allowsOpenInDiscover:!0},[d.USER_MISERY_AREA]:{title:(0,r.t)("User Misery"),titleTooltip:(0,o.$r)(t,o.V$.USER_MISERY),fields:["user_misery()"],dataType:n.A.area,chartColor:l[0],allowsOpenInDiscover:!0},[d.COLD_STARTUP_AREA]:{title:(0,r.t)("Cold Startup Time"),titleTooltip:(0,o.$r)(t,o.V$.APP_START_COLD),fields:["p75(measurements.app_start_cold)"],dataType:n.A.area,chartColor:l[4],allowsOpenInDiscover:!0},[d.WARM_STARTUP_AREA]:{title:(0,r.t)("Warm Startup Time"),titleTooltip:(0,o.$r)(t,o.V$.APP_START_WARM),fields:["p75(measurements.app_start_warm)"],dataType:n.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[d.SLOW_FRAMES_AREA]:{title:(0,r.t)("Slow Frames"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_FRAMES),fields:["p75(measurements.frames_slow_rate)"],dataType:n.A.area,chartColor:l[0],allowsOpenInDiscover:!0},[d.FROZEN_FRAMES_AREA]:{title:(0,r.t)("Frozen Frames"),titleTooltip:(0,o.$r)(t,o.V$.FROZEN_FRAMES),fields:["p75(measurements.frames_frozen_rate)"],dataType:n.A.area,chartColor:l[5],allowsOpenInDiscover:!0},[d.MOST_RELATED_ERRORS]:{title:(0,r.t)("Most Related Errors"),titleTooltip:(0,o.$r)(t,o.V$.MOST_ERRORS),fields:["failure_count()"],dataType:n.A.line_list,chartColor:l[0]},[d.MOST_RELATED_ISSUES]:{title:(0,r.t)("Most Related Issues"),titleTooltip:(0,o.$r)(t,o.V$.MOST_ISSUES),fields:["count()"],dataType:n.A.line_list,chartColor:l[0]},[d.SLOW_HTTP_OPS]:{title:(0,r.t)("Slow HTTP Ops"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_HTTP_SPANS),fields:["p75(spans.http)"],dataType:n.A.line_list,chartColor:l[0]},[d.SLOW_BROWSER_OPS]:{title:(0,r.t)("Slow Browser Ops"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_HTTP_SPANS),fields:["p75(spans.browser)"],dataType:n.A.line_list,chartColor:l[0]},[d.SLOW_RESOURCE_OPS]:{title:(0,r.t)("Slow Resource Ops"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_HTTP_SPANS),fields:["p75(spans.resource)"],dataType:n.A.line_list,chartColor:l[0]},[d.SLOW_DB_OPS]:{title:(0,r.t)("Slow DB Ops"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_HTTP_SPANS),fields:["p75(spans.db)"],dataType:n.A.line_list,chartColor:l[0]},[d.TIME_TO_INITIAL_DISPLAY]:{title:(0,r.t)("Time to Initial Display"),titleTooltip:(0,o.$r)(t,o.V$.TIME_TO_INITIAL_DISPLAY),fields:["p75(measurements.time_to_initial_display)"],dataType:n.A.area,chartColor:l[4],allowsOpenInDiscover:!0},[d.TIME_TO_FULL_DISPLAY]:{title:(0,r.t)("Time to Full Display"),titleTooltip:(0,o.$r)(t,o.V$.TIME_TO_FULL_DISPLAY),fields:["p75(measurements.time_to_full_display)"],dataType:n.A.area,chartColor:l[4],allowsOpenInDiscover:!0},[d.MOST_SLOW_FRAMES]:{title:(0,r.t)("Most Slow Frames"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_FRAMES),fields:["avg(measurements.frames_slow)"],dataType:n.A.line_list,chartColor:l[0]},[d.MOST_FROZEN_FRAMES]:{title:(0,r.t)("Most Frozen Frames"),titleTooltip:(0,o.$r)(t,o.V$.FROZEN_FRAMES),fields:["avg(measurements.frames_frozen)"],dataType:n.A.line_list,chartColor:l[0]},[d.MOST_IMPROVED]:{title:(0,r.t)("Most Improved"),titleTooltip:(0,r.t)("This compares the baseline (%s) of the past with the present.","improved"),fields:[],dataType:n.A.trends},[d.MOST_REGRESSED]:{title:(0,r.t)("Most Regressed"),titleTooltip:(0,r.t)("This compares the baseline (%s) of the past with the present.","regressed"),fields:[],dataType:n.A.trends},[d.SPAN_OPERATIONS]:{title:(0,r.t)("Span Operations Breakdown"),titleTooltip:"",fields:a.$4.map((e=>`p75(${e})`)),dataType:n.A.stacked_area}}}}}]);
//# sourceMappingURL=../sourcemaps/app_utils_performance_contexts_metricsEnhancedPerformanceDataContext_tsx-app_views_dashboards-3ef053.aff8f124b8ff7c45c0bc1b0c200b0eff.js.map