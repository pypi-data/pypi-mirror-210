"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_starfish_views_webServiceView_index_tsx"],{"./app/components/charts/components/markArea.tsx":(t,e,r)=>{function n(t){return{...t}}r.d(e,{Z:()=>n}),r("../node_modules/echarts/lib/component/markArea.js")},"./app/utils/performance/contexts/pageError.tsx":(t,e,r)=>{r.d(e,{De:()=>d,V_:()=>o,YY:()=>l});var n=r("../node_modules/react/index.js"),a=r("./app/components/alert.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const s=(0,n.createContext)({pageError:void 0,setPageError:t=>{}});function o(t){let{children:e}=t;const[r,a]=(0,n.useState)();return(0,i.tZ)(s.Provider,{value:{pageError:r,setPageError:a},children:e})}function l(){const{pageError:t}=(0,n.useContext)(s);return t?(0,i.tZ)(a.bZ,{type:"error","data-test-id":"page-error-alert",showIcon:!0,children:t}):null}o.displayName="PageErrorProvider",l.displayName="PageErrorAlert";const d=()=>(0,n.useContext)(s)},"./app/utils/useKeyPress.tsx":(t,e,r)=>{r.d(e,{Z:()=>a});var n=r("../node_modules/react/index.js");const a=(t,e)=>{const[r,a]=(0,n.useState)(!1),i=e??document.body;return(0,n.useEffect)((()=>{const e=e=>{let{key:r}=e;r===t&&a(!0)},r=e=>{let{key:r}=e;r===t&&a(!1)};return i.addEventListener("keydown",e),i.addEventListener("keyup",r),()=>{i.removeEventListener("keydown",e),i.removeEventListener("keyup",r)}}),[t,i]),r}},"./app/views/starfish/components/detailPanel.tsx":(t,e,r)=>{r.d(e,{Z:()=>x});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("../node_modules/react/index.js"),i=r("./app/components/button.tsx"),s=r("./app/icons/iconClose.tsx"),o=r("./app/locale.tsx"),l=r("./app/styles/space.tsx"),d=r("./app/utils/useKeyPress.tsx"),c=r("./app/utils/useOnClickOutside.tsx"),p=r("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),u=r("../node_modules/framer-motion/dist/es/render/dom/motion.mjs"),m=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h="50vw",g=(0,a.forwardRef)(f);function f(t,e){let{collapsed:r,children:n}=t;return(0,m.tZ)(y,{ref:e,collapsed:r,initial:{opacity:0,x:h},animate:r?{opacity:0,x:h}:{opacity:1,x:0},transition:{type:"spring",stiffness:500,damping:50},children:n})}f.displayName="SlideOverPanel";const y=(0,n.Z)(u.E.div,{shouldForwardProp:t=>["animate","transition"].includes(t)||"collapsed"!==t&&(0,p.Z)(t),target:"e1iwvxg00"})("width:",h,";position:fixed;top:0;bottom:0;right:0;background:",(t=>t.theme.background),";color:",(t=>t.theme.textColor),";border-left:1px solid ",(t=>t.theme.border),";text-align:left;z-index:",(t=>t.theme.zIndex.sidebar-1),";",(t=>t.collapsed?"overflow: hidden;":"overflow-x: hidden;\n  overflow-y: scroll;"),";");function x(t){let{children:e,detailKey:r,onClose:n}=t;const[i,l]=(0,a.useState)({collapsed:!0}),p=(0,d.Z)("Escape");(0,a.useEffect)((()=>{r&&l({collapsed:!1})}),[r]);const u=(0,a.useRef)(null);return(0,c.Z)(u,(()=>{i.collapsed||(n?.(),l({collapsed:!0}))})),(0,a.useEffect)((()=>{p&&(i.collapsed||(n?.(),l({collapsed:!0})))}),[p]),(0,m.BX)(g,{collapsed:i.collapsed,ref:u,children:[(0,m.tZ)(Z,{children:(0,m.tZ)(v,{priority:"link",size:"zero",borderless:!0,"aria-label":(0,o.t)("Close Details"),icon:(0,m.tZ)(s.b,{size:"sm"}),onClick:()=>{l({collapsed:!0}),n?.()}})}),(0,m.tZ)(w,{children:e})]})}x.displayName="Detail";const v=(0,n.Z)(i.zx,{target:"e1clb2dw2"})("color:",(t=>t.theme.gray300),";&:hover{color:",(t=>t.theme.gray400),";}"),Z=(0,n.Z)("div",{target:"e1clb2dw1"})("justify-content:flex-end;display:flex;padding:",(0,l.D)(2),";"),w=(0,n.Z)("div",{target:"e1clb2dw0"})("padding:0 ",(0,l.D)(4),";")},"./app/views/starfish/views/webServiceView/index.tsx":(t,e,r)=>{r.r(e),r.d(e,{default:()=>ne});var n=r("../node_modules/react/index.js"),a=r("../node_modules/lodash/isEqual.js"),i=r.n(a),s=r("./app/actionCreators/tags.tsx"),o=r("./app/components/organizations/pageFilters/container.tsx"),l=r("./app/components/sentryDocumentTitle.tsx"),d=r("./app/locale.tsx"),c=r("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),p=r("./app/utils/useApi.tsx"),u=r("./app/utils/useOrganization.tsx"),m=r("./app/utils/usePrevious.tsx"),h=r("./app/utils/useProjects.tsx"),g=r("./app/utils/withPageFilters.tsx"),f=r("../node_modules/lodash/trimStart.js"),y=r.n(f),x=r("./app/components/gridEditable/index.tsx"),v=r("./app/components/performance/searchBar.tsx"),Z=r("./app/utils/discover/eventView.tsx"),w=(r("./app/utils/performance/vitals/constants.tsx"),r("./app/utils/queryString.tsx")),b=r("./app/utils/tokenizeSearch.tsx"),_=(r("./app/views/performance/trends/utils.tsx"),r("./app/views/starfish/utils/dates.tsx"));const q=["transaction"],k="equation|sum(transaction.duration) / total.transaction_duration",T=t=>t?.features?.includes("performance-landing-page-stats-period")?"14d":"7d";var E=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),S=r("./app/components/datePageFilter.tsx"),D=r("./app/components/layouts/thirds.tsx"),P=r("./app/components/organizations/pageFilterBar.tsx"),j=r("./app/components/projectPageFilter.tsx"),C=r("./app/styles/space.tsx"),L=r("./app/utils/performance/contexts/pageError.tsx"),B=r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),z=r("../node_modules/lodash/isNil.js"),O=r.n(z),N=r("../node_modules/query-string/index.js"),A=r("./app/components/button.tsx"),F=r("./app/components/charts/eventsRequest.tsx"),X=r("./app/utils/formatters.tsx"),$=r("./app/utils/withApi.tsx"),Y=r("./app/views/starfish/components/chart.tsx"),V=r("./app/views/starfish/components/detailPanel.tsx"),M=r("./app/views/starfish/views/webServiceView/spanGroupBreakdownContainer.tsx"),R=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const W=(0,$.Z)(F.Z);function U(t){let{row:e,onClose:r,eventView:n,organization:a,location:i}=t;return O()(e)?null:(0,R.tZ)(V.Z,{detailKey:e?.endpoint,onClose:r,children:e&&n&&a&&i&&(0,R.tZ)(I,{row:e,eventView:n,organization:a,location:i})})}function I(t){let{row:e,eventView:r,organization:a}=t;const i=(0,B.u)(),{aggregateDetails:s,transaction:o,httpOp:l}=e,c=new b.MY(["has:http.method","transaction.op:http.server",`transaction:${o}`,`http.method:${l}`]);return(0,R.BX)("div",{children:[(0,R.tZ)("h2",{children:(0,d.t)("Endpoint Detail")}),(0,R.tZ)("p",{children:(0,d.t)("Details of endpoint. More breakdowns, etc. Maybe some trends?")}),(0,R.tZ)(J,{to:`/organizations/${a.slug}/starfish/endpoint-overview/?${N.stringify({endpoint:o,method:l,statsPeriod:r.statsPeriod,project:r.project,start:r.start,end:r.end})}`,children:(0,d.t)("Go to Endpoint Overview")}),(0,R.tZ)(G,{children:(0,d.t)("Endpoint URL")}),(0,R.tZ)("pre",{children:e?.endpoint}),(0,R.tZ)(W,{query:c.formatString(),includePrevious:!1,partial:!0,limit:5,interval:"1h",includeTransformedData:!0,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"starfish-homepage-count",start:r.start,end:r.end,organization:a,yAxis:["tpm()","p50(transaction.duration)"],queryExtras:{dataset:"metrics"},children:t=>{let{results:e,loading:r}=t;return(0,R.tZ)(n.Fragment,{children:(0,R.BX)(K,{children:[(0,R.BX)(H,{children:[(0,R.tZ)(G,{children:(0,d.t)("Throughput")}),(0,R.tZ)(Q,{children:(0,X.Du)(s.tpm)}),(0,R.tZ)(Y.Z,{statsPeriod:"24h",height:110,data:e?.[0]?[e?.[0]]:[],start:"",end:"",loading:r,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,hideYAxisSplitLine:!0,chartColors:[i.charts.getColorPalette(0)[0]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})]}),(0,R.BX)(H,{children:[(0,R.tZ)(G,{children:(0,d.t)("p50(duration)")}),(0,R.tZ)(Q,{children:(0,X.g9)(s.p50/1e3,0,!0)}),(0,R.tZ)(Y.Z,{statsPeriod:"24h",height:110,data:e?.[1]?[e?.[1]]:[],start:"",end:"",loading:r,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,hideYAxisSplitLine:!0,chartColors:[i.charts.getColorPalette(0)[1]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})]})]})})}}),(0,R.tZ)(M._,{transaction:e.transaction})]})}U.displayName="EndpointDetail",I.displayName="EndpointDetailBody";const G=(0,E.Z)("h3",{target:"e147b3ya4"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeLarge),";margin:0;margin-bottom:",(0,C.D)(1),";"),Q=(0,E.Z)("h4",{target:"e147b3ya3"})({name:"3in70x",styles:"margin:0;font-weight:normal"}),K=(0,E.Z)("div",{target:"e147b3ya2"})("display:flex;&>div:last-child{padding-right:",(0,C.D)(1),";}"),H=(0,E.Z)("div",{target:"e147b3ya1"})("padding-right:",(0,C.D)(4),";flex:1;"),J=(0,E.Z)(A.zx,{target:"e147b3ya0"})("margin-bottom:",(0,C.D)(2),";");var tt=r("./app/components/performance/layouts/index.tsx"),et=r("./app/constants/chartPalette.tsx"),rt=r("./app/utils/queryClient.tsx"),nt=r("./app/utils/usePageFilters.tsx"),at=r("./app/components/panels/index.tsx"),it=r("./app/styles/text.tsx");function st(t){let{title:e,children:r,button:n}=t;return(0,R.tZ)(at.s_,{children:(0,R.BX)(dt,{children:[(0,R.BX)(lt,{children:[e&&(0,R.tZ)(ot,{children:e}),n]}),r]})})}st.displayName="MiniChartPanel";const ot=(0,E.Z)("p",{target:"e1mibtmj2"})((t=>t.theme.text.cardTitle),";"),lt=(0,E.Z)("div",{target:"e1mibtmj1"})("padding:0 ",(0,C.D)(1)," ",(0,C.D)(1)," 0;min-height:24px;width:100%;display:flex;align-items:center;justify-content:space-between;"),dt=(0,E.Z)("div",{target:"e1mibtmj0"})("padding:",(0,C.D)(1.5)," ",(0,C.D)(2),";",it.Z,";");r("../node_modules/core-js/modules/es.array.push.js");var ct=r("./app/components/charts/components/markArea.tsx");var pt=r("../node_modules/moment/moment.js"),ut=r.n(pt),mt=r("./app/components/charts/styles.tsx"),ht=r("./app/constants/index.tsx"),gt=r("./app/utils/discover/discoverQuery.tsx"),ft=r("./app/utils/useLocation.tsx"),yt=r("./app/components/links/link.tsx"),xt=r("./app/components/pagination.tsx"),vt=r("./app/utils/discover/fieldRenderers.tsx");const Zt=[{key:"transaction",name:"endpoint",width:350},{key:"count_if(http.status_code,greaterOrEquals,500)",name:"Errors",width:50},{key:"equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))",name:"Error Rate",width:50}];function wt(t){let{location:e,organization:r,eventView:a,isLoading:i,tableData:s,pageLinks:o}=t;return(0,R.BX)(n.Fragment,{children:[(0,R.tZ)(x.ZP,{isLoading:i,data:s?s.data:[],columnOrder:Zt,columnSortBy:a.getSorts(),grid:{renderHeadCell:function(t){return(0,R.tZ)(bt,{align:"left",children:t.name})},renderBodyCell:(t,n)=>function(t,n,a){if(!s||!s.meta)return n[t.key];const i=String(t.key),o=(0,vt.Js)(i,s.meta,!1)(n,{organization:r,location:e});if("transaction"===t.key){const t=n["http.method"]?`${n["http.method"]} `:"";return(0,R.BX)(yt.Z,{to:{pathname:`/starfish/failure-detail/${n["http.method"]}:${encodeURIComponent(n.transaction)}`,query:{start:e.query.start,end:e.query.end}},children:[t,n.transaction]})}return o}(t,n)},location:e}),(0,R.tZ)(xt.Z,{pageLinks:o})]})}wt.displayName="FailureDetailTable";const bt=(0,E.Z)("div",{target:"elb0pee0"})("display:block;width:100%;white-space:nowrap;",(t=>t.align?`text-align: ${t.align};`:""),";");var _t=r("./app/components/charts/lineChart.tsx"),qt=r("./app/utils/discover/charts.tsx");function kt(t){let{data:e,spike:r}=t;const n=(0,B.u)(),a=n.red300,i=1e7;if(!e||e.length<=0||!r)return null;const s=[{color:a,data:e[0].data.filter((t=>r?.startTimestamp-i<=parseInt(t.name,10)&&parseInt(t.name,10)<=r?.endTimestamp+i)),seriesName:"Failure Rate"},{seriesName:"Focused Area",color:a,data:[],silent:!1,emphasis:{disabled:!1},markArea:(0,ct.Z)({silent:!0,itemStyle:{color:a,opacity:.2},label:{show:!1},data:[[{name:"start",xAxis:r.startTimestamp,emphasis:{disabled:!1}},{name:"end",xAxis:r.endTimestamp,emphasis:{disabled:!1}}]]})}],o={splitNumber:3,type:"value",axisLabel:{color:n.chartLabel,formatter:t=>(0,X.rl)(t,1)}},l={seriesOptions:{showSymbol:!1},isGroupedByDate:!0,showTimeInTooltip:!0,color:a,tooltip:{trigger:"axis",valueFormatter:t=>(0,qt.CX)(t,"percentage")},xAxis:{show:!1}};return(0,R.tZ)(_t.w,{height:120,series:s,yAxis:o,...l})}kt.displayName="FocusedFailureRateChart";const Tt=kt;var Et=r("./app/utils/discover/fields.tsx");function St(t){let{organization:e,location:r,spike:a,transactions:i}=t;const s=[{key:"issue",name:"Issue",width:120},{key:"title",name:"Title",width:280},{key:"count_unique(user)",name:"Users",width:50},{key:"count()",name:"Count",width:50}];let o="event.type:error transaction:[";i?.forEach((t=>o+=`${t},`)),o=o.slice(0,o.length-1)+"]";const{query:l}=r,c=a?.startTimestamp&&a.endTimestamp,p={name:(0,d.t)("Failure Detail Issues"),projects:[],start:a?.startTimestamp?new Date(a?.startTimestamp).toUTCString():void 0,end:a?.endTimestamp?new Date(a?.endTimestamp).toUTCString():void 0,range:c?void 0:(0,w.ro)(l.statsPeriod)||ht.GY,fields:["issue","title","count()","count_unique(user)"],query:o,orderby:`-${(0,Et.LY)("count()")}`,version:2},u=Z.ZP.fromNewQueryWithLocation(p,r);return i?(0,R.tZ)(gt.Z,{eventView:u,orgSlug:e.slug,location:r,referrer:"api.starfish.failure-issue-list",queryExtras:{dataset:"discover"},limit:5,children:t=>{let{pageLinks:a,isLoading:i,tableData:o}=t;return(0,R.BX)(n.Fragment,{children:[(0,R.tZ)(x.ZP,{isLoading:i,data:o?o.data:[],columnOrder:s,columnSortBy:u.getSorts(),grid:{renderHeadCell:t=>function(t,e){const r=(0,Et.qG)(e.name,e.type,t);return(0,R.tZ)(Dt,{align:r,children:e.name})}(o?.meta,t),renderBodyCell:(t,n)=>function(t,n,a,i){if(!t||!t.meta)return a[n.key];const s=String(n.key);return(0,vt.Js)(s,t.meta,!1)(a,{organization:e,location:r})}(o,t,n)},location:r}),(0,R.tZ)(xt.Z,{pageLinks:a})]})}}):(0,R.tZ)(x.ZP,{isLoading:!0,data:[],columnOrder:s,columnSortBy:u.getSorts(),grid:{},location:r})}St.displayName="IssueTable";const Dt=(0,E.Z)("div",{target:"e1985awp0"})("display:block;width:100%;white-space:nowrap;",(t=>t.align?`text-align: ${t.align};`:""),";");function Pt(t){let{chartData:e,spike:r,onClose:a}=t;const i=(0,ft.T)(),s=(0,u.Z)();if(O()(r))return null;const o=r?.startTimestamp&&r.endTimestamp;function l(){const t={name:(0,d.t)("Transaction Event Count"),projects:[],start:r?.startTimestamp?new Date(r?.startTimestamp).toUTCString():void 0,end:r?.endTimestamp?new Date(r?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||ht.GY,fields:["count_if(http.status_code,greaterOrEquals,500)"],query:"event.type:transaction",version:2},e={name:(0,d.t)("Error Event Count"),projects:[],start:r?.startTimestamp?new Date(r?.startTimestamp).toUTCString():void 0,end:r?.endTimestamp?new Date(r?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||ht.GY,fields:["count()"],query:"event.type:error",version:2};return(0,R.BX)(Lt,{children:[(0,R.BX)(Bt,{children:[(0,R.tZ)(mt.OT,{children:(0,d.t)("Transaction Events")}),(0,R.tZ)(gt.Z,{eventView:Z.ZP.fromNewQueryWithLocation(t,i),orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},children:t=>{let{isLoading:e,tableData:r}=t;return(0,R.tZ)(zt,{children:e?"—":r?.data[0]["count_if(http.status_code,greaterOrEquals,500)"]})}})]}),(0,R.BX)(Bt,{children:[(0,R.tZ)(mt.OT,{children:(0,d.t)("Error Events")}),(0,R.tZ)(gt.Z,{eventView:Z.ZP.fromNewQueryWithLocation(e,i),orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},children:t=>{let{isLoading:e,tableData:r}=t;return(0,R.tZ)(zt,{children:e?"—":r?.data[0]["count()"]})}})]}),(0,R.BX)(Bt,{children:[(0,R.tZ)(mt.OT,{children:(0,d.t)("Users")}),(0,R.tZ)(zt,{children:"—"})]})]})}const c={name:(0,d.t)("Failure Sample"),projects:[],start:r?.startTimestamp?new Date(r?.startTimestamp).toUTCString():void 0,end:r?.endTimestamp?new Date(r?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||ht.GY,fields:["transaction","count_if(http.status_code,greaterOrEquals,500)","equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))","http.method","count_if(http.status_code,equals,200)"],query:"event.type:transaction has:http.method transaction.op:http.server count_if(http.status_code,greaterOrEquals,500):>0",version:2,orderby:"-count_if_http_status_code_greaterOrEquals_500"},p=Z.ZP.fromNewQueryWithLocation(c,i);return(0,R.BX)(V.Z,{detailKey:r?.startTimestamp.toString(),onClose:a,children:[(0,R.tZ)(Ct,{children:`${ut()(r?.startTimestamp).format("MMMM Do YYYY, h:mm:ss a")} - ${ut()(r?.endTimestamp).format("MMMM Do YYYY, h:mm:ss a")}`}),(0,R.tZ)("h4",{children:(0,d.t)("Error Spike Detail")}),r&&(0,R.tZ)(gt.Z,{eventView:p,orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},limit:5,children:t=>{const a=t?.tableData?.data.map((t=>t.transaction));return(0,R.BX)(n.Fragment,{children:[l(),(0,R.tZ)(Tt,{data:e,spike:r}),(0,R.tZ)(jt,{children:(0,d.t)("Failing Endpoints")}),(0,R.tZ)(wt,{...t,location:i,organization:s,eventView:p}),(0,R.tZ)(jt,{children:(0,d.t)("Related Issues")}),(0,R.tZ)(St,{location:i,organization:s,isLoading:t.isLoading,spike:r,transactions:a})]})}})]})}Pt.displayName="FailureDetailPanel";const jt=(0,E.Z)("h5",{target:"e19lyfqb4"})("margin-bottom:",(0,C.D)(1),";"),Ct=(0,E.Z)("div",{target:"e19lyfqb3"})("color:",(t=>t.theme.red300),";margin-bottom:",(0,C.D)(4),";"),Lt=(0,E.Z)("div",{target:"e19lyfqb2"})("display:flex;flex-direction:row;margin-bottom:",(0,C.D)(2),";"),Bt=(0,E.Z)("div",{target:"e19lyfqb1"})("display:flex;flex-direction:column;margin-right:",(0,C.D)(4),";margin-bottom:0;"),zt=(0,E.Z)("div",{target:"e19lyfqb0"})({name:"kux9p6",styles:"font-weight:400;font-size:22px"});var Ot=r("./app/components/assistant/guideAnchor.tsx"),Nt=r("./app/components/gridEditable/sortLink.tsx"),At=r("./app/components/tooltip.tsx"),Ft=r("./app/components/duration.tsx"),Xt=r("./app/components/searchBar.tsx"),$t=r("./app/utils/discover/styles.tsx");const Yt=["endpoint","tpm","p50(duration)","p95(duration)"],Vt={[k]:"percentage"};function Mt(t){let{eventView:e,location:r,organization:a,setError:i,columnTitles:s,dataset:o}=t;const[l,c]=(0,n.useState)([]),[p,u]=(0,n.useState)(e);function m(t){const n={};return t?.data?.[0]&&Object.keys(t.data[0]).forEach((t=>{t.startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals")&&(n["p50()"]=t)})),(n,i)=>function(t,n,i,s){if(!t||!t.meta)return i[n.key];const o={...t.meta,...Vt},l=String(n.key),c=(0,vt.Js)(l,o,!1)(i,{organization:a,location:r});if("transaction"===l){let t="";return i["http.method"]&&(t=`${i["http.method"]} `),(0,R.BX)(yt.Z,{to:`/organizations/${a.slug}/starfish/endpoint-overview/?${N.stringify({endpoint:i.transaction,method:i["http.method"],statsPeriod:e.statsPeriod,project:e.project,start:e.start,end:e.end})}`,style:{display:"block",width:"100%"},children:[t,i.transaction]})}if(l===k){const t=Number(i["sum(transaction.duration)"]),e=Number(i[k]);return(0,R.tZ)(At.u,{title:(0,d.t)("This endpoint accounts for %s of the cumulative time on your web service",(0,X.rl)(e)),containerDisplayMode:"block",position:"top",children:(0,R.tZ)($t.Hw,{children:(0,d._N)("[cumulativeTime] ([cumulativeTimePercentage])",{cumulativeTime:(0,R.tZ)(Ft.Z,{seconds:t/1e3,fixedDigits:2,abbreviation:!0}),cumulativeTimePercentage:(0,X.rl)(e)})})})}if(l.startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals,")){const t=i[l],e=t<0?"good":t>0?"bad":"neutral";return(0,R.tZ)($t.Hw,{children:(0,R.tZ)(Wt,{trendDirection:e,children:(0,d._N)("[sign][delta]",{sign:t>=0?"+":"-",delta:(0,X.rl)(Math.abs(t),2)})})})}if("project"===l)return null;const p=(0,Et.LY)(l),u=i[p];return"integer"===o[p]&&"number"==typeof u&&u>999?(0,R.tZ)(At.u,{title:u.toLocaleString(),containerDisplayMode:"block",position:"right",children:c}):c}(t,n,i)}function h(t){const n=s??Yt;return(a,i)=>function(t,n,a){let i="left";i="equation"===n.column.kind?"right":(0,Et.qG)(n.name,n.type,t);const s={field:"equation"===n.column.kind?n.key:n.name,width:n.width},o={};t&&Object.keys(t).forEach((e=>{o[(0,Et.LY)(e)]=t[e]}));const l=e.sortForField(s,o),d=(0,Z.M3)(s,o),c=l?l.kind:void 0;return(0,R.tZ)(Nt.Z,{align:i,title:a||s.field,direction:c,canSort:d,generateSortLink:function(){if(!t)return;const n=e.sortOnField(s,o).generateQueryStringObject();return{...r,query:{...r.query,sort:n.sort}}}})}(t,a,n[i])}function g(t,e){c((r=>r.map(((r,n)=>n===t?Number(e.width??x.z7):r))))}(0,n.useEffect)((()=>{u((t=>{const r=e.clone();return r.query=t.query,r}))}),[e]);const f=e.getColumns().filter((t=>!t.name.startsWith("count_miserable")&&!t.name.startsWith("percentile_range")&&"project_threshold_config"!==t.name&&"project"!==t.name&&"http.method"!==t.name&&"total.transaction_duration"!==t.name&&"sum(transaction.duration)"!==t.name)).map(((t,e)=>"number"==typeof l[e]?{...t,width:l[e]}:t)),y=e.getSorts();return(0,R.BX)(Ot.Z,{target:"performance_table",position:"top-start",children:[(0,R.tZ)(Ut,{placeholder:(0,d.t)("Search for endpoints"),onSearch:function(t){const r=e.clone();r.query+=`transaction:*${t}*`,u(r)}}),(0,R.tZ)(gt.Z,{eventView:p,orgSlug:a.slug,location:r,setError:t=>i(t?.message),referrer:"api.starfish.endpoint-list",queryExtras:{dataset:o??"metrics"},children:t=>{let{pageLinks:e,isLoading:a,tableData:i}=t;return(0,R.BX)(n.Fragment,{children:[(0,R.tZ)(x.ZP,{isLoading:a,data:i?i.data:[],columnOrder:f,columnSortBy:y,grid:{onResizeColumn:g,renderHeadCell:h(i?.meta),renderBodyCell:m(i)},location:r}),(0,R.tZ)(xt.Z,{pageLinks:e})]})}})]})}Mt.displayName="EndpointList";const Rt=Mt,Wt=(0,E.Z)("div",{target:"e152i1y81"})("color:",(t=>"good"===t.trendDirection?t.theme.successText:"bad"===t.trendDirection?t.theme.errorText:t.theme.subText),";float:right;"),Ut=(0,E.Z)(Xt.Z,{target:"e152i1y80"})("margin-bottom:",(0,C.D)(2),";"),It=(0,$.Z)(F.Z);function Gt(t){const{organization:e,eventView:r,onSelect:a}=t,i=(0,B.u)(),[s,o]=(0,n.useState)(null),l=(0,nt.Z)(),{selection:c}=l,{projects:p,environments:u}=c;return(0,rt.WE)([`/organizations/${e.slug}/events-starfish/`,{query:{environment:u,project:p.map((t=>String(t))),statsPeriod:"7d"}}],{staleTime:10}),(0,R.BX)("div",{"data-test-id":"starfish-view",children:[(0,R.tZ)(Qt,{minSize:200,children:(0,R.BX)(Kt,{children:[(0,R.tZ)(Ht,{children:(0,R.tZ)(M._,{})}),(0,R.BX)(Jt,{children:[(0,R.tZ)(st,{title:(0,d.t)("Error Rate"),children:function(){const t=new b.MY(["event.type:transaction"]);return(0,R.tZ)(It,{query:t.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"starfish-homepage-failure-rate",start:r.start,end:r.end,organization:e,yAxis:"equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))",children:t=>{const e=t.timeseriesData?.map((t=>({data:t.data,seriesName:(0,d.t)("Error Rate"),color:et.$[5][3],silent:!0})));return e?(function(t,e){const{data:r}=t[0],n=function(t,e,r){const n=e-t,a=Math.round(n/40),i=[];let s=t;for(;s<e;){const t=[s,s+a-0];i.push(t),s+=a}return i}(r[0].name,r[r.length-1].name).map((t=>{let[e,r]=t;return[{name:"start",xAxis:e,emphasis:{disabled:!1}},{name:"end",xAxis:r,emphasis:{disabled:!1}}]}));t.push({seriesName:"Clickable Area",color:e,data:[],silent:!1,emphasis:{disabled:!1},markArea:(0,ct.Z)({silent:!1,itemStyle:{color:e,opacity:0},label:{show:!1},emphasis:{disabled:!1,itemStyle:{opacity:.2}},data:n})})}(e,i.red300),(0,R.BX)(n.Fragment,{children:[(0,R.tZ)(Pt,{onClose:()=>o(null),chartData:e,spike:s}),(0,R.tZ)(Y.Z,{statsPeriod:r.statsPeriod,height:80,data:e,start:r.start,end:r.end,loading:t.loading,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:2,isLineChart:!0,chartColors:i.charts.getColorPalette(2),disableXAxis:!0,aggregateOutputFormat:"percentage",onClick:t=>{"markArea"===t.componentType&&o({startTimestamp:t.data.coord[0][0],endTimestamp:t.data.coord[1][0]})}})]})):null}})}()}),(0,R.tZ)(st,{title:(0,d.t)("Top Endpoint Response Times"),children:function(){const t=new b.MY(["event.type:transaction","has:http.method","transaction.op:http.server"]);return(0,R.tZ)(It,{query:t.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"starfish-homepage-count",start:r.start,end:r.end,organization:e,yAxis:"p50(transaction.duration)",queryExtras:{dataset:"metrics"},orderby:"-sum_transaction_duration",topEvents:5,field:["transaction","sum(transaction.duration)","p50(transaction.duration)"],children:t=>{let{loading:e,results:n}=t;const a=n?.map((t=>({data:t.data,seriesName:t.seriesName})));return a?(0,R.tZ)(Y.Z,{statsPeriod:r.statsPeriod,height:107,data:a,start:"",end:"",loading:e,utc:!1,grid:{left:"0",right:"0",top:"16px",bottom:"0"},definedAxisTicks:2,isLineChart:!0,chartColors:i.charts.getColorPalette(2),disableXAxis:!0,aggregateOutputFormat:"duration",showLegend:!0}):null}})}()}),(0,R.tZ)(st,{title:(0,d.t)("Throughput"),children:function(){const t=new b.MY(["event.type:transaction","has:http.method","transaction.op:http.server"]);return(0,R.tZ)(It,{query:t.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"starfish-homepage-count",start:r.start,end:r.end,organization:e,yAxis:"tpm()",queryExtras:{dataset:"metrics"},children:t=>{let{loading:e,timeseriesData:n}=t;const a=n?.map((t=>({data:t.data,seriesName:(0,d.t)("Throughput"),color:et.$[0][0]})));return a?(0,R.tZ)(Y.Z,{statsPeriod:r.statsPeriod,height:80,data:a,start:"",end:"",loading:e,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:2,stacked:!0,chartColors:i.charts.getColorPalette(2),disableXAxis:!0}):null}})}()})]})]})}),(0,R.tZ)(Rt,{...t,setError:(0,L.De)().setPageError,dataset:"discover",onSelect:a,columnTitles:["endpoint","tpm","p50(duration)","p50 change","failure count","cumulative time"]})]})}Gt.displayName="StarfishView";const Qt=(0,E.Z)(tt.c,{target:"epbipxo3"})("margin-bottom:",(0,C.D)(2),";"),Kt=(0,E.Z)("div",{target:"epbipxo2"})("display:flex;flex-direction:row;flex-wrap:wrap;gap:",(0,C.D)(2),";"),Ht=(0,E.Z)("div",{target:"epbipxo1"})({name:"1189xqs",styles:"flex:2"}),Jt=(0,E.Z)("div",{target:"epbipxo0"})({name:"82a6rk",styles:"flex:1"});function te(t){const e=(0,R.BX)(P.Z,{condensed:!0,children:[(0,R.tZ)(j.Z,{}),(0,R.tZ)(S.Z,{alignDropdown:"left"})]}),[r,a]=(0,n.useState)({selectedRow:void 0}),{selectedRow:i}=r;return(0,R.tZ)(D.T3,{children:(0,R.BX)(L.V_,{children:[(0,R.tZ)(D.h4,{children:(0,R.tZ)(D.oB,{children:(0,R.tZ)(D.Dx,{children:(0,d.t)("Starfish")})})}),(0,R.tZ)(D.uT,{children:(0,R.BX)(D.or,{fullWidth:!0,children:[(0,R.tZ)(L.YY,{}),(0,R.BX)(n.Fragment,{children:[(0,R.tZ)(ee,{children:e}),(0,R.tZ)(Gt,{...t,onSelect:t=>a({selectedRow:t})}),(0,R.tZ)(U,{row:i,onClose:()=>a({selectedRow:void 0}),eventView:t.eventView,organization:t.organization,location:t.location})]})]})})]})})}te.displayName="StarfishLanding";const ee=(0,E.Z)("div",{target:"e160gsn70"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,C.D)(2),";margin-bottom:",(0,C.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr auto;}");function re(t){let{selection:e,location:r,router:a}=t;const g=(0,p.Z)(),f=(0,u.Z)(),{projects:E}=(0,h.Z)(),S=(0,n.useRef)(!1),D=(0,m.Z)(e.datetime),P=(0,c.gp)(f),j=function(t,e){let{withStaticFilters:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;const{query:a}=t,i=a.start&&a.end,s=(0,_.ie)({start:(0,w.ro)(a.start),end:(0,w.ro)(a.end),statsPeriod:a.statsPeriod||i?(0,w.ro)(a.statsPeriod):T(n)}),o=`equation|(percentile_range(transaction.duration,0.50,lessOrEquals,${s})-percentile_range(transaction.duration,0.50,greater,${s}))/percentile_range(transaction.duration,0.50,lessOrEquals,${s})`;let l=(0,w.ro)(a.sort,`-${k}`);const c=l.startsWith("-");y()(l,"-").startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals,")&&(l=c?`-${o}`:o);const p=["transaction","http.method","tpm()","p50()",o,"count_if(http.status_code,greaterOrEquals,500)",k,"total.transaction_duration","sum(transaction.duration)",`percentile_range(transaction.duration,0.50,lessOrEquals,${s})`,`percentile_range(transaction.duration,0.50,greater,${s})`],u={id:void 0,name:(0,d.t)("Performance"),query:"event.type:transaction has:http.method transaction.op:http.server",projects:[],fields:p,version:2},m=Array(u.fields.length).fill(x.z7);m[u.fields.length-1]="110",u.widths=m,a.statsPeriod||i||(u.range=T(n)),u.orderby=l;const h=(0,w.ro)(a.query,"");return u.query=`${u.query} ${function(t,e){const r=new b.MY(t);if(r.freeText.length>0){const t=r.freeText.join(" ");r.setFilterValues("transaction",[(0,v.D)(t)],!1),r.freeText=[]}return e&&(r.tokens=r.tokens.filter((t=>t.key&&q.includes(t.key)))),r.formatString()}(h,r)}`,Z.ZP.fromNewQueryWithLocation(u,t)}(r,E,{withStaticFilters:P},f);return(0,n.useEffect)((()=>{if(!S.current)return(0,s.QK)(g,f.slug,e),void(S.current=!0);i()(D,e.datetime)||(0,s.QK)(g,f.slug,e)}),[e.datetime,D,e,g,f,r,E]),(0,R.tZ)(l.Z,{title:(0,d.t)("Starfish"),orgSlug:f.slug,children:(0,R.tZ)(o.Z,{defaultSelection:{datetime:{start:null,end:null,utc:!1,period:T(f)}},children:(0,R.tZ)(te,{router:a,eventView:j,organization:f,location:r,projects:E,selection:e,withStaticFilters:P})})})}re.displayName="WebServiceView";const ne=(0,g.Z)(re)}}]);
//# sourceMappingURL=../sourcemaps/app_views_starfish_views_webServiceView_index_tsx.8c5c4ce4f25623e08608f9273555c41a.js.map