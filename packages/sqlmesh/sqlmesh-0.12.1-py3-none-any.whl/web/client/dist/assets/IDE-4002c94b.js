import{r as o,S as se,D as W,y as Q,L as Ue,o as j,R as O,c as Ke,u as H,d as V,X as Y,I as _,p as Qe,s as Ve,n as ve,C as Re,l as ie,h as _e,T as He,a as F,b as ke,e as Se,_ as tt,M as K,f as We,g as nt,i as rt,j as Fe,k as Oe,E as at,m as Ye,q as we,t as je,O as te,v as st,w as q,N as Ne,x as U,z as B,A as qe,B as lt,F as de,G as k,H as ee,J as ue,K as r,P as L,Q as ne,U as ce,V as re,W as X,Y as ot,Z as Je,$ as le,a0 as J,a1 as it,a2 as xe,a3 as ut,a4 as Ce,a5 as ct,a6 as dt,a7 as Xe,a8 as ye,a9 as mt,aa as pt,ab as ft,ac as vt,ad as Pe,ae as xt,af as ht,ag as gt,ah as bt,ai as yt,aj as oe,ak as Pt,al as It,am as Le,an as Et}from"./index-33b738f6.js";import{F as St,P as Be,u as wt}from"./channels-31b30eb9.js";import{T as Ie}from"./TasksOverview-5de50958.js";function jt({title:e,titleId:t,...l},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:a,"aria-labelledby":t},l),e?o.createElement("title",{id:t},e):null,o.createElement("path",{fillRule:"evenodd",d:"M16.72 7.72a.75.75 0 011.06 0l3.75 3.75a.75.75 0 010 1.06l-3.75 3.75a.75.75 0 11-1.06-1.06l2.47-2.47H3a.75.75 0 010-1.5h16.19l-2.47-2.47a.75.75 0 010-1.06z",clipRule:"evenodd"}))}const Nt=o.forwardRef(jt),Ct=Nt;function Rt({title:e,titleId:t,...l},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:a,"aria-labelledby":t},l),e?o.createElement("title",{id:t},e):null,o.createElement("path",{fillRule:"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z",clipRule:"evenodd"}))}const kt=o.forwardRef(Rt),Ft=kt;function At(e){throw new Error("Unexpected object: "+e)}var G=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(G||{});function Mt(e,t){let l=t.resolveItems();if(l.length<=0)return null;let a=t.resolveActiveIndex(),d=a??-1,u=(()=>{switch(e.focus){case 0:return l.findIndex(n=>!t.resolveDisabled(n));case 1:{let n=l.slice().reverse().findIndex((s,c,y)=>d!==-1&&y.length-c-1>=d?!1:!t.resolveDisabled(s));return n===-1?n:l.length-1-n}case 2:return l.findIndex((n,s)=>s<=d?!1:!t.resolveDisabled(n));case 3:{let n=l.slice().reverse().findIndex(s=>!t.resolveDisabled(s));return n===-1?n:l.length-1-n}case 4:return l.findIndex(n=>t.resolveId(n)===e.id);case 5:return null;default:At(e)}})();return u===-1?a:u}function ze(e){return[e.screenX,e.screenY]}function Tt(){let e=o.useRef([-1,-1]);return{wasMoved(t){let l=ze(t);return e.current[0]===l[0]&&e.current[1]===l[1]?!1:(e.current=l,!0)},update(t){e.current=ze(t)}}}var Dt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Dt||{}),$t=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))($t||{}),Ot=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(Ot||{});function Ee(e,t=l=>l){let l=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,a=nt(t(e.items.slice()),u=>u.dataRef.current.domRef.current),d=l?a.indexOf(l):null;return d===-1&&(d=null),{items:a,activeItemIndex:d}}let Lt={[1](e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},[0](e){return e.menuState===0?e:{...e,menuState:0}},[2]:(e,t)=>{var l;let a=Ee(e),d=Mt(t,{resolveItems:()=>a.items,resolveActiveIndex:()=>a.activeItemIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...e,...a,searchQuery:"",activeItemIndex:d,activationTrigger:(l=t.trigger)!=null?l:1}},[3]:(e,t)=>{let l=e.searchQuery!==""?0:1,a=e.searchQuery+t.value.toLowerCase(),d=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+l).concat(e.items.slice(0,e.activeItemIndex+l)):e.items).find(n=>{var s;return((s=n.dataRef.current.textValue)==null?void 0:s.startsWith(a))&&!n.dataRef.current.disabled}),u=d?e.items.indexOf(d):-1;return u===-1||u===e.activeItemIndex?{...e,searchQuery:a}:{...e,searchQuery:a,activeItemIndex:u,activationTrigger:1}},[4](e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},[5]:(e,t)=>{let l=Ee(e,a=>[...a,{id:t.id,dataRef:t.dataRef}]);return{...e,...l}},[6]:(e,t)=>{let l=Ee(e,a=>{let d=a.findIndex(u=>u.id===t.id);return d!==-1&&a.splice(d,1),a});return{...e,...l,activationTrigger:1}}},Ae=o.createContext(null);Ae.displayName="MenuContext";function he(e){let t=o.useContext(Ae);if(t===null){let l=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,he),l}return t}function Bt(e,t){return H(t.type,Lt,e,t)}let zt=o.Fragment;function Gt(e,t){let l=o.useReducer(Bt,{menuState:1,buttonRef:o.createRef(),itemsRef:o.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:a,itemsRef:d,buttonRef:u},n]=l,s=Q(t);Ue([u,d],(m,w)=>{var x;n({type:1}),_e(w,He.Loose)||(m.preventDefault(),(x=u.current)==null||x.focus())},a===0);let c=j(()=>{n({type:1})}),y=o.useMemo(()=>({open:a===0,close:c}),[a,c]),g=e,p={ref:s};return O.createElement(Ae.Provider,{value:l},O.createElement(Ke,{value:H(a,{[0]:V.Open,[1]:V.Closed})},Y({ourProps:p,theirProps:g,slot:y,defaultTag:zt,name:"Menu"})))}let Ut="button";function Kt(e,t){var l;let a=_(),{id:d=`headlessui-menu-button-${a}`,...u}=e,[n,s]=he("Menu.Button"),c=Q(n.buttonRef,t),y=Qe(),g=j(i=>{switch(i.key){case F.Space:case F.Enter:case F.ArrowDown:i.preventDefault(),i.stopPropagation(),s({type:0}),y.nextFrame(()=>s({type:2,focus:G.First}));break;case F.ArrowUp:i.preventDefault(),i.stopPropagation(),s({type:0}),y.nextFrame(()=>s({type:2,focus:G.Last}));break}}),p=j(i=>{switch(i.key){case F.Space:i.preventDefault();break}}),m=j(i=>{if(ke(i.currentTarget))return i.preventDefault();e.disabled||(n.menuState===0?(s({type:1}),y.nextFrame(()=>{var I;return(I=n.buttonRef.current)==null?void 0:I.focus({preventScroll:!0})})):(i.preventDefault(),s({type:0})))}),w=o.useMemo(()=>({open:n.menuState===0}),[n]),x={ref:c,id:d,type:Ve(e,n.buttonRef),"aria-haspopup":"menu","aria-controls":(l=n.itemsRef.current)==null?void 0:l.id,"aria-expanded":e.disabled?void 0:n.menuState===0,onKeyDown:g,onKeyUp:p,onClick:m};return Y({ourProps:x,theirProps:u,slot:w,defaultTag:Ut,name:"Menu.Button"})}let Qt="div",Vt=se.RenderStrategy|se.Static;function _t(e,t){var l,a;let d=_(),{id:u=`headlessui-menu-items-${d}`,...n}=e,[s,c]=he("Menu.Items"),y=Q(s.itemsRef,t),g=ve(s.itemsRef),p=Qe(),m=Re(),w=(()=>m!==null?(m&V.Open)===V.Open:s.menuState===0)();o.useEffect(()=>{let f=s.itemsRef.current;f&&s.menuState===0&&f!==(g==null?void 0:g.activeElement)&&f.focus({preventScroll:!0})},[s.menuState,s.itemsRef,g]),St({container:s.itemsRef.current,enabled:s.menuState===0,accept(f){return f.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:f.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(f){f.setAttribute("role","none")}});let x=j(f=>{var A,S;switch(p.dispose(),f.key){case F.Space:if(s.searchQuery!=="")return f.preventDefault(),f.stopPropagation(),c({type:3,value:f.key});case F.Enter:if(f.preventDefault(),f.stopPropagation(),c({type:1}),s.activeItemIndex!==null){let{dataRef:v}=s.items[s.activeItemIndex];(S=(A=v.current)==null?void 0:A.domRef.current)==null||S.click()}We(s.buttonRef.current);break;case F.ArrowDown:return f.preventDefault(),f.stopPropagation(),c({type:2,focus:G.Next});case F.ArrowUp:return f.preventDefault(),f.stopPropagation(),c({type:2,focus:G.Previous});case F.Home:case F.PageUp:return f.preventDefault(),f.stopPropagation(),c({type:2,focus:G.First});case F.End:case F.PageDown:return f.preventDefault(),f.stopPropagation(),c({type:2,focus:G.Last});case F.Escape:f.preventDefault(),f.stopPropagation(),c({type:1}),Se().nextFrame(()=>{var v;return(v=s.buttonRef.current)==null?void 0:v.focus({preventScroll:!0})});break;case F.Tab:f.preventDefault(),f.stopPropagation(),c({type:1}),Se().nextFrame(()=>{tt(s.buttonRef.current,f.shiftKey?K.Previous:K.Next)});break;default:f.key.length===1&&(c({type:3,value:f.key}),p.setTimeout(()=>c({type:4}),350));break}}),i=j(f=>{switch(f.key){case F.Space:f.preventDefault();break}}),I=o.useMemo(()=>({open:s.menuState===0}),[s]),N={"aria-activedescendant":s.activeItemIndex===null||(l=s.items[s.activeItemIndex])==null?void 0:l.id,"aria-labelledby":(a=s.buttonRef.current)==null?void 0:a.id,id:u,onKeyDown:x,onKeyUp:i,role:"menu",tabIndex:0,ref:y};return Y({ourProps:N,theirProps:n,slot:I,defaultTag:Qt,features:Vt,visible:w,name:"Menu.Items"})}let Ht=o.Fragment;function Wt(e,t){let l=_(),{id:a=`headlessui-menu-item-${l}`,disabled:d=!1,...u}=e,[n,s]=he("Menu.Item"),c=n.activeItemIndex!==null?n.items[n.activeItemIndex].id===a:!1,y=o.useRef(null),g=Q(t,y);ie(()=>{if(n.menuState!==0||!c||n.activationTrigger===0)return;let S=Se();return S.requestAnimationFrame(()=>{var v,T;(T=(v=y.current)==null?void 0:v.scrollIntoView)==null||T.call(v,{block:"nearest"})}),S.dispose},[y,c,n.menuState,n.activationTrigger,n.activeItemIndex]);let p=o.useRef({disabled:d,domRef:y});ie(()=>{p.current.disabled=d},[p,d]),ie(()=>{var S,v;p.current.textValue=(v=(S=y.current)==null?void 0:S.textContent)==null?void 0:v.toLowerCase()},[p,y]),ie(()=>(s({type:5,id:a,dataRef:p}),()=>s({type:6,id:a})),[p,a]);let m=j(()=>{s({type:1})}),w=j(S=>{if(d)return S.preventDefault();s({type:1}),We(n.buttonRef.current)}),x=j(()=>{if(d)return s({type:2,focus:G.Nothing});s({type:2,focus:G.Specific,id:a})}),i=Tt(),I=j(S=>i.update(S)),N=j(S=>{i.wasMoved(S)&&(d||c||s({type:2,focus:G.Specific,id:a,trigger:0}))}),f=j(S=>{i.wasMoved(S)&&(d||c&&s({type:2,focus:G.Nothing}))}),A=o.useMemo(()=>({active:c,disabled:d,close:m}),[c,d,m]);return Y({ourProps:{id:a,ref:g,role:"menuitem",tabIndex:d===!0?void 0:-1,"aria-disabled":d===!0?!0:void 0,disabled:void 0,onClick:w,onFocus:x,onPointerEnter:I,onMouseEnter:I,onPointerMove:N,onMouseMove:N,onPointerLeave:f,onMouseLeave:f},theirProps:u,slot:A,defaultTag:Ht,name:"Menu.Item"})}let Yt=W(Gt),qt=W(Kt),Jt=W(_t),Xt=W(Wt),pe=Object.assign(Yt,{Button:qt,Items:Jt,Item:Xt});var Zt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Zt||{}),en=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(en||{});let tn={[0]:e=>({...e,popoverState:H(e.popoverState,{[0]:1,[1]:0})}),[1](e){return e.popoverState===1?e:{...e,popoverState:1}},[2](e,t){return e.button===t.button?e:{...e,button:t.button}},[3](e,t){return e.buttonId===t.buttonId?e:{...e,buttonId:t.buttonId}},[4](e,t){return e.panel===t.panel?e:{...e,panel:t.panel}},[5](e,t){return e.panelId===t.panelId?e:{...e,panelId:t.panelId}}},Me=o.createContext(null);Me.displayName="PopoverContext";function ge(e){let t=o.useContext(Me);if(t===null){let l=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,ge),l}return t}let Te=o.createContext(null);Te.displayName="PopoverAPIContext";function De(e){let t=o.useContext(Te);if(t===null){let l=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,De),l}return t}let $e=o.createContext(null);$e.displayName="PopoverGroupContext";function Ze(){return o.useContext($e)}let be=o.createContext(null);be.displayName="PopoverPanelContext";function nn(){return o.useContext(be)}function rn(e,t){return H(t.type,tn,e,t)}let an="div";function sn(e,t){var l;let a=o.useRef(null),d=Q(t,rt(b=>{a.current=b})),u=o.useRef([]),n=o.useReducer(rn,{popoverState:1,buttons:u,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:o.createRef(),afterPanelSentinel:o.createRef()}),[{popoverState:s,button:c,buttonId:y,panel:g,panelId:p,beforePanelSentinel:m,afterPanelSentinel:w},x]=n,i=ve((l=a.current)!=null?l:c),I=o.useMemo(()=>{if(!c||!g)return!1;for(let me of document.querySelectorAll("body > *"))if(Number(me==null?void 0:me.contains(c))^Number(me==null?void 0:me.contains(g)))return!0;let b=Fe(),E=b.indexOf(c),D=(E+b.length-1)%b.length,z=(E+1)%b.length,C=b[D],Z=b[z];return!g.contains(C)&&!g.contains(Z)},[c,g]),N=Oe(y),f=Oe(p),A=o.useMemo(()=>({buttonId:N,panelId:f,close:()=>x({type:1})}),[N,f,x]),S=Ze(),v=S==null?void 0:S.registerPopover,T=j(()=>{var b;return(b=S==null?void 0:S.isFocusWithinPopoverGroup())!=null?b:(i==null?void 0:i.activeElement)&&((c==null?void 0:c.contains(i.activeElement))||(g==null?void 0:g.contains(i.activeElement)))});o.useEffect(()=>v==null?void 0:v(A),[v,A]),at(i==null?void 0:i.defaultView,"focus",b=>{var E,D,z,C;s===0&&(T()||c&&g&&b.target!==window&&((D=(E=m.current)==null?void 0:E.contains)!=null&&D.call(E,b.target)||(C=(z=w.current)==null?void 0:z.contains)!=null&&C.call(z,b.target)||x({type:1})))},!0),Ue([c,g],(b,E)=>{x({type:1}),_e(E,He.Loose)||(b.preventDefault(),c==null||c.focus())},s===0);let h=j(b=>{x({type:1});let E=(()=>b?b instanceof HTMLElement?b:"current"in b&&b.current instanceof HTMLElement?b.current:c:c)();E==null||E.focus()}),M=o.useMemo(()=>({close:h,isPortalled:I}),[h,I]),R=o.useMemo(()=>({open:s===0,close:h}),[s,h]),$=e,P={ref:d};return O.createElement(be.Provider,{value:null},O.createElement(Me.Provider,{value:n},O.createElement(Te.Provider,{value:M},O.createElement(Ke,{value:H(s,{[0]:V.Open,[1]:V.Closed})},Y({ourProps:P,theirProps:$,slot:R,defaultTag:an,name:"Popover"})))))}let ln="button";function on(e,t){let l=_(),{id:a=`headlessui-popover-button-${l}`,...d}=e,[u,n]=ge("Popover.Button"),{isPortalled:s}=De("Popover.Button"),c=o.useRef(null),y=`headlessui-focus-sentinel-${_()}`,g=Ze(),p=g==null?void 0:g.closeOthers,m=nn()!==null;o.useEffect(()=>{if(!m)return n({type:3,buttonId:a}),()=>{n({type:3,buttonId:null})}},[m,a,n]);let[w]=o.useState(()=>Symbol()),x=Q(c,t,m?null:P=>{if(P)u.buttons.current.push(w);else{let b=u.buttons.current.indexOf(w);b!==-1&&u.buttons.current.splice(b,1)}u.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),P&&n({type:2,button:P})}),i=Q(c,t),I=ve(c),N=j(P=>{var b,E,D;if(m){if(u.popoverState===1)return;switch(P.key){case F.Space:case F.Enter:P.preventDefault(),(E=(b=P.target).click)==null||E.call(b),n({type:1}),(D=u.button)==null||D.focus();break}}else switch(P.key){case F.Space:case F.Enter:P.preventDefault(),P.stopPropagation(),u.popoverState===1&&(p==null||p(u.buttonId)),n({type:0});break;case F.Escape:if(u.popoverState!==0)return p==null?void 0:p(u.buttonId);if(!c.current||I!=null&&I.activeElement&&!c.current.contains(I.activeElement))return;P.preventDefault(),P.stopPropagation(),n({type:1});break}}),f=j(P=>{m||P.key===F.Space&&P.preventDefault()}),A=j(P=>{var b,E;ke(P.currentTarget)||e.disabled||(m?(n({type:1}),(b=u.button)==null||b.focus()):(P.preventDefault(),P.stopPropagation(),u.popoverState===1&&(p==null||p(u.buttonId)),n({type:0}),(E=u.button)==null||E.focus()))}),S=j(P=>{P.preventDefault(),P.stopPropagation()}),v=u.popoverState===0,T=o.useMemo(()=>({open:v}),[v]),h=Ve(e,c),M=m?{ref:i,type:h,onKeyDown:N,onClick:A}:{ref:x,id:u.buttonId,type:h,"aria-expanded":e.disabled?void 0:u.popoverState===0,"aria-controls":u.panel?u.panelId:void 0,onKeyDown:N,onKeyUp:f,onClick:A,onMouseDown:S},R=Ye(),$=j(()=>{let P=u.panel;if(!P)return;function b(){H(R.current,{[q.Forwards]:()=>te(P,K.First),[q.Backwards]:()=>te(P,K.Last)})===Ne.Error&&te(Fe().filter(E=>E.dataset.headlessuiFocusGuard!=="true"),H(R.current,{[q.Forwards]:K.Next,[q.Backwards]:K.Previous}),{relativeTo:u.button})}b()});return O.createElement(O.Fragment,null,Y({ourProps:M,theirProps:d,slot:T,defaultTag:ln,name:"Popover.Button"}),v&&!m&&s&&O.createElement(we,{id:y,features:je.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:$}))}let un="div",cn=se.RenderStrategy|se.Static;function dn(e,t){let l=_(),{id:a=`headlessui-popover-overlay-${l}`,...d}=e,[{popoverState:u},n]=ge("Popover.Overlay"),s=Q(t),c=Re(),y=(()=>c!==null?(c&V.Open)===V.Open:u===0)(),g=j(m=>{if(ke(m.currentTarget))return m.preventDefault();n({type:1})}),p=o.useMemo(()=>({open:u===0}),[u]);return Y({ourProps:{ref:s,id:a,"aria-hidden":!0,onClick:g},theirProps:d,slot:p,defaultTag:un,features:cn,visible:y,name:"Popover.Overlay"})}let mn="div",pn=se.RenderStrategy|se.Static;function fn(e,t){let l=_(),{id:a=`headlessui-popover-panel-${l}`,focus:d=!1,...u}=e,[n,s]=ge("Popover.Panel"),{close:c,isPortalled:y}=De("Popover.Panel"),g=`headlessui-focus-sentinel-before-${_()}`,p=`headlessui-focus-sentinel-after-${_()}`,m=o.useRef(null),w=Q(m,t,h=>{s({type:4,panel:h})}),x=ve(m);ie(()=>(s({type:5,panelId:a}),()=>{s({type:5,panelId:null})}),[a,s]);let i=Re(),I=(()=>i!==null?(i&V.Open)===V.Open:n.popoverState===0)(),N=j(h=>{var M;switch(h.key){case F.Escape:if(n.popoverState!==0||!m.current||x!=null&&x.activeElement&&!m.current.contains(x.activeElement))return;h.preventDefault(),h.stopPropagation(),s({type:1}),(M=n.button)==null||M.focus();break}});o.useEffect(()=>{var h;e.static||n.popoverState===1&&((h=e.unmount)==null||h)&&s({type:4,panel:null})},[n.popoverState,e.unmount,e.static,s]),o.useEffect(()=>{if(!d||n.popoverState!==0||!m.current)return;let h=x==null?void 0:x.activeElement;m.current.contains(h)||te(m.current,K.First)},[d,m,n.popoverState]);let f=o.useMemo(()=>({open:n.popoverState===0,close:c}),[n,c]),A={ref:w,id:a,onKeyDown:N,onBlur:d&&n.popoverState===0?h=>{var M,R,$,P,b;let E=h.relatedTarget;E&&m.current&&((M=m.current)!=null&&M.contains(E)||(s({type:1}),(($=(R=n.beforePanelSentinel.current)==null?void 0:R.contains)!=null&&$.call(R,E)||(b=(P=n.afterPanelSentinel.current)==null?void 0:P.contains)!=null&&b.call(P,E))&&E.focus({preventScroll:!0})))}:void 0,tabIndex:-1},S=Ye(),v=j(()=>{let h=m.current;if(!h)return;function M(){H(S.current,{[q.Forwards]:()=>{var R;te(h,K.First)===Ne.Error&&((R=n.afterPanelSentinel.current)==null||R.focus())},[q.Backwards]:()=>{var R;(R=n.button)==null||R.focus({preventScroll:!0})}})}M()}),T=j(()=>{let h=m.current;if(!h)return;function M(){H(S.current,{[q.Forwards]:()=>{var R;if(!n.button)return;let $=Fe(),P=$.indexOf(n.button),b=$.slice(0,P+1),E=[...$.slice(P+1),...b];for(let D of E.slice())if(D.dataset.headlessuiFocusGuard==="true"||(R=n.panel)!=null&&R.contains(D)){let z=E.indexOf(D);z!==-1&&E.splice(z,1)}te(E,K.First,{sorted:!1})},[q.Backwards]:()=>{var R;te(h,K.Previous)===Ne.Error&&((R=n.button)==null||R.focus())}})}M()});return O.createElement(be.Provider,{value:a},I&&y&&O.createElement(we,{id:g,ref:n.beforePanelSentinel,features:je.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:v}),Y({ourProps:A,theirProps:u,slot:f,defaultTag:mn,features:pn,visible:I,name:"Popover.Panel"}),I&&y&&O.createElement(we,{id:p,ref:n.afterPanelSentinel,features:je.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:T}))}let vn="div";function xn(e,t){let l=o.useRef(null),a=Q(l,t),[d,u]=o.useState([]),n=j(x=>{u(i=>{let I=i.indexOf(x);if(I!==-1){let N=i.slice();return N.splice(I,1),N}return i})}),s=j(x=>(u(i=>[...i,x]),()=>n(x))),c=j(()=>{var x;let i=st(l);if(!i)return!1;let I=i.activeElement;return(x=l.current)!=null&&x.contains(I)?!0:d.some(N=>{var f,A;return((f=i.getElementById(N.buttonId.current))==null?void 0:f.contains(I))||((A=i.getElementById(N.panelId.current))==null?void 0:A.contains(I))})}),y=j(x=>{for(let i of d)i.buttonId.current!==x&&i.close()}),g=o.useMemo(()=>({registerPopover:s,unregisterPopover:n,isFocusWithinPopoverGroup:c,closeOthers:y}),[s,n,c,y]),p=o.useMemo(()=>({}),[]),m=e,w={ref:a};return O.createElement($e.Provider,{value:g},Y({ourProps:w,theirProps:m,slot:p,defaultTag:vn,name:"Popover.Group"}))}let hn=W(sn),gn=W(on),bn=W(dn),yn=W(fn),Pn=W(xn),ae=Object.assign(hn,{Button:gn,Overlay:bn,Panel:yn,Group:Pn});function In({showRunPlan:e}){var M,R,$,P,b,E,D,z;const t=U(C=>C.state),l=U(C=>C.action),a=U(C=>C.setState),d=U(C=>C.setAction),u=U(C=>C.setActivePlan),n=B(C=>C.environment),s=B(C=>C.environments),c=B(C=>C.setInitialDates),[y,g]=o.useState(!1),[p,m]=o.useState(!1),{refetch:w}=qe(),{refetch:x,data:i,error:I,isLoading:N,isError:f}=lt(n.name,{planOptions:{skip_tests:!0}}),A=o.useCallback(de(w,1e3,!0),[w]),S=o.useCallback(de(x,1e3,!0),[x]),v=o.useMemo(()=>n.isDefault?{headline:"Running Plan Directly On Prod Environment!",description:"Are you sure you want to run your changes directly on prod? Safer choice will be to select or add new environment first.",yesText:`Yes, Run ${n.name}`,noText:"No, Cancel",action(){T()}}:void 0,[n]);o.useEffect(()=>{S().finally(()=>{p&&(T(),m(!1))})},[n,p]),o.useEffect(()=>{t===k.Finished&&(S(),A())},[t]),o.useEffect(()=>{c(i==null?void 0:i.start,i==null?void 0:i.end)},[i]);function T(){u(void 0),a(k.Init),d(ee.Run),e()}const h=[(M=i==null?void 0:i.changes)==null?void 0:M.added,(R=i==null?void 0:i.changes)==null?void 0:R.removed,(P=($=i==null?void 0:i.changes)==null?void 0:$.modified)==null?void 0:P.direct,(E=(b=i==null?void 0:i.changes)==null?void 0:b.modified)==null?void 0:E.indirect,(z=(D=i==null?void 0:i.changes)==null?void 0:D.modified)==null?void 0:z.metadata].some(ue);return r.jsxs("div",{className:L("flex items-center",n==null&&"opacity-50 pointer-events-none cursor-not-allowed"),children:[r.jsxs("div",{className:"flex items-center relative",children:[r.jsxs(ne,{className:L("mx-0",ce(n.isInitial&&n.isDefault)&&"rounded-none rounded-l-lg border-r"),disabled:f||N||l!==ee.None||t===k.Applying||t===k.Running||t===k.Cancelling,variant:re.Alternative,size:X.sm,onClick:C=>{C.stopPropagation(),n.isDefault&&ce(n.isInitial)?g(!0):T()},children:[ot([k.Applying,k.Running,k.Cancelling],t)&&r.jsx(Je,{className:"w-3 h-3 mr-1"}),r.jsx("span",{className:"inline-block",children:t===k.Running?"Running Plan...":t===k.Applying?"Applying Plan...":t===k.Cancelling?"Cancelling Plan...":l!==ee.None?"Setting Plan...":"Run Plan"})]}),(ce(n.isInitial)||ce(n.isDefault))&&r.jsx(Ge,{className:"rounded-none rounded-r-lg border-l mx-0",environment:n,disabled:f||N||l!==ee.None||t===k.Applying||t===k.Running||t===k.Cancelling})]}),t!==k.Applying&&r.jsx(En,{environment:n,plan:i,isLoading:N,isError:f,error:I,hasChanges:h}),r.jsxs(le,{show:y,onClose:()=>{},children:[r.jsxs(le.Main,{children:[(v==null?void 0:v.headline)!=null&&r.jsx(le.Headline,{children:v==null?void 0:v.headline}),(v==null?void 0:v.description)!=null&&r.jsx(le.Description,{children:v==null?void 0:v.description}),r.jsxs("div",{className:"mt-5 pt-4",children:[r.jsx("h4",{className:"mb-2",children:`${s.size>1?"Select or ":""}Add Environment`}),r.jsxs("div",{className:"flex items-center relative",children:[s.size>1&&r.jsx(Ge,{className:"mr-2",side:"left",environment:n,showAddEnvironemnt:!1,onSelect:()=>{m(!0),g(!1)},size:X.md,disabled:N||l!==ee.None||t===k.Applying||t===k.Cancelling}),r.jsx(et,{className:"w-full",size:X.md,onAdd:()=>{m(!0),g(!1)}})]})]})]}),r.jsxs(le.Actions,{children:[r.jsx(ne,{className:"font-bold",size:"md",variant:re.Primary,onClick:C=>{var Z;C.stopPropagation(),(Z=v==null?void 0:v.action)==null||Z.call(v),g(!1)},children:(v==null?void 0:v.yesText)??"Confirm"}),r.jsx(ne,{size:"md",variant:re.Neutral,onClick:C=>{var Z;C.stopPropagation(),(Z=v==null?void 0:v.cancel)==null||Z.call(v),g(!1)},children:(v==null?void 0:v.noText)??"Cancel"})]})]})]})}function En({isLoading:e,hasChanges:t,environment:l,plan:a,isError:d,error:u}){var n,s,c,y,g,p,m,w,x,i;return r.jsx("span",{className:"flex align-center pr-2 h-full w-full",children:d&&u!=null?r.jsx(Sn,{error:u}):r.jsxs(r.Fragment,{children:[l.isInitial&&r.jsx("span",{title:"New",className:"block ml-1 px-2 first-child:ml-0 rounded-full bg-success-10 text-success-500 text-xs text-center font-bold",children:"New"}),e&&r.jsxs("span",{className:"flex items-center ml-2",children:[r.jsx(Je,{className:"w-3 h-3 mr-1"}),r.jsx("span",{className:"inline-block text-xs text-neutral-500",children:"Checking..."})]}),[t,e,l.isLocal].every(ce)&&r.jsx("span",{title:"Latest",className:"block ml-1 px-2 first-child:ml-0 rounded-full bg-neutral-10 text-xs text-center",children:r.jsx("span",{children:"Latest"})}),((n=a==null?void 0:a.changes)==null?void 0:n.added)!=null&&ue((s=a==null?void 0:a.changes)==null?void 0:s.added)&&r.jsx(fe,{headline:"Added Models",type:J.Add,changes:a.changes.added}),((y=(c=a==null?void 0:a.changes)==null?void 0:c.modified)==null?void 0:y.direct)!=null&&ue((g=a==null?void 0:a.changes)==null?void 0:g.modified.direct)&&r.jsx(fe,{headline:"Direct Changes",type:J.Direct,changes:a.changes.modified.direct.map(({model_name:I})=>I)}),((m=(p=a==null?void 0:a.changes)==null?void 0:p.modified)==null?void 0:m.indirect)!=null&&ue((w=a==null?void 0:a.changes)==null?void 0:w.modified.indirect)&&r.jsx(fe,{headline:"Indirectly Modified",type:J.Indirect,changes:a.changes.modified.indirect.map(I=>I.model_name)}),((x=a==null?void 0:a.changes)==null?void 0:x.removed)!=null&&ue((i=a==null?void 0:a.changes)==null?void 0:i.removed)&&r.jsx(fe,{headline:"Removed Models",type:J.Remove,changes:a.changes.removed})]})})}function Ge({onSelect:e,environment:t,disabled:l,side:a="right",className:d,showAddEnvironemnt:u=!0,size:n=X.sm}){const s=B(p=>p.environments),c=B(p=>p.setEnvironment),y=B(p=>p.removeLocalEnvironment),g=it(pe.Button);return r.jsx(pe,{children:({close:p})=>r.jsxs(r.Fragment,{children:[r.jsxs(g,{variant:re.Alternative,size:n,disabled:l,className:L(d),children:[r.jsx("span",{className:"block overflow-hidden truncate",children:t.name}),r.jsx("span",{className:"pointer-events-none inset-y-0 right-0 flex items-center pl-2",children:r.jsx(Ft,{className:"h-4 w-4","aria-hidden":"true"})})]}),r.jsx(xe,{as:o.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:r.jsxs("div",{className:L("absolute top-9 overflow-hidden shadow-xl bg-theme border-2 border-primary-20 rounded-md flex flex-col z-10",a==="left"&&"left-0",a==="right"&&"right-0"),children:[r.jsxs(pe.Items,{className:"overflow-auto max-h-80 py-2 scrollbar scrollbar--vertical",children:[Array.from(s).map(m=>r.jsx(pe.Item,{children:({active:w})=>r.jsxs("div",{onClick:x=>{x.stopPropagation(),c(m),e==null||e()},className:L("flex justify-between items-center px-4 py-1 cursor-pointer overflow-auto",w&&"bg-primary-10",m===t&&"pointer-events-none cursor-default bg-secondary-10"),children:[r.jsxs("div",{className:"flex items-start",children:[r.jsx(ut,{className:L("w-4 h-4 text-primary-500 mt-1",w&&"opacity-10",m!==t&&"opacity-0")}),r.jsxs("span",{className:"block",children:[r.jsxs("span",{className:"flex items-center",children:[r.jsx("span",{className:L("block truncate ml-2",m.isSyncronized&&"text-primary-500"),children:m.name}),r.jsxs("small",{className:"block ml-2",children:["(",m.type,")"]})]}),m.isDefault&&r.jsx("span",{className:"flex ml-2",children:r.jsx("small",{className:"text-xs text-neutral-500",children:"Default Environment"})})]})]}),m.isLocal&&m!==t&&r.jsx(ne,{className:"my-0 mx-0",size:X.xs,variant:re.Neutral,onClick:x=>{x.stopPropagation(),y(m)},children:"-"})]})},m.name)),u&&r.jsxs(r.Fragment,{children:[r.jsx(Ce,{}),r.jsx(et,{onAdd:p,className:"mt-2 px-2"})]})]}),r.jsx(Ce,{})]})})]})})}function et({onAdd:e,className:t,label:l="Add",size:a=X.sm}){const d=B(p=>p.getNextEnvironment),u=B(p=>p.isExistingEnvironment),n=B(p=>p.addLocalEnvironment),[s,c]=o.useState(""),[y,g]=o.useState(d().name);return r.jsxs("div",{className:L("flex w-full items-center",t),children:[r.jsx(ct,{className:"my-0 mx-0 mr-4 min-w-[10rem] w-full",size:a,placeholder:"Environment",value:s,onInput:p=>{p.stopPropagation(),c(p.target.value)}}),r.jsx(ne,{className:"my-0 mx-0 font-bold",size:a,disabled:dt(s)||u(s),onClick:p=>{p.stopPropagation(),n(s,y),c(""),g(d().name),e==null||e()},children:l})]})}function fe({headline:e,type:t,changes:l}){const[a,d]=o.useState(!1);return r.jsx(ae,{onMouseEnter:()=>{d(!0)},onMouseLeave:()=>{d(!1)},className:"relative flex",children:()=>r.jsxs(r.Fragment,{children:[r.jsx("span",{className:L("inline-block ml-1 px-2 rounded-full text-xs font-bold text-neutral-100 cursor-default border border-inherit",t===J.Add&&"bg-success-500 border-success-500",t===J.Remove&&"bg-danger-500 border-danger-500",t===J.Direct&&"bg-secondary-500 border-secondary-500",t===J.Indirect&&"bg-warning-500 border-warning-500",t==="metadata"&&"bg-neutral-500 border-neutral-500"),children:l.length}),r.jsx(xe,{show:a,as:o.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:r.jsx(ae.Panel,{className:"absolute right-1 z-10 mt-8 transform flex p-2 bg-theme-lighter shadow-xl focus:ring-2 ring-opacity-5 rounded-lg ",children:r.jsx(Be,{headline:e,type:t,className:"w-full h-full max-h-[40vh] overflow-hidden overflow-y-auto ",children:r.jsx(Be.Default,{type:t,changes:l})})})})]})})}function Sn({headline:e,error:t}){const[l,a]=o.useState(!1);return r.jsx(ae,{onMouseEnter:()=>{a(!0)},onMouseLeave:()=>{a(!1)},className:"relative flex",children:()=>r.jsxs(r.Fragment,{children:[r.jsx("span",{title:"Latest",className:"block ml-1 px-2 first-child:ml-0 rounded-full border border-danger-500 bg-danger-500 text-neutral-100 text-xs text-center cursor-pointer",children:r.jsx("span",{children:"Error"})}),r.jsx(xe,{show:l,as:o.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:r.jsx(ae.Panel,{className:"absolute right-0 z-10 mt-8 transform flex min-w-[10rem] ",children:r.jsxs("div",{className:L("flex flex-col rounded-md p-4 bg-danger-100 w-full text-danger-700"),children:[e!=null&&r.jsx("h4",{className:L("mb-2 font-bold whitespace-nowrap"),children:e}),r.jsx("p",{className:"text-xs",children:t.detail??t.message})]})})})]})})}function wn({plan:e}){const t=Xe(),l=B(s=>s.environment),a=U(s=>s.state),d=U(s=>s.setState),u=U(s=>s.setAction);function n(){d(k.Cancelling),u(ee.Cancelling),mt(t).catch(console.error).finally(()=>{u(ee.None),d(k.Cancelled)})}return r.jsx(ae,{className:"relative flex",children:()=>r.jsxs(r.Fragment,{children:[r.jsx(ae.Button,{className:L("inline-block ml-1 px-2 py-[3px] rounded-[4px] text-xs font-bold",jn(a)),children:e==null?0:1}),r.jsx(xe,{as:o.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:r.jsx(ae.Panel,{className:"absolute right-1 z-10 mt-8 transform",children:r.jsxs("div",{className:"overflow-hidden rounded-lg bg-theme shadow-lg ring-1 ring-black ring-opacity-5",children:[r.jsx(Ie,{tasks:e.tasks,children:({total:s,completed:c,models:y,completedBatches:g,totalBatches:p})=>r.jsxs(r.Fragment,{children:[r.jsx(Ie.Summary,{environment:l.name,planState:a,headline:"Most Recent Plan",completed:c,total:s,completedBatches:g,totalBatches:p,updateType:e.type===ye.Virtual?"Virtual":"Backfill",updatedAt:e.updated_at}),y!=null&&r.jsx(Ie.Details,{models:y,showBatches:e.type!==ye.Virtual,showVirtualUpdate:e.type===ye.Virtual,showProgress:!0})]})}),r.jsx("div",{className:"my-4 px-4",children:a===k.Applying&&r.jsx(ne,{size:X.sm,variant:re.Danger,className:"mx-0",onClick:s=>{s.stopPropagation(),n()},children:"Cancel"})})]})})})]})})}function jn(e){return e===k.Finished?"bg-success-500 text-light":e===k.Failed?"bg-danger-500 text-light":e===k.Applying?"bg-secondary-500 text-light":"bg-neutral-100 text-neutral-500"}function kn(){const e=pt(),t=ft(),l=Xe(),{setIsPlanOpen:a}=vt(),d=B(h=>h.addSyncronizedEnvironments),u=B(h=>h.setModels),n=U(h=>h.activePlan),s=U(h=>h.updateTasks),c=Pe(h=>h.project),y=Pe(h=>h.setFiles),g=Pe(h=>h.setProject),[p]=wt(),{data:m,refetch:w}=xt(),{data:x,refetch:i}=ht(),{data:I,refetch:N}=qe(),f=o.useCallback(de(N,1e3,!0),[N]),A=o.useCallback(de(i,1e3,!0),[i]),S=o.useCallback(de(w,1e3,!0),[w]);o.useEffect(()=>{const h=p("tasks",s),M=p("models",u);return f(),A(),S(),()=>{f.cancel(),A.cancel(),S.cancel(),gt(l),bt(l),yt(l),h==null||h(),M==null||M()}},[]),o.useEffect(()=>{e.pathname===oe.Ide&&t(oe.IdeEditor)},[e]),o.useEffect(()=>{I==null||Pt(Object.keys(I))||d(Object.values(I))},[I]),o.useEffect(()=>{u(m)},[m]),o.useEffect(()=>{y((c==null?void 0:c.allFiles)??[])},[c]),o.useEffect(()=>{g(x)},[x]);function v(){a(!0)}const T=e.pathname===oe.IdeEditor;return r.jsxs(It.Page,{children:[r.jsxs("div",{className:"w-full flex justify-between items-center min-h-[2rem] z-50",children:[r.jsxs("div",{className:"px-3 flex items-center whitespace-nowrap",children:[r.jsxs("h3",{className:"font-bold text-primary-500",children:[r.jsx("span",{className:"inline-block",children:"/"}),x==null?void 0:x.name]}),r.jsx(Ct,{className:"w-8 mx-4 text-neutral-50"}),r.jsx(ne,{size:X.sm,variant:re.Neutral,children:T?r.jsx(Le,{to:oe.IdeDocs,children:"Docs"}):r.jsx(Le,{to:oe.IdeEditor,children:"Editor"})})]}),T&&r.jsxs("div",{className:"px-3 flex items-center min-w-[10rem] justify-end",children:[r.jsx(In,{showRunPlan:v}),n!=null&&r.jsx(wn,{plan:n})]})]}),r.jsx(Ce,{}),r.jsx(Et,{})]})}export{kn as default};
